var ST=Object.defineProperty,TT=Object.defineProperties;var NT=Object.getOwnPropertyDescriptors;var pv=Object.getOwnPropertySymbols;var AT=Object.prototype.hasOwnProperty,MT=Object.prototype.propertyIsEnumerable;var gv=(t,e,n)=>e in t?ST(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,w=(t,e)=>{for(var n in e||={})AT.call(e,n)&&gv(t,n,e[n]);if(pv)for(var n of pv(e))MT.call(e,n)&&gv(t,n,e[n]);return t},ue=(t,e)=>TT(t,NT(e));var g=(t,e,n)=>new Promise((i,r)=>{var s=l=>{try{a(n.next(l))}catch(c){r(c)}},o=l=>{try{a(n.throw(l))}catch(c){r(c)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);a((n=n.apply(t,e)).next())});var mv=null;var id=1,_v=Symbol("SIGNAL");function q(t){let e=mv;return mv=t,e}var vv={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function RT(t){if(!(od(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===id)){if(!t.producerMustRecompute(t)&&!rd(t)){t.dirty=!1,t.lastCleanEpoch=id;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=id}}function yv(t){return t&&(t.nextProducerIndex=0),q(t)}function wv(t,e){if(q(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(od(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)sd(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function rd(t){Ka(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],i=t.producerLastReadVersion[e];if(i!==n.version||(RT(n),i!==n.version))return!0}return!1}function bv(t){if(Ka(t),od(t))for(let e=0;e<t.producerNode.length;e++)sd(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function sd(t,e){if(OT(t),Ka(t),t.liveConsumerNode.length===1)for(let i=0;i<t.producerNode.length;i++)sd(t.producerNode[i],t.producerIndexOfThis[i]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let i=t.liveConsumerIndexOfThis[e],r=t.liveConsumerNode[e];Ka(r),r.producerIndexOfThis[i]=e}}function od(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Ka(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function OT(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function xT(){throw new Error}var PT=xT;function Ev(t){PT=t}function D(t){return typeof t=="function"}function nr(t){let n=t(i=>{Error.call(i),i.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ja=nr(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ai(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var me=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:i}=this;if(D(i))try{i()}catch(s){e=s instanceof Ja?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{Dv(s)}catch(o){e=e??[],o instanceof Ja?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Ja(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Dv(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ai(n,e)}remove(e){let{_finalizers:n}=this;n&&ai(n,e),e instanceof t&&e._removeParent(this)}};me.EMPTY=(()=>{let t=new me;return t.closed=!0,t})();var ad=me.EMPTY;function Qa(t){return t instanceof me||t&&"closed"in t&&D(t.remove)&&D(t.add)&&D(t.unsubscribe)}function Dv(t){D(t)?t():t.unsubscribe()}var bt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ir={setTimeout(t,e,...n){let{delegate:i}=ir;return i?.setTimeout?i.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=ir;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Za(t){ir.setTimeout(()=>{let{onUnhandledError:e}=bt;if(e)e(t);else throw t})}function Rs(){}var Cv=ld("C",void 0,void 0);function Iv(t){return ld("E",void 0,t)}function Sv(t){return ld("N",t,void 0)}function ld(t,e,n){return{kind:t,value:e,error:n}}var li=null;function rr(t){if(bt.useDeprecatedSynchronousErrorHandling){let e=!li;if(e&&(li={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:i}=li;if(li=null,n)throw i}}else t()}function Tv(t){bt.useDeprecatedSynchronousErrorHandling&&li&&(li.errorThrown=!0,li.error=t)}var ci=class extends me{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Qa(e)&&e.add(this)):this.destination=LT}static create(e,n,i){return new sr(e,n,i)}next(e){this.isStopped?ud(Sv(e),this):this._next(e)}error(e){this.isStopped?ud(Iv(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ud(Cv,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},kT=Function.prototype.bind;function cd(t,e){return kT.call(t,e)}var dd=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(i){Xa(i)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(i){Xa(i)}else Xa(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Xa(n)}}},sr=class extends ci{constructor(e,n,i){super();let r;if(D(e)||!e)r={next:e??void 0,error:n??void 0,complete:i??void 0};else{let s;this&&bt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&cd(e.next,s),error:e.error&&cd(e.error,s),complete:e.complete&&cd(e.complete,s)}):r=e}this.destination=new dd(r)}};function Xa(t){bt.useDeprecatedSynchronousErrorHandling?Tv(t):Za(t)}function FT(t){throw t}function ud(t,e){let{onStoppedNotification:n}=bt;n&&ir.setTimeout(()=>n(t,e))}var LT={closed:!0,next:Rs,error:FT,complete:Rs};var or=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Xe(t){return t}function hd(...t){return fd(t)}function fd(t){return t.length===0?Xe:t.length===1?t[0]:function(n){return t.reduce((i,r)=>r(i),n)}}var P=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let i=new t;return i.source=this,i.operator=n,i}subscribe(n,i,r){let s=BT(n)?n:new sr(n,i,r);return rr(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return i=Nv(i),new i((r,s)=>{let o=new sr({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(n){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(n)}[or](){return this}pipe(...n){return fd(n)(this)}toPromise(n){return n=Nv(n),new n((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return t.create=e=>new t(e),t})();function Nv(t){var e;return(e=t??bt.Promise)!==null&&e!==void 0?e:Promise}function UT(t){return t&&D(t.next)&&D(t.error)&&D(t.complete)}function BT(t){return t&&t instanceof ci||UT(t)&&Qa(t)}function pd(t){return D(t?.lift)}function W(t){return e=>{if(pd(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function V(t,e,n,i,r){return new gd(t,e,n,i,r)}var gd=class extends ci{constructor(e,n,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ar(){return W((t,e)=>{let n=null;t._refCount++;let i=V(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let r=t._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});t.subscribe(i),i.closed||(n=t.connect())})}var lr=class extends P{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,pd(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new me;let n=this.getSubject();e.add(this.source.subscribe(V(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=me.EMPTY)}return e}refCount(){return ar()(this)}};var Av=nr(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var be=(()=>{class t extends P{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let i=new el(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new Av}next(n){rr(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(n)}})}error(n){rr(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){rr(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:i,isStopped:r,observers:s}=this;return i||r?ad:(this.currentObservers=null,s.push(n),new me(()=>{this.currentObservers=null,ai(s,n)}))}_checkFinalizedStatuses(n){let{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){let n=new P;return n.source=this,n}}return t.create=(e,n)=>new el(e,n),t})(),el=class extends be{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,e)}error(e){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&i!==void 0?i:ad}};var Ie=class extends be{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:i}=this;if(e)throw n;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var md={now(){return(md.delegate||Date).now()},delegate:void 0};var tl=class extends me{constructor(e,n){super()}schedule(e,n=0){return this}};var Os={setInterval(t,e,...n){let{delegate:i}=Os;return i?.setInterval?i.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Os;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var cr=class extends tl{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var i;if(this.closed)return this;this.state=e;let r=this.id,s=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(s,r,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,i=0){return Os.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,n,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&Os.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i=!1,r;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ai(i,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var ur=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,i){return new this.schedulerActionCtor(this,e).schedule(i,n)}};ur.now=md.now;var dr=class extends ur{constructor(e,n=ur.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}}};var nl=new dr(cr),_d=nl;var il=class extends cr{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,i=0){return i!=null&&i>0||i==null&&this.delay>0?super.requestAsyncId(e,n,i):(e.flush(this),0)}};var rl=class extends dr{};var vd=new rl(il);var Ve=new P(t=>t.complete());function sl(t){return t&&D(t.schedule)}function Mv(t){return t[t.length-1]}function Rv(t){return D(Mv(t))?t.pop():void 0}function Nn(t){return sl(Mv(t))?t.pop():void 0}function yd(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function xv(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((i=i.apply(t,e||[])).next())})}function Ov(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ui(t){return this instanceof ui?(this.v=t,this):new ui(t)}function Pv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){i[f]&&(r[f]=function(_){return new Promise(function(b,x){s.push([f,_,b,x])>1||l(f,_)})},p&&(r[f]=p(r[f])))}function l(f,p){try{c(i[f](p))}catch(_){h(s[0][3],_)}}function c(f){f.value instanceof ui?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}function u(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}function kv(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ov=="function"?Ov(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),r(a,l,o.done,o.value)})}}function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}var hr=t=>t&&typeof t.length=="number"&&typeof t!="function";function ol(t){return D(t?.then)}function al(t){return D(t[or])}function ll(t){return Symbol.asyncIterator&&D(t?.[Symbol.asyncIterator])}function cl(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function VT(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ul=VT();function dl(t){return D(t?.[ul])}function hl(t){return Pv(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:i,done:r}=yield ui(n.read());if(r)return yield ui(void 0);yield yield ui(i)}}finally{n.releaseLock()}})}function fl(t){return D(t?.getReader)}function de(t){if(t instanceof P)return t;if(t!=null){if(al(t))return jT(t);if(hr(t))return $T(t);if(ol(t))return HT(t);if(ll(t))return Fv(t);if(dl(t))return WT(t);if(fl(t))return GT(t)}throw cl(t)}function jT(t){return new P(e=>{let n=t[or]();if(D(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function $T(t){return new P(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function HT(t){return new P(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Za)})}function WT(t){return new P(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Fv(t){return new P(e=>{zT(t,e).catch(n=>e.error(n))})}function GT(t){return Fv(hl(t))}function zT(t,e){var n,i,r,s;return xv(this,void 0,void 0,function*(){try{for(n=kv(t);i=yield n.next(),!i.done;){let o=i.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}e.complete()})}function qe(t,e,n,i=0,r=!1){let s=e.schedule(function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function An(t,e=0){return W((n,i)=>{n.subscribe(V(i,r=>qe(i,t,()=>i.next(r),e),()=>qe(i,t,()=>i.complete(),e),r=>qe(i,t,()=>i.error(r),e)))})}function Mn(t,e=0){return W((n,i)=>{i.add(t.schedule(()=>n.subscribe(i),e))})}function Lv(t,e){return de(t).pipe(Mn(e),An(e))}function Uv(t,e){return de(t).pipe(Mn(e),An(e))}function Bv(t,e){return new P(n=>{let i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}function Vv(t,e){return new P(n=>{let i;return qe(n,e,()=>{i=t[ul](),qe(n,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){n.error(o);return}s?n.complete():n.next(r)},0,!0)}),()=>D(i?.return)&&i.return()})}function pl(t,e){if(!t)throw new Error("Iterable cannot be null");return new P(n=>{qe(n,e,()=>{let i=t[Symbol.asyncIterator]();qe(n,e,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function jv(t,e){return pl(hl(t),e)}function $v(t,e){if(t!=null){if(al(t))return Lv(t,e);if(hr(t))return Bv(t,e);if(ol(t))return Uv(t,e);if(ll(t))return pl(t,e);if(dl(t))return Vv(t,e);if(fl(t))return jv(t,e)}throw cl(t)}function _e(t,e){return e?$v(t,e):de(t)}function C(...t){let e=Nn(t);return _e(t,e)}function fr(t,e){let n=D(t)?t:()=>t,i=r=>r.error(n());return new P(e?r=>e.schedule(i,0,r):i)}function wd(t){return!!t&&(t instanceof P||D(t.lift)&&D(t.subscribe))}var dn=nr(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Hv(t){return t instanceof Date&&!isNaN(t)}function j(t,e){return W((n,i)=>{let r=0;n.subscribe(V(i,s=>{i.next(t.call(e,s,r++))}))})}var{isArray:qT}=Array;function YT(t,e){return qT(e)?t(...e):t(e)}function gl(t){return j(e=>YT(t,e))}var{isArray:KT}=Array,{getPrototypeOf:JT,prototype:QT,keys:ZT}=Object;function Wv(t){if(t.length===1){let e=t[0];if(KT(e))return{args:e,keys:null};if(XT(e)){let n=ZT(e);return{args:n.map(i=>e[i]),keys:n}}}return{args:t,keys:null}}function XT(t){return t&&typeof t=="object"&&JT(t)===QT}function Gv(t,e){return t.reduce((n,i,r)=>(n[i]=e[r],n),{})}function pr(...t){let e=Nn(t),n=Rv(t),{args:i,keys:r}=Wv(t);if(i.length===0)return _e([],e);let s=new P(e1(i,e,r?o=>Gv(r,o):Xe));return n?s.pipe(gl(n)):s}function e1(t,e,n=Xe){return i=>{zv(e,()=>{let{length:r}=t,s=new Array(r),o=r,a=r;for(let l=0;l<r;l++)zv(e,()=>{let c=_e(t[l],e),u=!1;c.subscribe(V(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(n(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}function zv(t,e,n){t?qe(n,t,e):e()}function qv(t,e,n,i,r,s,o,a){let l=[],c=0,u=0,d=!1,h=()=>{d&&!l.length&&!c&&e.complete()},f=_=>c<i?p(_):l.push(_),p=_=>{s&&e.next(_),c++;let b=!1;de(n(_,u++)).subscribe(V(e,x=>{r?.(x),s?f(x):e.next(x)},()=>{b=!0},void 0,()=>{if(b)try{for(c--;l.length&&c<i;){let x=l.shift();o?qe(e,o,()=>p(x)):p(x)}h()}catch(x){e.error(x)}}))};return t.subscribe(V(e,f,()=>{d=!0,h()})),()=>{a?.()}}function he(t,e,n=1/0){return D(e)?he((i,r)=>j((s,o)=>e(i,s,r,o))(de(t(i,r))),n):(typeof e=="number"&&(n=e),W((i,r)=>qv(i,r,t,n)))}function gr(t=1/0){return he(Xe,t)}function Yv(){return gr(1)}function Rn(...t){return Yv()(_e(t,Nn(t)))}function ml(t){return new P(e=>{de(t()).subscribe(e)})}var t1=["addListener","removeListener"],n1=["addEventListener","removeEventListener"],i1=["on","off"];function xs(t,e,n,i){if(D(n)&&(i=n,n=void 0),i)return xs(t,e,n).pipe(gl(i));let[r,s]=o1(t)?n1.map(o=>a=>t[o](e,a,n)):r1(t)?t1.map(Kv(t,e)):s1(t)?i1.map(Kv(t,e)):[];if(!r&&hr(t))return he(o=>xs(o,e,n))(de(t));if(!r)throw new TypeError("Invalid event target");return new P(o=>{let a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function Kv(t,e){return n=>i=>t[n](e,i)}function r1(t){return D(t.addListener)&&D(t.removeListener)}function s1(t){return D(t.on)&&D(t.off)}function o1(t){return D(t.addEventListener)&&D(t.removeEventListener)}function bd(t=0,e,n=_d){let i=-1;return e!=null&&(sl(e)?n=e:i=e),new P(r=>{let s=Hv(t)?+t-n.now():t;s<0&&(s=0);let o=0;return n.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}var{isArray:a1}=Array;function Jv(t){return t.length===1&&a1(t[0])?t[0]:t}function Ye(t,e){return W((n,i)=>{let r=0;n.subscribe(V(i,s=>t.call(e,s,r++)&&i.next(s)))})}function Ed(...t){return t=Jv(t),t.length===1?de(t[0]):new P(l1(t))}function l1(t){return e=>{let n=[];for(let i=0;n&&!e.closed&&i<t.length;i++)n.push(de(t[i]).subscribe(V(e,r=>{if(n){for(let s=0;s<n.length;s++)s!==i&&n[s].unsubscribe();n=null}e.next(r)})))}}function On(t){return W((e,n)=>{let i=null,r=!1,s;i=e.subscribe(V(n,void 0,void 0,o=>{s=de(t(o,On(t)(e))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function Qv(t,e,n,i,r){return(s,o)=>{let a=n,l=e,c=0;s.subscribe(V(o,u=>{let d=c++;l=a?t(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function di(t,e){return D(e)?he(t,e,1):he(t,1)}function xn(t){return W((e,n)=>{let i=!1;e.subscribe(V(n,r=>{i=!0,n.next(r)},()=>{i||n.next(t),n.complete()}))})}function Lt(t){return t<=0?()=>Ve:W((e,n)=>{let i=0;e.subscribe(V(n,r=>{++i<=t&&(n.next(r),t<=i&&n.complete())}))})}function Dd(t){return j(()=>t)}function _l(t=c1){return W((e,n)=>{let i=!1;e.subscribe(V(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(t())))})}function c1(){return new dn}function Cd(...t){return e=>Rn(e,C(...t))}function mr(t){return W((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Ut(t,e){let n=arguments.length>=2;return i=>i.pipe(t?Ye((r,s)=>t(r,s,i)):Xe,Lt(1),n?xn(e):_l(()=>new dn))}function _r(t){return t<=0?()=>Ve:W((e,n)=>{let i=[];e.subscribe(V(n,r=>{i.push(r),t<i.length&&i.shift()},()=>{for(let r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function Id(t,e){let n=arguments.length>=2;return i=>i.pipe(t?Ye((r,s)=>t(r,s,i)):Xe,_r(1),n?xn(e):_l(()=>new dn))}function Sd(t,e){return W(Qv(t,e,arguments.length>=2,!0))}function vl(...t){let e=Nn(t);return W((n,i)=>{(e?Rn(t,n,e):Rn(t,n)).subscribe(i)})}function et(t,e){return W((n,i)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&i.complete();n.subscribe(V(i,l=>{r?.unsubscribe();let c=0,u=s++;de(t(l,u)).subscribe(r=V(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function hi(t){return W((e,n)=>{de(t).subscribe(V(n,()=>n.complete(),Rs)),!n.closed&&e.subscribe(n)})}function ye(t,e,n){let i=D(t)||e||n?{next:t,error:e,complete:n}:t;return i?W((r,s)=>{var o;(o=i.subscribe)===null||o===void 0||o.call(i);let a=!0;r.subscribe(V(s,l=>{var c;(c=i.next)===null||c===void 0||c.call(i,l),s.next(l)},()=>{var l;a=!1,(l=i.complete)===null||l===void 0||l.call(i),s.complete()},l=>{var c;a=!1,(c=i.error)===null||c===void 0||c.call(i,l),s.error(l)},()=>{var l,c;a&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(c=i.finalize)===null||c===void 0||c.call(i)}))}):Xe}var Py="https://g.co/ng/security#xss",I=class extends Error{constructor(e,n){super(xh(e,n)),this.code=e}};function xh(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function qs(t){return{toString:t}.toString()}var yl="__parameters__";function u1(t){return function(...n){if(t){let i=t(...n);for(let r in i)this[r]=i[r]}}}function ky(t,e,n){return qs(()=>{let i=u1(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(l,c,u){let d=l.hasOwnProperty(yl)?l[yl]:Object.defineProperty(l,yl,{value:[]})[yl];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}var fi=globalThis;function ie(t){for(let e in t)if(t[e]===ie)return e;throw Error("Could not find renamed property on target object.")}function $e(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map($e).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function Zv(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var d1=ie({__forward_ref__:ie});function Ph(t){return t.__forward_ref__=Ph,t.toString=function(){return $e(this())},t}function lt(t){return Fy(t)?t():t}function Fy(t){return typeof t=="function"&&t.hasOwnProperty(d1)&&t.__forward_ref__===Ph}function E(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ei(t){return{providers:t.providers||[],imports:t.imports||[]}}function ql(t){return Xv(t,Uy)||Xv(t,By)}function Ly(t){return ql(t)!==null}function Xv(t,e){return t.hasOwnProperty(e)?t[e]:null}function h1(t){let e=t&&(t[Uy]||t[By]);return e||null}function ey(t){return t&&(t.hasOwnProperty(ty)||t.hasOwnProperty(f1))?t[ty]:null}var Uy=ie({\u0275prov:ie}),ty=ie({\u0275inj:ie}),By=ie({ngInjectableDef:ie}),f1=ie({ngInjectorDef:ie}),A=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=E({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Vy(t){return t&&!!t.\u0275providers}var p1=ie({\u0275cmp:ie}),g1=ie({\u0275dir:ie}),m1=ie({\u0275pipe:ie}),_1=ie({\u0275mod:ie}),Nl=ie({\u0275fac:ie}),Ps=ie({__NG_ELEMENT_ID__:ie}),ny=ie({__NG_ENV_ID__:ie});function Yl(t){return typeof t=="string"?t:t==null?"":String(t)}function v1(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Yl(t)}function y1(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new I(-200,t)}function kh(t,e){throw new I(-201,!1)}var L=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(L||{}),Vd;function jy(){return Vd}function at(t){let e=Vd;return Vd=t,e}function $y(t,e,n){let i=ql(t);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(n&L.Optional)return null;if(e!==void 0)return e;kh(t,"Injector")}var w1={},ks=w1,jd="__NG_DI_FLAG__",Al="ngTempTokenPath",b1="ngTokenPath",E1=/\n/gm,D1="\u0275",iy="__source",br;function C1(){return br}function Pn(t){let e=br;return br=t,e}function I1(t,e=L.Default){if(br===void 0)throw new I(-203,!1);return br===null?$y(t,void 0,e):br.get(t,e&L.Optional?null:void 0,e)}function T(t,e=L.Default){return(jy()||I1)(lt(t),e)}function v(t,e=L.Default){return T(t,Kl(e))}function Kl(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function $d(t){let e=[];for(let n=0;n<t.length;n++){let i=lt(t[n]);if(Array.isArray(i)){if(i.length===0)throw new I(900,!1);let r,s=L.Default;for(let o=0;o<i.length;o++){let a=i[o],l=S1(a);typeof l=="number"?l===-1?r=a.token:s|=l:r=a}e.push(T(r,s))}else e.push(T(i))}return e}function Hy(t,e){return t[jd]=e,t.prototype[jd]=e,t}function S1(t){return t[jd]}function T1(t,e,n,i){let r=t[Al];throw e[iy]&&r.unshift(e[iy]),t.message=N1(`
`+t.message,r,n,i),t[b1]=r,t[Al]=null,t}function N1(t,e,n,i=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==D1?t.slice(2):t;let r=$e(e);if(Array.isArray(e))r=e.map($e).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):$e(a)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(E1,`
  `)}`}var ht=Hy(ky("Optional"),8);var Fh=Hy(ky("SkipSelf"),4);function Dr(t,e){let n=t.hasOwnProperty(Nl);return n?t[Nl]:null}function A1(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}function M1(t){return t.flat(Number.POSITIVE_INFINITY)}function Lh(t,e){t.forEach(n=>Array.isArray(n)?Lh(n,e):e(n))}function Wy(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ml(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function R1(t,e){let n=[];for(let i=0;i<t;i++)n.push(e);return n}function O1(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(r===1)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;){let s=r-2;t[r]=t[s],r--}t[e]=n,t[e+1]=i}}function x1(t,e,n){let i=Ys(t,e);return i>=0?t[i|1]=n:(i=~i,O1(t,i,e,n)),i}function Td(t,e){let n=Ys(t,e);if(n>=0)return t[n|1]}function Ys(t,e){return P1(t,e,1)}function P1(t,e,n){let i=0,r=t.length>>n;for(;r!==i;){let s=i+(r-i>>1),o=t[s<<n];if(e===o)return s<<n;o>e?r=s:i=s+1}return~(r<<n)}var Fs={},Dt=[],Cr=new A(""),Gy=new A("",-1),zy=new A(""),Rl=class{get(e,n=ks){if(n===ks){let i=new Error(`NullInjectorError: No provider for ${$e(e)}!`);throw i.name="NullInjectorError",i}return n}},qy=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(qy||{}),jt=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(jt||{}),ct=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(ct||{});function k1(t,e,n){let i=t.length;for(;;){let r=t.indexOf(e,n);if(r===-1)return r;if(r===0||t.charCodeAt(r-1)<=32){let s=e.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}n=r+1}}function Hd(t,e,n){let i=0;for(;i<n.length;){let r=n[i];if(typeof r=="number"){if(r!==0)break;i++;let s=n[i++],o=n[i++],a=n[i++];t.setAttribute(e,o,a,s)}else{let s=r,o=n[++i];F1(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),i++}}return i}function Yy(t){return t===3||t===4||t===6}function F1(t){return t.charCodeAt(0)===64}function Uh(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?n=r:n===0||(n===-1||n===2?ry(t,n,r,null,e[++i]):ry(t,n,r,null,null))}}return t}function ry(t,e,n,i,r){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(i===null){r!==null&&(t[s+1]=r);return}else if(i===t[s+1]){t[s+2]=r;return}}s++,i!==null&&s++,r!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),i!==null&&t.splice(s++,0,i),r!==null&&t.splice(s++,0,r)}var Ky="ng-template";function L1(t,e,n,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&k1(e[r+1].toLowerCase(),n,0)!==-1)return!0}else if(Bh(t))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===n)return!0}return!1}function Bh(t){return t.type===4&&t.value!==Ky}function U1(t,e,n){let i=t.type===4&&!n?Ky:t.value;return e===i}function B1(t,e,n){let i=4,r=t.attrs,s=r!==null?$1(r):0,o=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!o&&!Et(i)&&!Et(l))return!1;if(o&&Et(l))continue;o=!1,i=l|i&1;continue}if(!o)if(i&4){if(i=2|i&1,l!==""&&!U1(t,l,n)||l===""&&e.length===1){if(Et(i))return!1;o=!0}}else if(i&8){if(r===null||!L1(t,r,l,n)){if(Et(i))return!1;o=!0}}else{let c=e[++a],u=V1(l,r,Bh(t),n);if(u===-1){if(Et(i))return!1;o=!0;continue}if(c!==""){let d;if(u>s?d="":d=r[u+1].toLowerCase(),i&2&&c!==d){if(Et(i))return!1;o=!0}}}}return Et(i)||o}function Et(t){return(t&1)===0}function V1(t,e,n,i){if(e===null)return-1;let r=0;if(i||!n){let s=!1;for(;r<e.length;){let o=e[r];if(o===t)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return H1(e,t)}function Jy(t,e,n=!1){for(let i=0;i<e.length;i++)if(B1(t,e[i],n))return!0;return!1}function j1(t){let e=t.attrs;if(e!=null){let n=e.indexOf(5);if(!(n&1))return e[n+1]}return null}function $1(t){for(let e=0;e<t.length;e++){let n=t[e];if(Yy(n))return e}return t.length}function H1(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let i=t[n];if(typeof i=="number")return-1;if(i===e)return n;n++}return-1}function W1(t,e){e:for(let n=0;n<e.length;n++){let i=e[n];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function sy(t,e){return t?":not("+e.trim()+")":e}function G1(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(i&2){let a=t[++n];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+o:i&4&&(r+=" "+o);else r!==""&&!Et(o)&&(e+=sy(s,r),r=""),i=o,s=s||!Et(i);n++}return r!==""&&(e+=sy(s,r)),e}function z1(t){return t.map(G1).join(",")}function q1(t){let e=[],n=[],i=1,r=2;for(;i<t.length;){let s=t[i];if(typeof s=="string")r===2?s!==""&&e.push(s,t[++i]):r===8&&n.push(s);else{if(!Et(r))break;r=s}i++}return{attrs:e,classes:n}}function Wt(t){return qs(()=>{let e=t0(t),n=ue(w({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===qy.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||jt.Emulated,styles:t.styles||Dt,_:null,schemas:t.schemas||null,tView:null,id:""});n0(n);let i=t.dependencies;return n.directiveDefs=ay(i,!1),n.pipeDefs=ay(i,!0),n.id=J1(n),n})}function Y1(t){return Ln(t)||Qy(t)}function K1(t){return t!==null}function Di(t){return qs(()=>({type:t.type,bootstrap:t.bootstrap||Dt,declarations:t.declarations||Dt,imports:t.imports||Dt,exports:t.exports||Dt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function oy(t,e){if(t==null)return Fs;let n={};for(let i in t)if(t.hasOwnProperty(i)){let r=t[i],s,o,a=ct.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(n[s]=a!==ct.None?[i,a]:i,e[s]=o):n[s]=i}return n}function gn(t){return qs(()=>{let e=t0(t);return n0(e),e})}function Ln(t){return t[p1]||null}function Qy(t){return t[g1]||null}function Zy(t){return t[m1]||null}function Xy(t){let e=Ln(t)||Qy(t)||Zy(t);return e!==null?e.standalone:!1}function e0(t,e){let n=t[_1]||null;if(!n&&e===!0)throw new Error(`Type ${$e(t)} does not have '\u0275mod' property.`);return n}function t0(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Fs,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Dt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:oy(t.inputs,e),outputs:oy(t.outputs),debugInfo:null}}function n0(t){t.features?.forEach(e=>e(t))}function ay(t,e){if(!t)return null;let n=e?Zy:Y1;return()=>(typeof t=="function"?t():t).map(i=>n(i)).filter(K1)}function J1(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let r of n)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Vn(t){return{\u0275providers:t}}function Q1(...t){return{\u0275providers:i0(!0,t),\u0275fromNgModule:!0}}function i0(t,...e){let n=[],i=new Set,r,s=o=>{n.push(o)};return Lh(e,o=>{let a=o;Wd(a,s,[],i)&&(r||=[],r.push(a))}),r!==void 0&&r0(r,s),n}function r0(t,e){for(let n=0;n<t.length;n++){let{ngModule:i,providers:r}=t[n];Vh(r,s=>{e(s,i)})}}function Wd(t,e,n,i){if(t=lt(t),!t)return!1;let r=null,s=ey(t),o=!s&&Ln(t);if(!s&&!o){let l=t.ngModule;if(s=ey(l),s)r=l;else return!1}else{if(o&&!o.standalone)return!1;r=t}let a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){let l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of l)Wd(c,e,n,i)}}else if(s){if(s.imports!=null&&!a){i.add(r);let c;try{Lh(s.imports,u=>{Wd(u,e,n,i)&&(c||=[],c.push(u))})}finally{}c!==void 0&&r0(c,e)}if(!a){let c=Dr(r)||(()=>new r);e({provide:r,useFactory:c,deps:Dt},r),e({provide:zy,useValue:r,multi:!0},r),e({provide:Cr,useValue:()=>T(r),multi:!0},r)}let l=s.providers;if(l!=null&&!a){let c=t;Vh(l,u=>{e(u,c)})}}else return!1;return r!==t&&t.providers!==void 0}function Vh(t,e){for(let n of t)Vy(n)&&(n=n.\u0275providers),Array.isArray(n)?Vh(n,e):e(n)}var Z1=ie({provide:String,useValue:ie});function s0(t){return t!==null&&typeof t=="object"&&Z1 in t}function X1(t){return!!(t&&t.useExisting)}function eN(t){return!!(t&&t.useFactory)}function Gd(t){return typeof t=="function"}var Jl=new A(""),El={},tN={},Nd;function jh(){return Nd===void 0&&(Nd=new Rl),Nd}var He=class{},Ls=class extends He{get destroyed(){return this._destroyed}constructor(e,n,i,r){super(),this.parent=n,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,qd(e,o=>this.processProvider(o)),this.records.set(Gy,vr(void 0,this)),r.has("environment")&&this.records.set(He,vr(void 0,this));let s=this.records.get(Jl);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(zy,Dt,L.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=q(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of n)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),q(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Pn(this),i=at(void 0),r;try{return e()}finally{Pn(n),at(i)}}get(e,n=ks,i=L.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(ny))return e[ny](this);i=Kl(i);let r,s=Pn(this),o=at(void 0);try{if(!(i&L.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=aN(e)&&ql(e);c&&this.injectableDefInScope(c)?l=vr(zd(e),El):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=i&L.Self?jh():this.parent;return n=i&L.Optional&&n===ks?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Al]=a[Al]||[]).unshift($e(e)),s)throw a;return T1(a,e,"R3InjectorError",this.source)}else throw a}finally{at(o),Pn(s)}}resolveInjectorInitializers(){let e=q(null),n=Pn(this),i=at(void 0),r;try{let s=this.get(Cr,Dt,L.Self);for(let o of s)o()}finally{Pn(n),at(i),q(e)}}toString(){let e=[],n=this.records;for(let i of n.keys())e.push($e(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new I(205,!1)}processProvider(e){e=lt(e);let n=Gd(e)?e:lt(e&&e.provide),i=iN(e);if(!Gd(e)&&e.multi===!0){let r=this.records.get(n);r||(r=vr(void 0,El,!0),r.factory=()=>$d(r.multi),this.records.set(n,r)),n=e,r.multi.push(e)}this.records.set(n,i)}hydrate(e,n){let i=q(null);try{return n.value===El&&(n.value=tN,n.value=n.factory()),typeof n.value=="object"&&n.value&&oN(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{q(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=lt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function zd(t){let e=ql(t),n=e!==null?e.factory:Dr(t);if(n!==null)return n;if(t instanceof A)throw new I(204,!1);if(t instanceof Function)return nN(t);throw new I(204,!1)}function nN(t){if(t.length>0)throw new I(204,!1);let n=h1(t);return n!==null?()=>n.factory(t):()=>new t}function iN(t){if(s0(t))return vr(void 0,t.useValue);{let e=rN(t);return vr(e,El)}}function rN(t,e,n){let i;if(Gd(t)){let r=lt(t);return Dr(r)||zd(r)}else if(s0(t))i=()=>lt(t.useValue);else if(eN(t))i=()=>t.useFactory(...$d(t.deps||[]));else if(X1(t))i=()=>T(lt(t.useExisting));else{let r=lt(t&&(t.useClass||t.provide));if(sN(t))i=()=>new r(...$d(t.deps));else return Dr(r)||zd(r)}return i}function vr(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function sN(t){return!!t.deps}function oN(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function aN(t){return typeof t=="function"||typeof t=="object"&&t instanceof A}function qd(t,e){for(let n of t)Array.isArray(n)?qd(n,e):n&&Vy(n)?qd(n.\u0275providers,e):e(n)}function mn(t,e){t instanceof Ls&&t.assertNotDestroyed();let n,i=Pn(t),r=at(void 0);try{return e()}finally{Pn(i),at(r)}}function o0(){return jy()!==void 0||C1()!=null}function lN(t){if(!o0())throw new I(-203,!1)}function cN(t){return typeof t=="function"}var _n=0,k=1,S=2,Re=3,Ct=4,tt=5,Us=6,Bs=7,ut=8,Ir=9,It=10,Ee=11,Vs=12,ly=13,Mr=14,St=15,Ks=16,yr=17,hn=18,Ql=19,a0=20,Fn=21,Ad=22,mi=23,dt=25,l0=1;var _i=7,Ol=8,Sr=9,Ke=10,$h=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}($h||{});function pi(t){return Array.isArray(t)&&typeof t[l0]=="object"}function vn(t){return Array.isArray(t)&&t[l0]===!0}function c0(t){return(t.flags&4)!==0}function Zl(t){return t.componentOffset>-1}function Hh(t){return(t.flags&1)===1}function Js(t){return!!t.template}function uN(t){return(t[S]&512)!==0}var Yd=class{constructor(e,n,i){this.previousValue=e,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}};function u0(t,e,n,i){e!==null?e.applyValueToInputSignal(e,i):t[n]=i}function jn(){return d0}function d0(t){return t.type.prototype.ngOnChanges&&(t.setInput=hN),dN}jn.ngInherit=!0;function dN(){let t=f0(this),e=t?.current;if(e){let n=t.previous;if(n===Fs)t.previous=e;else for(let i in e)n[i]=e[i];t.current=null,this.ngOnChanges(e)}}function hN(t,e,n,i,r){let s=this.declaredInputs[i],o=f0(t)||fN(t,{previous:Fs,current:null}),a=o.current||(o.current={}),l=o.previous,c=l[s];a[s]=new Yd(c&&c.currentValue,n,l===Fs),u0(t,e,r,n)}var h0="__ngSimpleChanges__";function f0(t){return t[h0]||null}function fN(t,e){return t[h0]=e}var cy=null;var Bt=function(t,e,n){cy?.(t,e,n)},p0="svg",pN="math",gN=!1;function mN(){return gN}function $t(t){for(;Array.isArray(t);)t=t[_n];return t}function g0(t,e){return $t(e[t])}function ft(t,e){return $t(e[t.index])}function Wh(t,e){return t.data[e]}function _N(t,e){return t[e]}function $n(t,e){let n=e[t];return pi(n)?n:n[_n]}function vN(t){return(t[S]&4)===4}function Gh(t){return(t[S]&128)===128}function yN(t){return vn(t[Re])}function xl(t,e){return e==null?null:t[e]}function m0(t){t[yr]=0}function wN(t){t[S]&1024||(t[S]|=1024,Gh(t)&&js(t))}function bN(t,e){for(;t>0;)e=e[Mr],t--;return e}function zh(t){return!!(t[S]&9216||t[mi]?.dirty)}function Kd(t){t[It].changeDetectionScheduler?.notify(1),zh(t)?js(t):t[S]&64&&(mN()?(t[S]|=1024,js(t)):t[It].changeDetectionScheduler?.notify())}function js(t){t[It].changeDetectionScheduler?.notify();let e=$s(t);for(;e!==null&&!(e[S]&8192||(e[S]|=8192,!Gh(e)));)e=$s(e)}function _0(t,e){if((t[S]&256)===256)throw new I(911,!1);t[Fn]===null&&(t[Fn]=[]),t[Fn].push(e)}function EN(t,e){if(t[Fn]===null)return;let n=t[Fn].indexOf(e);n!==-1&&t[Fn].splice(n,1)}function $s(t){let e=t[Re];return vn(e)?e[Re]:e}var F={lFrame:S0(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function DN(){return F.lFrame.elementDepthCount}function CN(){F.lFrame.elementDepthCount++}function IN(){F.lFrame.elementDepthCount--}function v0(){return F.bindingsEnabled}function y0(){return F.skipHydrationRootTNode!==null}function SN(t){return F.skipHydrationRootTNode===t}function TN(){F.skipHydrationRootTNode=null}function Q(){return F.lFrame.lView}function nt(){return F.lFrame.tView}function Qs(t){return F.lFrame.contextLView=t,t[ut]}function Zs(t){return F.lFrame.contextLView=null,t}function it(){let t=w0();for(;t!==null&&t.type===64;)t=t.parent;return t}function w0(){return F.lFrame.currentTNode}function NN(){let t=F.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Xs(t,e){let n=F.lFrame;n.currentTNode=t,n.isParent=e}function b0(){return F.lFrame.isParent}function E0(){F.lFrame.isParent=!1}function AN(){return F.lFrame.contextLView}function MN(){let t=F.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function RN(t){return F.lFrame.bindingIndex=t}function Xl(){return F.lFrame.bindingIndex++}function ON(t){let e=F.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function xN(){return F.lFrame.inI18n}function PN(t,e){let n=F.lFrame;n.bindingIndex=n.bindingRootIndex=t,Jd(e)}function kN(){return F.lFrame.currentDirectiveIndex}function Jd(t){F.lFrame.currentDirectiveIndex=t}function FN(t){let e=F.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function D0(){return F.lFrame.currentQueryIndex}function qh(t){F.lFrame.currentQueryIndex=t}function LN(t){let e=t[k];return e.type===2?e.declTNode:e.type===1?t[tt]:null}function C0(t,e,n){if(n&L.SkipSelf){let r=e,s=t;for(;r=r.parent,r===null&&!(n&L.Host);)if(r=LN(s),r===null||(s=s[Mr],r.type&10))break;if(r===null)return!1;e=r,t=s}let i=F.lFrame=I0();return i.currentTNode=e,i.lView=t,!0}function Yh(t){let e=I0(),n=t[k];F.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function I0(){let t=F.lFrame,e=t===null?null:t.child;return e===null?S0(t):e}function S0(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function T0(){let t=F.lFrame;return F.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var N0=T0;function Kh(){let t=T0();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function UN(t){return(F.lFrame.contextLView=bN(t,F.lFrame.contextLView))[ut]}function Rr(){return F.lFrame.selectedIndex}function vi(t){F.lFrame.selectedIndex=t}function Jh(){let t=F.lFrame;return Wh(t.tView,t.selectedIndex)}function A0(){F.lFrame.currentNamespace=p0}function BN(){return F.lFrame.currentNamespace}var M0=!0;function Qh(){return M0}function Zh(t){M0=t}function VN(t,e,n){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){let o=d0(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}r&&(n.preOrderHooks??=[]).push(0-t,r),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function Xh(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),l&&(t.viewHooks??=[]).push(-n,l),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Dl(t,e,n){R0(t,e,3,n)}function Cl(t,e,n,i){(t[S]&3)===n&&R0(t,e,n,i)}function Md(t,e){let n=t[S];(n&3)===e&&(n&=16383,n+=1,t[S]=n)}function R0(t,e,n,i){let r=i!==void 0?t[yr]&65535:0,s=i??-1,o=e.length-1,a=0;for(let l=r;l<o;l++)if(typeof e[l+1]=="number"){if(a=e[l],i!=null&&a>=i)break}else e[l]<0&&(t[yr]+=65536),(a<s||s==-1)&&(jN(t,n,e,l),t[yr]=(t[yr]&4294901760)+l+2),l++}function uy(t,e){Bt(4,t,e);let n=q(null);try{e.call(t)}finally{q(n),Bt(5,t,e)}}function jN(t,e,n,i){let r=n[i]<0,s=n[i+1],o=r?-n[i]:n[i],a=t[o];r?t[S]>>14<t[yr]>>16&&(t[S]&3)===e&&(t[S]+=16384,uy(a,s)):uy(a,s)}var Er=-1,Hs=class{constructor(e,n,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}};function $N(t){return t instanceof Hs}function HN(t){return(t.flags&8)!==0}function WN(t){return(t.flags&16)!==0}function O0(t){return t!==Er}function Pl(t){return t&32767}function GN(t){return t>>16}function kl(t,e){let n=GN(t),i=e;for(;n>0;)i=i[Mr],n--;return i}var Qd=!0;function dy(t){let e=Qd;return Qd=t,e}var zN=256,x0=zN-1,P0=5,qN=0,Vt={};function YN(t,e,n){let i;typeof n=="string"?i=n.charCodeAt(0)||0:n.hasOwnProperty(Ps)&&(i=n[Ps]),i==null&&(i=n[Ps]=qN++);let r=i&x0,s=1<<r;e.data[t+(r>>P0)]|=s}function k0(t,e){let n=F0(t,e);if(n!==-1)return n;let i=e[k];i.firstCreatePass&&(t.injectorIndex=e.length,Rd(i.data,t),Rd(e,null),Rd(i.blueprint,null));let r=ef(t,e),s=t.injectorIndex;if(O0(r)){let o=Pl(r),a=kl(r,e),l=a[k].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Rd(t,e){t.push(0,0,0,0,0,0,0,0,e)}function F0(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function ef(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;r!==null;){if(i=j0(r),i===null)return Er;if(n++,r=r[Mr],i.injectorIndex!==-1)return i.injectorIndex|n<<16}return Er}function KN(t,e,n){YN(t,e,n)}function JN(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let i=n.length,r=0;for(;r<i;){let s=n[r];if(Yy(s))break;if(s===0)r=r+2;else if(typeof s=="number")for(r++;r<i&&typeof n[r]=="string";)r++;else{if(s===e)return n[r+1];r=r+2}}}return null}function L0(t,e,n){if(n&L.Optional||t!==void 0)return t;kh(e,"NodeInjector")}function U0(t,e,n,i){if(n&L.Optional&&i===void 0&&(i=null),!(n&(L.Self|L.Host))){let r=t[Ir],s=at(void 0);try{return r?r.get(e,i,n&L.Optional):$y(e,i,n&L.Optional)}finally{at(s)}}return L0(i,e,n)}function B0(t,e,n,i=L.Default,r){if(t!==null){if(e[S]&2048&&!(i&L.Self)){let o=eA(t,e,n,i,Vt);if(o!==Vt)return o}let s=V0(t,e,n,i,Vt);if(s!==Vt)return s}return U0(e,n,i,r)}function V0(t,e,n,i,r){let s=ZN(n);if(typeof s=="function"){if(!C0(e,t,i))return i&L.Host?L0(r,n,i):U0(e,n,i,r);try{let o;if(o=s(i),o==null&&!(i&L.Optional))kh(n);else return o}finally{N0()}}else if(typeof s=="number"){let o=null,a=F0(t,e),l=Er,c=i&L.Host?e[St][tt]:null;for((a===-1||i&L.SkipSelf)&&(l=a===-1?ef(t,e):e[a+8],l===Er||!fy(i,!1)?a=-1:(o=e[k],a=Pl(l),e=kl(l,e)));a!==-1;){let u=e[k];if(hy(s,a,u.data)){let d=QN(a,e,n,o,i,c);if(d!==Vt)return d}l=e[a+8],l!==Er&&fy(i,e[k].data[a+8]===c)&&hy(s,a,e)?(o=u,a=Pl(l),e=kl(l,e)):a=-1}}return r}function QN(t,e,n,i,r,s){let o=e[k],a=o.data[t+8],l=i==null?Zl(a)&&Qd:i!=o&&(a.type&3)!==0,c=r&L.Host&&s===a,u=Il(a,o,n,l,c);return u!==null?Tr(e,o,u,a):Vt}function Il(t,e,n,i,r){let s=t.providerIndexes,o=e.data,a=s&1048575,l=t.directiveStart,c=t.directiveEnd,u=s>>20,d=i?a:a+u,h=r?a+u:c;for(let f=d;f<h;f++){let p=o[f];if(f<l&&n===p||f>=l&&p.type===n)return f}if(r){let f=o[l];if(f&&Js(f)&&f.type===n)return l}return null}function Tr(t,e,n,i){let r=t[n],s=e.data;if($N(r)){let o=r;o.resolving&&y1(v1(s[n]));let a=dy(o.canSeeViewProviders);o.resolving=!0;let l,c=o.injectImpl?at(o.injectImpl):null,u=C0(t,i,L.Default);try{r=t[n]=o.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&VN(n,s[n],e)}finally{c!==null&&at(c),dy(a),o.resolving=!1,N0()}}return r}function ZN(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Ps)?t[Ps]:void 0;return typeof e=="number"?e>=0?e&x0:XN:e}function hy(t,e,n){let i=1<<t;return!!(n[e+(t>>P0)]&i)}function fy(t,e){return!(t&L.Self)&&!(t&L.Host&&e)}var gi=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,i){return B0(this._tNode,this._lView,e,Kl(i),n)}};function XN(){return new gi(it(),Q())}function ec(t){return qs(()=>{let e=t.prototype.constructor,n=e[Nl]||Zd(e),i=Object.prototype,r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){let s=r[Nl]||Zd(r);if(s&&s!==n)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Zd(t){return Fy(t)?()=>{let e=Zd(lt(t));return e&&e()}:Dr(t)}function eA(t,e,n,i,r){let s=t,o=e;for(;s!==null&&o!==null&&o[S]&2048&&!(o[S]&512);){let a=V0(s,o,n,i|L.Self,Vt);if(a!==Vt)return a;let l=s.parent;if(!l){let c=o[a0];if(c){let u=c.get(n,Vt,i);if(u!==Vt)return u}l=j0(o),o=o[Mr]}s=l}return r}function j0(t){let e=t[k],n=e.type;return n===2?e.declTNode:n===1?t[tt]:null}function eo(t){return JN(it(),t)}function py(t,e=null,n=null,i){let r=$0(t,e,n,i);return r.resolveInjectorInitializers(),r}function $0(t,e=null,n=null,i,r=new Set){let s=[n||Dt,Q1(t)];return i=i||(typeof t=="object"?void 0:$e(t)),new Ls(s,e||jh(),i||null,r)}var Je=(()=>{class t{static{this.THROW_IF_NOT_FOUND=ks}static{this.NULL=new Rl}static create(n,i){if(Array.isArray(n))return py({name:""},i,n,"");{let r=n.name??"";return py({name:r},n.parent,n.providers,r)}}static{this.\u0275prov=E({token:t,providedIn:"any",factory:()=>T(Gy)})}static{this.__NG_ELEMENT_ID__=-1}}return t})();var tA="ngOriginalError";function Od(t){return t[tA]}var Ht=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Od(e);for(;n&&Od(n);)n=Od(n);return n||null}},H0=new A("",{providedIn:"root",factory:()=>v(Ht).handleError.bind(void 0)}),tc=(()=>{class t{static{this.__NG_ELEMENT_ID__=nA}static{this.__NG_ENV_ID__=n=>n}}return t})(),Xd=class extends tc{constructor(e){super(),this._lView=e}onDestroy(e){return _0(this._lView,e),()=>EN(this._lView,e)}};function nA(){return new Xd(Q())}function iA(){return Or(it(),Q())}function Or(t,e){return new Gt(ft(t,e))}var Gt=(()=>{class t{constructor(n){this.nativeElement=n}static{this.__NG_ELEMENT_ID__=iA}}return t})();function rA(t){return t instanceof Gt?t.nativeElement:t}var eh=class extends be{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,o0()&&(this.destroyRef=v(tc,{optional:!0})??void 0)}emit(e){let n=q(null);try{super.next(e)}finally{q(n)}}subscribe(e,n,i){let r=e,s=n||(()=>null),o=i;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=xd(s),r&&(r=xd(r)),o&&(o=xd(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof me&&e.add(a),a}};function xd(t){return e=>{setTimeout(t,void 0,e)}}var je=eh;function sA(){return this._results[Symbol.iterator]()}var th=class t{get changes(){return this._changes??=new je}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let n=t.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=sA)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;let i=M1(e);(this._changesDetected=!A1(this._results,i,n))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function W0(t){return(t.flags&128)===128}var G0=new Map,oA=0;function aA(){return oA++}function lA(t){G0.set(t[Ql],t)}function cA(t){G0.delete(t[Ql])}var gy="__ngContext__";function yi(t,e){pi(e)?(t[gy]=e[Ql],lA(e)):t[gy]=e}function z0(t){return Y0(t[Vs])}function q0(t){return Y0(t[Ct])}function Y0(t){for(;t!==null&&!vn(t);)t=t[Ct];return t}var nh;function K0(t){nh=t}function uA(){if(nh!==void 0)return nh;if(typeof document<"u")return document;throw new I(210,!1)}var tf=new A("",{providedIn:"root",factory:()=>dA}),dA="ng",nf=new A(""),Tt=new A("",{providedIn:"platform",factory:()=>"unknown"});var rf=new A("",{providedIn:"root",factory:()=>uA().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var hA="h",fA="b";var pA=()=>null;function sf(t,e,n=!1){return pA(t,e,n)}var J0=!1,gA=new A("",{providedIn:"root",factory:()=>J0});var wl;function mA(){if(wl===void 0&&(wl=null,fi.trustedTypes))try{wl=fi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return wl}function my(t){return mA()?.createScriptURL(t)||t}var Fl=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Py})`}};function to(t){return t instanceof Fl?t.changingThisBreaksApplicationSecurity:t}function of(t,e){let n=_A(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Py})`)}return n===e}function _A(t){return t instanceof Fl&&t.getTypeName()||null}var vA=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Q0(t){return t=String(t),t.match(vA)?t:"unsafe:"+t}var nc=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(nc||{});function no(t){let e=X0();return e?e.sanitize(nc.URL,t)||"":of(t,"URL")?to(t):Q0(Yl(t))}function yA(t){let e=X0();if(e)return my(e.sanitize(nc.RESOURCE_URL,t)||"");if(of(t,"ResourceURL"))return my(to(t));throw new I(904,!1)}function wA(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?yA:no}function Z0(t,e,n){return wA(e,n)(t)}function X0(){let t=Q();return t&&t[It].sanitizer}function ew(t){return t instanceof Function?t():t}function bA(t){return(t??v(Je)).get(Tt)==="browser"}var fn=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(fn||{}),EA;function af(t,e){return EA(t,e)}function wr(t,e,n,i,r){if(i!=null){let s,o=!1;vn(i)?s=i:pi(i)&&(o=!0,i=i[_n]);let a=$t(i);t===0&&n!==null?r==null?sw(e,n,a):Ul(e,n,a,r||null,!0):t===1&&n!==null?Ul(e,n,a,r||null,!0):t===2?LA(e,a,o):t===3&&e.destroyNode(a),s!=null&&BA(e,t,s,n,r)}}function DA(t,e){return t.createText(e)}function CA(t,e,n){t.setValue(e,n)}function tw(t,e,n){return t.createElement(e,n)}function IA(t,e){nw(t,e),e[_n]=null,e[tt]=null}function SA(t,e,n,i,r,s){i[_n]=r,i[tt]=e,ic(t,i,n,1,r,s)}function nw(t,e){e[It].changeDetectionScheduler?.notify(1),ic(t,e,e[Ee],2,null,null)}function TA(t){let e=t[Vs];if(!e)return Pd(t[k],t);for(;e;){let n=null;if(pi(e))n=e[Vs];else{let i=e[Ke];i&&(n=i)}if(!n){for(;e&&!e[Ct]&&e!==t;)pi(e)&&Pd(e[k],e),e=e[Re];e===null&&(e=t),pi(e)&&Pd(e[k],e),n=e&&e[Ct]}e=n}}function NA(t,e,n,i){let r=Ke+i,s=n.length;i>0&&(n[r-1][Ct]=e),i<s-Ke?(e[Ct]=n[r],Wy(n,Ke+i,e)):(n.push(e),e[Ct]=null),e[Re]=n;let o=e[Ks];o!==null&&n!==o&&AA(o,e);let a=e[hn];a!==null&&a.insertView(t),Kd(e),e[S]|=128}function AA(t,e){let n=t[Sr],r=e[Re][Re][St];e[St]!==r&&(t[S]|=$h.HasTransplantedViews),n===null?t[Sr]=[e]:n.push(e)}function iw(t,e){let n=t[Sr],i=n.indexOf(e);n.splice(i,1)}function Ll(t,e){if(t.length<=Ke)return;let n=Ke+e,i=t[n];if(i){let r=i[Ks];r!==null&&r!==t&&iw(r,i),e>0&&(t[n-1][Ct]=i[Ct]);let s=Ml(t,Ke+e);IA(i[k],i);let o=s[hn];o!==null&&o.detachView(s[k]),i[Re]=null,i[Ct]=null,i[S]&=-129}return i}function lf(t,e){if(!(e[S]&256)){let n=e[Ee];n.destroyNode&&ic(t,e,n,3,null,null),TA(e)}}function Pd(t,e){if(e[S]&256)return;let n=q(null);try{e[S]&=-129,e[S]|=256,e[mi]&&bv(e[mi]),RA(t,e),MA(t,e),e[k].type===1&&e[Ee].destroy();let i=e[Ks];if(i!==null&&vn(e[Re])){i!==e[Re]&&iw(i,e);let r=e[hn];r!==null&&r.detachView(t)}cA(e)}finally{q(n)}}function MA(t,e){let n=t.cleanup,i=e[Bs];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else{let o=i[n[s+1]];n[s].call(o)}i!==null&&(e[Bs]=null);let r=e[Fn];if(r!==null){e[Fn]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function RA(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let i=0;i<n.length;i+=2){let r=e[n[i]];if(!(r instanceof Hs)){let s=n[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],l=s[o+1];Bt(4,a,l);try{l.call(a)}finally{Bt(5,a,l)}}else{Bt(4,r,s);try{s.call(r)}finally{Bt(5,r,s)}}}}}function rw(t,e,n){return OA(t,e.parent,n)}function OA(t,e,n){let i=e;for(;i!==null&&i.type&40;)e=i,i=e.parent;if(i===null)return n[_n];{let{componentOffset:r}=i;if(r>-1){let{encapsulation:s}=t.data[i.directiveStart+r];if(s===jt.None||s===jt.Emulated)return null}return ft(i,n)}}function Ul(t,e,n,i,r){t.insertBefore(e,n,i,r)}function sw(t,e,n){t.appendChild(e,n)}function _y(t,e,n,i,r){i!==null?Ul(t,e,n,i,r):sw(t,e,n)}function xA(t,e,n,i){t.removeChild(e,n,i)}function cf(t,e){return t.parentNode(e)}function PA(t,e){return t.nextSibling(e)}function ow(t,e,n){return FA(t,e,n)}function kA(t,e,n){return t.type&40?ft(t,n):null}var FA=kA,vy;function uf(t,e,n,i){let r=rw(t,i,e),s=e[Ee],o=i.parent||e[tt],a=ow(o,i,e);if(r!=null)if(Array.isArray(n))for(let l=0;l<n.length;l++)_y(s,r,n[l],a,!1);else _y(s,r,n,a,!1);vy!==void 0&&vy(s,i,e,n,r)}function Sl(t,e){if(e!==null){let n=e.type;if(n&3)return ft(e,t);if(n&4)return ih(-1,t[e.index]);if(n&8){let i=e.child;if(i!==null)return Sl(t,i);{let r=t[e.index];return vn(r)?ih(-1,r):$t(r)}}else{if(n&32)return af(e,t)()||$t(t[e.index]);{let i=aw(t,e);if(i!==null){if(Array.isArray(i))return i[0];let r=$s(t[St]);return Sl(r,i)}else return Sl(t,e.next)}}}return null}function aw(t,e){if(e!==null){let i=t[St][tt],r=e.projection;return i.projection[r]}return null}function ih(t,e){let n=Ke+t+1;if(n<e.length){let i=e[n],r=i[k].firstChild;if(r!==null)return Sl(i,r)}return e[_i]}function LA(t,e,n){let i=cf(t,e);i&&xA(t,i,e,n)}function df(t,e,n,i,r,s,o){for(;n!=null;){let a=i[n.index],l=n.type;if(o&&e===0&&(a&&yi($t(a),i),n.flags|=2),(n.flags&32)!==32)if(l&8)df(t,e,n.child,i,r,s,!1),wr(e,t,r,a,s);else if(l&32){let c=af(n,i),u;for(;u=c();)wr(e,t,r,u,s);wr(e,t,r,a,s)}else l&16?lw(t,e,i,n,r,s):wr(e,t,r,a,s);n=o?n.projectionNext:n.next}}function ic(t,e,n,i,r,s){df(n,i,t.firstChild,e,r,s,!1)}function UA(t,e,n){let i=e[Ee],r=rw(t,n,e),s=n.parent||e[tt],o=ow(s,n,e);lw(i,0,e,n,r,o)}function lw(t,e,n,i,r,s){let o=n[St],l=o[tt].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];wr(e,t,r,u,s)}else{let c=l,u=o[Re];W0(i)&&(c.flags|=128),df(t,e,c,u,r,s,!0)}}function BA(t,e,n,i,r){let s=n[_i],o=$t(n);s!==o&&wr(e,t,i,s,r);for(let a=Ke;a<n.length;a++){let l=n[a];ic(l[k],l,t,e,i,s)}}function VA(t,e,n,i,r){if(e)r?t.addClass(n,i):t.removeClass(n,i);else{let s=i.indexOf("-")===-1?void 0:fn.DashCase;r==null?t.removeStyle(n,i,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=fn.Important),t.setStyle(n,i,r,s))}}function jA(t,e,n){t.setAttribute(e,"style",n)}function cw(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function uw(t,e,n){let{mergedAttrs:i,classes:r,styles:s}=n;i!==null&&Hd(t,e,i),r!==null&&cw(t,e,r),s!==null&&jA(t,e,s)}var Hn={};function le(t=1){dw(nt(),Q(),Rr()+t,!1)}function dw(t,e,n,i){if(!i)if((e[S]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Dl(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Cl(e,s,0,n)}vi(n)}function De(t,e=L.Default){let n=Q();if(n===null)return T(t,e);let i=it();return B0(i,n,lt(t),e)}function hw(){let t="invalid";throw new Error(t)}function fw(t,e,n,i,r,s){let o=q(null);try{let a=null;r&ct.SignalBased&&(a=e[i][_v]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&ct.HasDecoratorInputTransform&&(s=t.inputTransforms[i].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,i):u0(e,a,i,s)}finally{q(o)}}function $A(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let i=0;i<n.length;i++){let r=n[i];if(r<0)vi(~r);else{let s=r,o=n[++i],a=n[++i];PN(o,s);let l=e[s];a(2,l)}}}finally{vi(-1)}}function rc(t,e,n,i,r,s,o,a,l,c,u){let d=e.blueprint.slice();return d[_n]=r,d[S]=i|4|128|8|64,(c!==null||t&&t[S]&2048)&&(d[S]|=2048),m0(d),d[Re]=d[Mr]=t,d[ut]=n,d[It]=o||t&&t[It],d[Ee]=a||t&&t[Ee],d[Ir]=l||t&&t[Ir]||null,d[tt]=s,d[Ql]=aA(),d[Us]=u,d[a0]=c,d[St]=e.type==2?t[St]:d,d}function io(t,e,n,i,r){let s=t.data[e];if(s===null)s=HA(t,e,n,i,r),xN()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=i,s.attrs=r;let o=NN();s.injectorIndex=o===null?-1:o.injectorIndex}return Xs(s,!0),s}function HA(t,e,n,i,r){let s=w0(),o=b0(),a=o?s:s&&s.parent,l=t.data[e]=KA(t,a,n,e,i,r);return t.firstChild===null&&(t.firstChild=l),s!==null&&(o?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function pw(t,e,n,i){if(n===0)return-1;let r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function gw(t,e,n,i,r){let s=Rr(),o=i&2;try{vi(-1),o&&e.length>dt&&dw(t,e,dt,!1),Bt(o?2:0,r),n(i,r)}finally{vi(s),Bt(o?3:1,r)}}function mw(t,e,n){if(c0(e)){let i=q(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=t.data[o];if(a.contentQueries){let l=n[o];a.contentQueries(1,l,o)}}}finally{q(i)}}}function _w(t,e,n){v0()&&(tM(t,e,n,ft(n,e)),(n.flags&64)===64&&Dw(t,e,n))}function vw(t,e,n=ft){let i=e.localNames;if(i!==null){let r=e.index+1;for(let s=0;s<i.length;s+=2){let o=i[s+1],a=o===-1?n(e,t):t[o];t[r++]=a}}}function yw(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=hf(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function hf(t,e,n,i,r,s,o,a,l,c,u){let d=dt+i,h=d+r,f=WA(d,h),p=typeof c=="function"?c():c;return f[k]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}function WA(t,e){let n=[];for(let i=0;i<e;i++)n.push(i<t?null:Hn);return n}function GA(t,e,n,i){let s=i.get(gA,J0)||n===jt.ShadowDom,o=t.selectRootElement(e,s);return zA(o),o}function zA(t){qA(t)}var qA=()=>null;function YA(t,e,n,i){let r=Sw(e);r.push(n),t.firstCreatePass&&Tw(t).push(i,r.length-1)}function KA(t,e,n,i,r,s){let o=e?e.injectorIndex:-1,a=0;return y0()&&(a|=128),{type:n,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function yy(t,e,n,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;i??={};let a,l=ct.None;Array.isArray(o)?(a=o[0],l=o[1]):a=o;let c=s;if(r!==null){if(!r.hasOwnProperty(s))continue;c=r[s]}t===0?wy(i,n,c,a,l):wy(i,n,c,a)}return i}function wy(t,e,n,i,r){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,i):s=t[n]=[e,i],r!==void 0&&s.push(r)}function JA(t,e,n){let i=e.directiveStart,r=e.directiveEnd,s=t.data,o=e.attrs,a=[],l=null,c=null;for(let u=i;u<r;u++){let d=s[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;l=yy(0,d.inputs,u,l,f),c=yy(1,d.outputs,u,c,p);let _=l!==null&&o!==null&&!Bh(e)?hM(l,u,o):null;a.push(_)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function QA(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function ww(t,e,n,i,r,s,o,a){let l=ft(e,n),c=e.inputs,u;!a&&c!=null&&(u=c[i])?(ff(t,n,u,i,r),Zl(e)&&ZA(n,e.index)):e.type&3?(i=QA(i),r=o!=null?o(r,e.value||"",i):r,s.setProperty(l,i,r)):e.type&12}function ZA(t,e){let n=$n(e,t);n[S]&16||(n[S]|=64)}function bw(t,e,n,i){if(v0()){let r=i===null?null:{"":-1},s=iM(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Ew(t,e,n,o,r,a),r&&rM(n,i,r)}n.mergedAttrs=Uh(n.mergedAttrs,n.attrs)}function Ew(t,e,n,i,r,s){for(let c=0;c<i.length;c++)KN(k0(n,e),t,i[c].type);oM(n,t.data.length,i.length);for(let c=0;c<i.length;c++){let u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=pw(t,e,i.length,null);for(let c=0;c<i.length;c++){let u=i[c];n.mergedAttrs=Uh(n.mergedAttrs,u.hostAttrs),aM(t,n,e,l,u),sM(l,u,r),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),l++}JA(t,n,s)}function XA(t,e,n,i,r){let s=r.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;eM(o)!=a&&o.push(a),o.push(n,i,s)}}function eM(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function tM(t,e,n,i){let r=n.directiveStart,s=n.directiveEnd;Zl(n)&&lM(e,n,t.data[r+n.componentOffset]),t.firstCreatePass||k0(n,e),yi(i,e);let o=n.initialInputs;for(let a=r;a<s;a++){let l=t.data[a],c=Tr(e,t,a,n);if(yi(c,e),o!==null&&dM(e,a-r,c,l,n,o),Js(l)){let u=$n(n.index,e);u[ut]=Tr(e,t,a,n)}}}function Dw(t,e,n){let i=n.directiveStart,r=n.directiveEnd,s=n.index,o=kN();try{vi(s);for(let a=i;a<r;a++){let l=t.data[a],c=e[a];Jd(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&nM(l,c)}}finally{vi(-1),Jd(o)}}function nM(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function iM(t,e){let n=t.directiveRegistry,i=null,r=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(Jy(e,o.selectors,!1))if(i||(i=[]),Js(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o);let l=a.length;rh(t,e,l)}else i.unshift(o),rh(t,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return i===null?null:[i,r]}function rh(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function rM(t,e,n){if(e){let i=t.localNames=[];for(let r=0;r<e.length;r+=2){let s=n[e[r+1]];if(s==null)throw new I(-301,!1);i.push(e[r],s)}}}function sM(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;Js(e)&&(n[""]=t)}}function oM(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function aM(t,e,n,i,r){t.data[i]=r;let s=r.factory||(r.factory=Dr(r.type,!0)),o=new Hs(s,Js(r),De);t.blueprint[i]=o,n[i]=o,XA(t,e,i,pw(t,n,r.hostVars,Hn),r)}function lM(t,e,n){let i=ft(e,t),r=yw(n),s=t[It].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=sc(t,rc(t,r,null,o,i,e,null,s.createRenderer(i,n),null,null,null));t[e.index]=a}function cM(t,e,n,i,r,s){let o=ft(t,e);uM(e[Ee],o,s,t.value,n,i,r)}function uM(t,e,n,i,r,s,o){if(s==null)t.removeAttribute(e,r,n);else{let a=o==null?Yl(s):o(s,i||"",r);t.setAttribute(e,r,a,n)}}function dM(t,e,n,i,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let l=o[a++],c=o[a++],u=o[a++],d=o[a++];fw(i,n,l,c,u,d)}}function hM(t,e,n){let i=null,r=0;for(;r<n.length;){let s=n[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){i===null&&(i=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){i.push(s,o[a+1],o[a+2],n[r+1]);break}}r+=2}return i}function Cw(t,e,n,i){return[t,!0,0,e,null,i,null,n,null,null]}function Iw(t,e){let n=t.contentQueries;if(n!==null){let i=q(null);try{for(let r=0;r<n.length;r+=2){let s=n[r],o=n[r+1];if(o!==-1){let a=t.data[o];qh(s),a.contentQueries(2,e[o],o)}}}finally{q(i)}}}function sc(t,e){return t[Vs]?t[ly][Ct]=e:t[Vs]=e,t[ly]=e,e}function sh(t,e,n){qh(0);let i=q(null);try{e(t,n)}finally{q(i)}}function Sw(t){return t[Bs]||(t[Bs]=[])}function Tw(t){return t.cleanup||(t.cleanup=[])}function Nw(t,e){let n=t[Ir],i=n?n.get(Ht,null):null;i&&i.handleError(e)}function ff(t,e,n,i,r){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],l=n[s++],c=e[o],u=t.data[o];fw(u,c,i,a,l,r)}}function fM(t,e,n){let i=g0(e,t);CA(t[Ee],i,n)}function pM(t,e){let n=$n(e,t),i=n[k];gM(i,n);let r=n[_n];r!==null&&n[Us]===null&&(n[Us]=sf(r,n[Ir])),pf(i,n,n[ut])}function gM(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function pf(t,e,n){Yh(e);try{let i=t.viewQuery;i!==null&&sh(1,i,n);let r=t.template;r!==null&&gw(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[hn]?.finishViewCreation(t),t.staticContentQueries&&Iw(t,e),t.staticViewQueries&&sh(2,t.viewQuery,n);let s=t.components;s!==null&&mM(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{e[S]&=-5,Kh()}}function mM(t,e){for(let n=0;n<e.length;n++)pM(t,e[n])}function Aw(t,e,n,i){let r=q(null);try{let s=e.tView,a=t[S]&4096?4096:16,l=rc(t,s,n,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),c=t[e.index];l[Ks]=c;let u=t[hn];return u!==null&&(l[hn]=u.createEmbeddedView(s)),pf(s,l,n),l}finally{q(r)}}function _M(t,e){let n=Ke+e;if(n<t.length)return t[n]}function oh(t,e){return!e||e.firstChild===null||W0(t)}function Mw(t,e,n,i=!0){let r=e[k];if(NA(r,e,t,n),i){let o=ih(n,t),a=e[Ee],l=cf(a,t[_i]);l!==null&&SA(r,t[tt],a,e,l,o)}let s=e[Us];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function vM(t,e){let n=Ll(t,e);return n!==void 0&&lf(n[k],n),n}function Bl(t,e,n,i,r=!1){for(;n!==null;){let s=e[n.index];s!==null&&i.push($t(s)),vn(s)&&yM(s,i);let o=n.type;if(o&8)Bl(t,e,n.child,i);else if(o&32){let a=af(n,e),l;for(;l=a();)i.push(l)}else if(o&16){let a=aw(e,n);if(Array.isArray(a))i.push(...a);else{let l=$s(e[St]);Bl(l[k],l,a,i,!0)}}n=r?n.projectionNext:n.next}return i}function yM(t,e){for(let n=Ke;n<t.length;n++){let i=t[n],r=i[k].firstChild;r!==null&&Bl(i[k],i,r,e)}t[_i]!==t[_n]&&e.push(t[_i])}var Rw=[];function wM(t){return t[mi]??bM(t)}function bM(t){let e=Rw.pop()??Object.create(DM);return e.lView=t,e}function EM(t){t.lView[mi]!==t&&(t.lView=null,Rw.push(t))}var DM=ue(w({},vv),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{js(t.lView)},consumerOnSignalRead(){this.lView[mi]=this}}),Ow=100;function xw(t,e=!0,n=0){let i=t[It],r=i.rendererFactory,s=!1;s||r.begin?.();try{CM(t,n)}catch(o){throw e&&Nw(t,o),o}finally{s||(r.end?.(),i.inlineEffectRunner?.flush())}}function CM(t,e){ah(t,e);let n=0;for(;zh(t);){if(n===Ow)throw new I(103,!1);n++,ah(t,1)}}function IM(t,e,n,i){let r=e[S];if((r&256)===256)return;let s=!1;!s&&e[It].inlineEffectRunner?.flush(),Yh(e);let o=null,a=null;!s&&SM(t)&&(a=wM(e),o=yv(a));try{m0(e),RN(t.bindingStartIndex),n!==null&&gw(t,e,n,2,i);let l=(r&3)===3;if(!s)if(l){let d=t.preOrderCheckHooks;d!==null&&Dl(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Cl(e,d,0,null),Md(e,0)}if(TM(e),Pw(e,0),t.contentQueries!==null&&Iw(t,e),!s)if(l){let d=t.contentCheckHooks;d!==null&&Dl(e,d)}else{let d=t.contentHooks;d!==null&&Cl(e,d,1),Md(e,1)}$A(t,e);let c=t.components;c!==null&&Fw(e,c,0);let u=t.viewQuery;if(u!==null&&sh(2,u,i),!s)if(l){let d=t.viewCheckHooks;d!==null&&Dl(e,d)}else{let d=t.viewHooks;d!==null&&Cl(e,d,2),Md(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Ad]){for(let d of e[Ad])d();e[Ad]=null}s||(e[S]&=-73)}catch(l){throw js(e),l}finally{a!==null&&(wv(a,o),EM(a)),Kh()}}function SM(t){return t.type!==2}function Pw(t,e){for(let n=z0(t);n!==null;n=q0(n))for(let i=Ke;i<n.length;i++){let r=n[i];kw(r,e)}}function TM(t){for(let e=z0(t);e!==null;e=q0(e)){if(!(e[S]&$h.HasTransplantedViews))continue;let n=e[Sr];for(let i=0;i<n.length;i++){let r=n[i],s=r[Re];wN(r)}}}function NM(t,e,n){let i=$n(e,t);kw(i,n)}function kw(t,e){Gh(t)&&ah(t,e)}function ah(t,e){let i=t[k],r=t[S],s=t[mi],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&rd(s)),s&&(s.dirty=!1),t[S]&=-9217,o)IM(i,t,i.template,t[ut]);else if(r&8192){Pw(t,1);let a=i.components;a!==null&&Fw(t,a,1)}}function Fw(t,e,n){for(let i=0;i<e.length;i++)NM(t,e[i],n)}function gf(t){for(t[It].changeDetectionScheduler?.notify();t;){t[S]|=64;let e=$s(t);if(uN(t)&&!e)return t;t=e}return null}var wi=class{get rootNodes(){let e=this._lView,n=e[k];return Bl(n,e,n.firstChild,[])}constructor(e,n,i=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ut]}set context(e){this._lView[ut]=e}get destroyed(){return(this._lView[S]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Re];if(vn(e)){let n=e[Ol],i=n?n.indexOf(this):-1;i>-1&&(Ll(e,i),Ml(n,i))}this._attachedToViewContainer=!1}lf(this._lView[k],this._lView)}onDestroy(e){_0(this._lView,e)}markForCheck(){gf(this._cdRefInjectingView||this._lView)}detach(){this._lView[S]&=-129}reattach(){Kd(this._lView),this._lView[S]|=128}detectChanges(){this._lView[S]|=1024,xw(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new I(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,nw(this._lView[k],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new I(902,!1);this._appRef=e,Kd(this._lView)}},pn=(()=>{class t{static{this.__NG_ELEMENT_ID__=RM}}return t})(),AM=pn,MM=class extends AM{constructor(e,n,i){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,i){let r=Aw(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:i});return new wi(r)}};function RM(){return oc(it(),Q())}function oc(t,e){return t.type&4?new MM(e,t,Or(t,e)):null}var Q4=new RegExp(`^(\\d+)*(${fA}|${hA})*(.*)`);var OM=()=>null;function lh(t,e){return OM(t,e)}var Vl=class{},ch=class{},jl=class{};function xM(t){let e=Error(`No component factory found for ${$e(t)}.`);return e[PM]=t,e}var PM="ngComponent";var uh=class{resolveComponentFactory(e){throw xM(e)}},ac=(()=>{class t{static{this.NULL=new uh}}return t})(),Ws=class{},lc=(()=>{class t{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>kM()}}return t})();function kM(){let t=Q(),e=it(),n=$n(e.index,t);return(pi(n)?n:t)[Ee]}var FM=(()=>{class t{static{this.\u0275prov=E({token:t,providedIn:"root",factory:()=>null})}}return t})(),kd={};var by=new Set;function cc(t){by.has(t)||(by.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function Ey(...t){}function LM(){let t=typeof fi.requestAnimationFrame=="function",e=fi[t?"requestAnimationFrame":"setTimeout"],n=fi[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);let r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var K=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new je(!1),this.onMicrotaskEmpty=new je(!1),this.onStable=new je(!1),this.onError=new je(!1),typeof Zone>"u")throw new I(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=LM().nativeRequestAnimationFrame,VM(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new I(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new I(909,!1)}run(e,n,i){return this._inner.run(e,n,i)}runTask(e,n,i,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,UM,Ey,Ey);try{return s.runTask(o,n,i)}finally{s.cancelTask(o)}}runGuarded(e,n,i){return this._inner.runGuarded(e,n,i)}runOutsideAngular(e){return this._outer.run(e)}},UM={};function mf(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function BM(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(fi,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,dh(t),t.isCheckStableRunning=!0,mf(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),dh(t))}function VM(t){let e=()=>{BM(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{if(jM(a))return n.invokeTask(r,s,o,a);try{return Dy(t),n.invokeTask(r,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),Cy(t)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return Dy(t),n.invoke(r,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),Cy(t)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,dh(t),mf(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function dh(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function Dy(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Cy(t){t._nesting--,mf(t)}function jM(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var kn=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(kn||{}),$M={destroy(){}};function xr(t,e){!e&&lN(xr);let n=e?.injector??v(Je);if(!bA(n))return $M;cc("NgAfterNextRender");let i=n.get(_f),r=i.handler??=new fh,s=e?.phase??kn.MixedReadWrite,o=()=>{r.unregister(l),a()},a=n.get(tc).onDestroy(o),l=mn(n,()=>new hh(s,()=>{o(),t()}));return r.register(l),{destroy:o}}var hh=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=v(K),this.errorHandler=v(Ht,{optional:!0}),v(Vl,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},fh=class{constructor(){this.executingCallbacks=!1,this.buckets={[kn.EarlyRead]:new Set,[kn.Write]:new Set,[kn.MixedReadWrite]:new Set,[kn.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},_f=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of n)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=E({token:t,providedIn:"root",factory:()=>new t})}}return t})();function ph(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=Zv(r,a);else if(s==2){let l=a,c=e[++o];i=Zv(i,l+": "+c+";")}}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}var $l=class extends ac{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Ln(e);return new Nr(n,this.ngModule)}};function Iy(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let i=t[n];i!==void 0&&e.push({propName:Array.isArray(i)?i[0]:i,templateName:n})}return e}function HM(t){let e=t.toLowerCase();return e==="svg"?p0:e==="math"?pN:null}var gh=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,i){i=Kl(i);let r=this.injector.get(e,kd,i);return r!==kd||n===kd?r:this.parentInjector.get(e,n,i)}},Nr=class extends jl{get inputs(){let e=this.componentDef,n=e.inputTransforms,i=Iy(e.inputs);if(n!==null)for(let r of i)n.hasOwnProperty(r.propName)&&(r.transform=n[r.propName]);return i}get outputs(){return Iy(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=z1(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,i,r){let s=q(null);try{r=r||this.ngModule;let o=r instanceof He?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new gh(e,o):e,l=a.get(Ws,null);if(l===null)throw new I(407,!1);let c=a.get(FM,null),u=a.get(_f,null),d=a.get(Vl,null),h={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=l.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",_=i?GA(f,i,this.componentDef.encapsulation,a):tw(f,p,HM(p)),b=512;this.componentDef.signals?b|=4096:this.componentDef.onPush||(b|=16);let x=null;_!==null&&(x=sf(_,a,!0));let ve=hf(0,null,null,1,0,null,null,null,null,null,null),se=rc(null,ve,null,b,null,null,h,f,a,null,x);Yh(se);let ke,cn;try{let Be=this.componentDef,un,As=null;Be.findHostDirectiveDefs?(un=[],As=new Map,Be.findHostDirectiveDefs(Be,un,As),un.push(Be)):un=[Be];let Ms=WM(se,_),nd=GM(Ms,_,Be,un,se,h,f);cn=Wh(ve,dt),_&&YM(f,Be,_,i),n!==void 0&&KM(cn,this.ngContentSelectors,n),ke=qM(nd,Be,un,As,se,[JM]),pf(ve,se,null)}finally{Kh()}return new mh(this.componentType,ke,Or(cn,se),se,cn)}finally{q(s)}}},mh=class extends ch{constructor(e,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new wi(r,void 0,!1),this.componentType=e}setInput(e,n){let i=this._tNode.inputs,r;if(i!==null&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;ff(s[k],s,r,e,n),this.previousInputValues.set(e,n);let o=$n(this._tNode.index,s);gf(o)}}get injector(){return new gi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function WM(t,e){let n=t[k],i=dt;return t[i]=e,io(n,i,2,"#host",null)}function GM(t,e,n,i,r,s,o){let a=r[k];zM(i,t,e,o);let l=null;e!==null&&(l=sf(e,r[Ir]));let c=s.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=rc(r,yw(n),null,u,r[t.index],t,s,c,null,null,l);return a.firstCreatePass&&rh(a,t,i.length-1),sc(r,d),r[t.index]=d}function zM(t,e,n,i){for(let r of t)e.mergedAttrs=Uh(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(ph(e,e.mergedAttrs,!0),n!==null&&uw(i,n,e))}function qM(t,e,n,i,r,s){let o=it(),a=r[k],l=ft(o,r);Ew(a,r,o,n,null,i);for(let u=0;u<n.length;u++){let d=o.directiveStart+u,h=Tr(r,a,d,o);yi(h,r)}Dw(a,r,o),l&&yi(l,r);let c=Tr(r,a,o.directiveStart+o.componentOffset,o);if(t[ut]=r[ut]=c,s!==null)for(let u of s)u(c,e);return mw(a,o,r),c}function YM(t,e,n,i){if(i)Hd(t,n,["ng-version","17.3.12"]);else{let{attrs:r,classes:s}=q1(e.selectors[0]);r&&Hd(t,n,r),s&&s.length>0&&cw(t,n,s.join(" "))}}function KM(t,e,n){let i=t.projection=[];for(let r=0;r<e.length;r++){let s=n[r];i.push(s!=null?Array.from(s):null)}}function JM(){let t=it();Xh(Q()[k],t)}var zt=(()=>{class t{static{this.__NG_ELEMENT_ID__=QM}}return t})();function QM(){let t=it();return Uw(t,Q())}var ZM=zt,Lw=class extends ZM{constructor(e,n,i){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=i}get element(){return Or(this._hostTNode,this._hostLView)}get injector(){return new gi(this._hostTNode,this._hostLView)}get parentInjector(){let e=ef(this._hostTNode,this._hostLView);if(O0(e)){let n=kl(e,this._hostLView),i=Pl(e),r=n[k].data[i+8];return new gi(r,n)}else return new gi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=Sy(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Ke}createEmbeddedView(e,n,i){let r,s;typeof i=="number"?r=i:i!=null&&(r=i.index,s=i.injector);let o=lh(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,r,oh(this._hostTNode,o)),a}createComponent(e,n,i,r,s){let o=e&&!cN(e),a;if(o)a=n;else{let p=n||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let l=o?e:new Nr(Ln(e)),c=i||this.parentInjector;if(!s&&l.ngModule==null){let _=(o?c:this.parentInjector).get(He,null);_&&(s=_)}let u=Ln(l.componentType??{}),d=lh(this._lContainer,u?.id??null),h=d?.firstChild??null,f=l.create(c,r,h,s);return this.insertImpl(f.hostView,a,oh(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,i){let r=e._lView;if(yN(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[Re],c=new Lw(l,l[tt],l[Re]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return Mw(o,r,s,i),e.attachToViewContainerRef(),Wy(Fd(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=Sy(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),i=Ll(this._lContainer,n);i&&(Ml(Fd(this._lContainer),n),lf(i[k],i))}detach(e){let n=this._adjustIndex(e,-1),i=Ll(this._lContainer,n);return i&&Ml(Fd(this._lContainer),n)!=null?new wi(i):null}_adjustIndex(e,n=0){return e??this.length+n}};function Sy(t){return t[Ol]}function Fd(t){return t[Ol]||(t[Ol]=[])}function Uw(t,e){let n,i=e[t.index];return vn(i)?n=i:(n=Cw(i,e,null,t),e[t.index]=n,sc(e,n)),eR(n,e,t,i),new Lw(n,t,e)}function XM(t,e){let n=t[Ee],i=n.createComment(""),r=ft(e,t),s=cf(n,r);return Ul(n,s,i,PA(n,r),!1),i}var eR=iR,tR=()=>!1;function nR(t,e,n){return tR(t,e,n)}function iR(t,e,n,i){if(t[_i])return;let r;n.type&8?r=$t(i):r=XM(e,n),t[_i]=r}var _h=class t{constructor(e){this.queryList=e,this.matches=null}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},vh=class t{constructor(e=[]){this.queries=e}createEmbeddedView(e){let n=e.queries;if(n!==null){let i=e.contentQueries!==null?e.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){let o=n.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new t(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)vf(e,n).matches!==null&&this.queries[n].setDirty()}},yh=class{constructor(e,n,i=null){this.flags=n,this.read=i,typeof e=="string"?this.predicate=dR(e):this.predicate=e}},wh=class t{constructor(e=[]){this.queries=e}elementStart(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let i=0;i<this.length;i++){let r=n!==null?n.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,n!==null?n.push(s):n=[s])}return n!==null?new t(n):null}template(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},bh=class t{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==n;)i=i.parent;return n===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,n){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let s=i[r];this.matchTNodeWithReadOption(e,n,rR(n,s)),this.matchTNodeWithReadOption(e,n,Il(n,e,s,!1,!1))}else i===pn?n.type&4&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Il(n,e,i,!1,!1))}matchTNodeWithReadOption(e,n,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Gt||r===zt||r===pn&&n.type&4)this.addMatch(n.index,-2);else{let s=Il(n,e,r,!1,!1);s!==null&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(e,n){this.matches===null?this.matches=[e,n]:this.matches.push(e,n)}};function rR(t,e){let n=t.localNames;if(n!==null){for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1]}return null}function sR(t,e){return t.type&11?Or(t,e):t.type&4?oc(t,e):null}function oR(t,e,n,i){return n===-1?sR(e,t):n===-2?aR(t,e,i):Tr(t,t[k],n,e)}function aR(t,e,n){if(n===Gt)return Or(e,t);if(n===pn)return oc(e,t);if(n===zt)return Uw(e,t)}function Bw(t,e,n,i){let r=e[hn].queries[i];if(r.matches===null){let s=t.data,o=n.matches,a=[];for(let l=0;o!==null&&l<o.length;l+=2){let c=o[l];if(c<0)a.push(null);else{let u=s[c];a.push(oR(e,u,o[l+1],n.metadata.read))}}r.matches=a}return r.matches}function Eh(t,e,n,i){let r=t.queries.getByIndex(n),s=r.matches;if(s!==null){let o=Bw(t,e,r,n);for(let a=0;a<s.length;a+=2){let l=s[a];if(l>0)i.push(o[a/2]);else{let c=s[a+1],u=e[-l];for(let d=Ke;d<u.length;d++){let h=u[d];h[Ks]===h[Re]&&Eh(h[k],h,c,i)}if(u[Sr]!==null){let d=u[Sr];for(let h=0;h<d.length;h++){let f=d[h];Eh(f[k],f,c,i)}}}}}return i}function lR(t,e){return t[hn].queries[e].queryList}function cR(t,e,n){let i=new th((n&4)===4);return YA(t,e,i,i.destroy),(e[hn]??=new vh).queries.push(new _h(i))-1}function uR(t,e,n,i){let r=nt();if(r.firstCreatePass){let s=it();hR(r,new yh(e,n,i),s.index),fR(r,t),(n&2)===2&&(r.staticContentQueries=!0)}return cR(r,Q(),n)}function dR(t){return t.split(",").map(e=>e.trim())}function hR(t,e,n){t.queries===null&&(t.queries=new wh),t.queries.track(new bh(e,n))}function fR(t,e){let n=t.contentQueries||(t.contentQueries=[]),i=n.length?n[n.length-1]:-1;e!==i&&n.push(t.queries.length-1,e)}function vf(t,e){return t.queries.getByIndex(e)}function pR(t,e){let n=t[k],i=vf(n,e);return i.crossesNgTemplate?Eh(n,t,e,[]):Bw(n,t,i,e)}function yf(t){let e=t.inputConfig,n={};for(let i in e)if(e.hasOwnProperty(i)){let r=e[i];Array.isArray(r)&&r[3]&&(n[i]=r[3])}t.inputTransforms=n}var Un=class{},Gs=class{};var Dh=class extends Un{constructor(e,n,i){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new $l(this);let r=e0(e);this._bootstrapComponents=ew(r.bootstrap),this._r3Injector=$0(e,n,[{provide:Un,useValue:this},{provide:ac,useValue:this.componentFactoryResolver},...i],$e(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Ch=class extends Gs{constructor(e){super(),this.moduleType=e}create(e){return new Dh(this.moduleType,e,[])}};var Hl=class extends Un{constructor(e){super(),this.componentFactoryResolver=new $l(this),this.instance=null;let n=new Ls([...e.providers,{provide:Un,useValue:this},{provide:ac,useValue:this.componentFactoryResolver}],e.parent||jh(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function uc(t,e,n=null){return new Hl({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var dc=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ie(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Vw(t){return mR(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function gR(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),i;for(;!(i=n.next()).done;)e(i.value)}}function mR(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function _R(t,e,n){return t[e]=n}function vR(t,e){return t[e]}function ro(t,e,n){let i=t[e];return Object.is(i,n)?!1:(t[e]=n,!0)}function yR(t){return(t.flags&32)===32}function wR(t,e,n,i,r,s,o,a,l){let c=e.consts,u=io(e,t,4,o||null,xl(c,a));bw(e,n,u,xl(c,l)),Xh(e,u);let d=u.tView=hf(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function qt(t,e,n,i,r,s,o,a){let l=Q(),c=nt(),u=t+dt,d=c.firstCreatePass?wR(u,c,l,e,n,i,r,s,o):c.data[u];Xs(d,!1);let h=bR(c,l,d,t);Qh()&&uf(c,l,h,d),yi(h,l);let f=Cw(h,l,h,d);return l[u]=f,sc(l,f),nR(f,d,l),Hh(d)&&_w(c,l,d),o!=null&&vw(l,d,a),qt}var bR=ER;function ER(t,e,n,i){return Zh(!0),e[Ee].createComment("")}function so(t,e,n,i){let r=Q(),s=Xl();if(ro(r,s,e)){let o=nt(),a=Jh();cM(a,r,t,e,n,i)}return so}function jw(t,e,n,i){return ro(t,Xl(),n)?e+Yl(n)+i:Hn}function bl(t,e){return t<<17|e<<2}function bi(t){return t>>17&32767}function DR(t){return(t&2)==2}function CR(t,e){return t&131071|e<<17}function Ih(t){return t|2}function Ar(t){return(t&131068)>>2}function Ld(t,e){return t&-131069|e<<2}function IR(t){return(t&1)===1}function Sh(t){return t|1}function SR(t,e,n,i,r,s){let o=s?e.classBindings:e.styleBindings,a=bi(o),l=Ar(o);t[i]=n;let c=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||Ys(d,u)>0)&&(c=!0)}else u=n;if(r)if(l!==0){let h=bi(t[a+1]);t[i+1]=bl(h,a),h!==0&&(t[h+1]=Ld(t[h+1],i)),t[a+1]=CR(t[a+1],i)}else t[i+1]=bl(a,0),a!==0&&(t[a+1]=Ld(t[a+1],i)),a=i;else t[i+1]=bl(l,0),a===0?a=i:t[l+1]=Ld(t[l+1],i),l=i;c&&(t[i+1]=Ih(t[i+1])),Ty(t,u,i,!0),Ty(t,u,i,!1),TR(e,u,t,i,s),o=bl(a,l),s?e.classBindings=o:e.styleBindings=o}function TR(t,e,n,i,r){let s=r?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Ys(s,e)>=0&&(n[i+1]=Sh(n[i+1]))}function Ty(t,e,n,i){let r=t[n+1],s=e===null,o=i?bi(r):Ar(r),a=!1;for(;o!==0&&(a===!1||s);){let l=t[o],c=t[o+1];NR(l,e)&&(a=!0,t[o+1]=i?Sh(c):Ih(c)),o=i?bi(c):Ar(c)}a&&(t[n+1]=i?Ih(r):Sh(r))}function NR(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Ys(t,e)>=0:!1}function Oe(t,e,n){let i=Q(),r=Xl();if(ro(i,r,e)){let s=nt(),o=Jh();ww(s,o,i,t,e,i[Ee],n,!1)}return Oe}function Ny(t,e,n,i,r){let s=e.inputs,o=r?"class":"style";ff(t,n,s[o],o,i)}function wf(t,e){return AR(t,e,null,!0),wf}function AR(t,e,n,i){let r=Q(),s=nt(),o=ON(2);if(s.firstUpdatePass&&RR(s,t,o,i),e!==Hn&&ro(r,o,e)){let a=s.data[Rr()];FR(s,a,r,r[Ee],t,r[o+1]=LR(e,n),i,o)}}function MR(t,e){return e>=t.expandoStartIndex}function RR(t,e,n,i){let r=t.data;if(r[n+1]===null){let s=r[Rr()],o=MR(t,n);UR(s,i)&&e===null&&!o&&(e=!1),e=OR(r,s,e,i),SR(r,s,e,n,o,i)}}function OR(t,e,n,i){let r=FN(t),s=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(n=Ud(null,t,e,n,i),n=zs(n,e.attrs,i),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==r)if(n=Ud(r,t,e,n,i),s===null){let l=xR(t,e,i);l!==void 0&&Array.isArray(l)&&(l=Ud(null,t,e,l[1],i),l=zs(l,e.attrs,i),PR(t,e,i,l))}else s=kR(t,e,i)}return s!==void 0&&(i?e.residualClasses=s:e.residualStyles=s),n}function xR(t,e,n){let i=n?e.classBindings:e.styleBindings;if(Ar(i)!==0)return t[bi(i)]}function PR(t,e,n,i){let r=n?e.classBindings:e.styleBindings;t[bi(r)]=i}function kR(t,e,n){let i,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=t[s].hostAttrs;i=zs(i,o,n)}return zs(i,e.attrs,n)}function Ud(t,e,n,i,r){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],i=zs(i,s.hostAttrs,r),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),i}function zs(t,e,n){let i=n?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===i&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),x1(t,o,n?!0:e[++s]))}return t===void 0?null:t}function FR(t,e,n,i,r,s,o,a){if(!(e.type&3))return;let l=t.data,c=l[a+1],u=IR(c)?Ay(l,e,n,r,Ar(c),o):void 0;if(!Wl(u)){Wl(s)||DR(c)&&(s=Ay(l,null,n,r,a,o));let d=g0(Rr(),n);VA(i,o,d,r,s)}}function Ay(t,e,n,i,r,s){let o=e===null,a;for(;r>0;){let l=t[r],c=Array.isArray(l),u=c?l[1]:l,d=u===null,h=n[r+1];h===Hn&&(h=d?Dt:void 0);let f=d?Td(h,i):u===i?h:void 0;if(c&&!Wl(f)&&(f=Td(l,i)),Wl(f)&&(a=f,o))return a;let p=t[r+1];r=o?bi(p):Ar(p)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(a=Td(l,i))}return a}function Wl(t){return t!==void 0}function LR(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=$e(to(t)))),t}function UR(t,e){return(t.flags&(e?8:16))!==0}function $w(t,e,n){cc("NgControlFlow");let i=Q(),r=Xl(),s=BR(i,dt+t),o=0;if(ro(i,r,e)){let a=q(null);try{if(vM(s,o),e!==-1){let l=VR(i[k],dt+e),c=lh(s,l.tView.ssrId),u=Aw(i,l,n,{dehydratedView:c});Mw(s,u,o,oh(l,c))}}finally{q(a)}}else{let a=_M(s,o);a!==void 0&&(a[ut]=n)}}function BR(t,e){return t[e]}function VR(t,e){return Wh(t,e)}function jR(t,e,n,i,r,s){let o=e.consts,a=xl(o,r),l=io(e,t,2,i,a);return bw(e,n,l,xl(o,s)),l.attrs!==null&&ph(l,l.attrs,!1),l.mergedAttrs!==null&&ph(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function N(t,e,n,i){let r=Q(),s=nt(),o=dt+t,a=r[Ee],l=s.firstCreatePass?jR(o,s,r,e,n,i):s.data[o],c=$R(s,r,l,a,e,t);r[o]=c;let u=Hh(l);return Xs(l,!0),uw(a,c,l),!yR(l)&&Qh()&&uf(s,r,c,l),DN()===0&&yi(c,r),CN(),u&&(_w(s,r,l),mw(s,l,r)),i!==null&&vw(r,l),N}function M(){let t=it();b0()?E0():(t=t.parent,Xs(t,!1));let e=t;SN(e)&&TN(),IN();let n=nt();return n.firstCreatePass&&(Xh(n,t),c0(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&HN(e)&&Ny(n,e,Q(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&WN(e)&&Ny(n,e,Q(),e.stylesWithoutHost,!1),M}function Ce(t,e,n,i){return N(t,e,n,i),M(),Ce}var $R=(t,e,n,i,r,s)=>(Zh(!0),tw(i,r,BN()));function oo(){return Q()}var Gl="en-US";var HR=Gl;function WR(t){typeof t=="string"&&(HR=t.toLowerCase().replace(/_/g,"-"))}function Nt(t,e,n,i){let r=Q(),s=nt(),o=it();return zR(s,r,r[Ee],o,t,e,i),Nt}function GR(t,e,n,i){let r=t.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===n&&r[s+1]===i){let a=e[Bs],l=r[s+2];return a.length>l?a[l]:null}typeof o=="string"&&(s+=2)}return null}function zR(t,e,n,i,r,s,o){let a=Hh(i),c=t.firstCreatePass&&Tw(t),u=e[ut],d=Sw(e),h=!0;if(i.type&3||o){let _=ft(i,e),b=o?o(_):_,x=d.length,ve=o?ke=>o($t(ke[i.index])):i.index,se=null;if(!o&&a&&(se=GR(t,e,r,i.index)),se!==null){let ke=se.__ngLastListenerFn__||se;ke.__ngNextListenerFn__=s,se.__ngLastListenerFn__=s,h=!1}else{s=Ry(i,e,u,s,!1);let ke=n.listen(b,r,s);d.push(s,ke),c&&c.push(r,ve,x,x+1)}}else s=Ry(i,e,u,s,!1);let f=i.outputs,p;if(h&&f!==null&&(p=f[r])){let _=p.length;if(_)for(let b=0;b<_;b+=2){let x=p[b],ve=p[b+1],cn=e[x][ve].subscribe(s),Be=d.length;d.push(s,cn),c&&c.push(r,i.index,Be,-(Be+1))}}}function My(t,e,n,i){let r=q(null);try{return Bt(6,e,n),n(i)!==!1}catch(s){return Nw(t,s),!1}finally{Bt(7,e,n),q(r)}}function Ry(t,e,n,i,r){return function s(o){if(o===Function)return i;let a=t.componentOffset>-1?$n(t.index,e):e;gf(a);let l=My(e,n,i,o),c=s.__ngNextListenerFn__;for(;c;)l=My(e,n,c,o)&&l,c=c.__ngNextListenerFn__;return r&&l===!1&&o.preventDefault(),l}}function yn(t=1){return UN(t)}function qR(t,e){let n=null,i=j1(t);for(let r=0;r<e.length;r++){let s=e[r];if(s==="*"){n=r;continue}if(i===null?Jy(t,s,!0):W1(i,s))return r}return n}function Hw(t){let e=Q()[St][tt];if(!e.projection){let n=t?t.length:1,i=e.projection=R1(n,null),r=i.slice(),s=e.child;for(;s!==null;){let o=t?qR(s,t):0;o!==null&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function Ww(t,e=0,n){let i=Q(),r=nt(),s=io(r,dt+t,16,null,n||null);s.projection===null&&(s.projection=e),E0(),(!i[Us]||y0())&&(s.flags&32)!==32&&UA(r,i,s)}function ao(t,e,n){return Gw(t,"",e,"",n),ao}function Gw(t,e,n,i,r){let s=Q(),o=jw(s,e,n,i);if(o!==Hn){let a=nt(),l=Jh();ww(a,l,s,t,o,s[Ee],r,!1)}return Gw}function bf(t,e,n,i){uR(t,e,n,i)}function Ef(t){let e=Q(),n=nt(),i=D0();qh(i+1);let r=vf(n,i);if(t.dirty&&vN(e)===((r.metadata.flags&2)===2)){if(r.matches===null)t.reset([]);else{let s=pR(e,i);t.reset(s,rA),t.notifyOnChanges()}return!0}return!1}function Df(){return lR(Q(),D0())}function zw(t){let e=AN();return _N(e,dt+t)}function ee(t,e=""){let n=Q(),i=nt(),r=t+dt,s=i.firstCreatePass?io(i,r,1,e,null):i.data[r],o=YR(i,n,s,e,t);n[r]=o,Qh()&&uf(i,n,o,s),Xs(s,!1)}var YR=(t,e,n,i,r)=>(Zh(!0),DA(e[Ee],i));function Yt(t){return Cf("",t,""),Yt}function Cf(t,e,n){let i=Q(),r=jw(i,t,e,n);return r!==Hn&&fM(i,Rr(),r),Cf}var KR=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let i=i0(!1,n.type),r=i.length>0?uc([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,r)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=E({token:t,providedIn:"environment",factory:()=>new t(T(He))})}}return t})();function Kt(t){cc("NgStandalone"),t.getStandaloneInjector=e=>e.get(KR).getOrCreateStandaloneInjector(t)}function qw(t,e,n){let i=MN()+t,r=Q();return r[i]===Hn?_R(r,i,n?e.call(n):e()):vR(r,i)}function Yw(t,e){return oc(t,e)}var Bn=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},Kw=new Bn("17.3.12"),hc=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();var Jw=new A("");function lo(t){return!!t&&typeof t.then=="function"}function Qw(t){return!!t&&typeof t.subscribe=="function"}var fc=new A(""),Zw=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=v(fc,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let n=[];for(let r of this.appInits){let s=r();if(lo(s))n.push(s);else if(Qw(s)){let o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});n.push(o)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),n.length===0&&i(),this.initialized=!0}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),pc=new A("");function JR(){Ev(()=>{throw new I(600,!1)})}function QR(t){return t.isBoundToModule}function ZR(t,e,n){try{let i=n();return lo(i)?i.catch(r=>{throw e.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}var Pr=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=v(H0),this.afterRenderEffectManager=v(_f),this.externalTestViews=new Set,this.beforeRender=new be,this.afterTick=new be,this.componentTypes=[],this.components=[],this.isStable=v(dc).hasPendingTasks.pipe(j(n=>!n)),this._injector=v(He)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){let r=n instanceof jl;if(!this._injector.get(Zw).done){let h=!r&&Xy(n),f=!1;throw new I(405,f)}let o;r?o=n:o=this._injector.get(ac).resolveComponentFactory(n),this.componentTypes.push(o.componentType);let a=QR(o)?void 0:this._injector.get(Un),l=i||o.selector,c=o.create(Je.NULL,[],l,a),u=c.location.nativeElement,d=c.injector.get(Jw,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Bd(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new I(101,!1);let i=q(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,q(i)}}detectChangesInAttachedViews(n){let i=0,r=this.afterRenderEffectManager;for(;;){if(i===Ow)throw new I(103,!1);if(n){let s=i===0;this.beforeRender.next(s);for(let{_lView:o,notifyErrorHandler:a}of this._views)XR(o,s,a)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>Th(s))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>Th(s))))break}}attachView(n){let i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){let i=n;Bd(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);let i=this._injector.get(pc,[]);[...this._bootstrapListeners,...i].forEach(r=>r(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Bd(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new I(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Bd(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function XR(t,e,n){!e&&!Th(t)||eO(t,n,e)}function Th(t){return zh(t)}function eO(t,e,n){let i;n?(i=0,t[S]|=1024):t[S]&64?i=0:i=1,xw(t,e,i)}var Nh=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},gc=(()=>{class t{compileModuleSync(n){return new Ch(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let i=this.compileModuleSync(n),r=e0(n),s=ew(r.declarations).reduce((o,a)=>{let l=Ln(a);return l&&o.push(new Nr(l)),o},[]);return new Nh(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var tO=(()=>{class t{constructor(){this.zone=v(K),this.applicationRef=v(Pr)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function nO(t){return[{provide:K,useFactory:t},{provide:Cr,multi:!0,useFactory:()=>{let e=v(tO,{optional:!0});return()=>e.initialize()}},{provide:Cr,multi:!0,useFactory:()=>{let e=v(oO);return()=>{e.initialize()}}},{provide:H0,useFactory:iO}]}function iO(){let t=v(K),e=v(Ht);return n=>t.runOutsideAngular(()=>e.handleError(n))}function rO(t){let e=nO(()=>new K(sO(t)));return Vn([[],e])}function sO(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var oO=(()=>{class t{constructor(){this.subscription=new me,this.initialized=!1,this.zone=v(K),this.pendingTasks=v(dc)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{K.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{K.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function aO(){return typeof $localize<"u"&&$localize.locale||Gl}var mc=new A("",{providedIn:"root",factory:()=>v(mc,L.Optional|L.SkipSelf)||aO()});var Xw=new A("");var Tl=null;function lO(t=[],e){return Je.create({name:e,providers:[{provide:Jl,useValue:"platform"},{provide:Xw,useValue:new Set([()=>Tl=null])},...t]})}function cO(t=[]){if(Tl)return Tl;let e=lO(t);return Tl=e,JR(),uO(e),e}function uO(t){t.get(nf,null)?.forEach(n=>n())}var Ci=(()=>{class t{static{this.__NG_ELEMENT_ID__=dO}}return t})();function dO(t){return hO(it(),Q(),(t&16)===16)}function hO(t,e,n){if(Zl(t)&&!n){let i=$n(t.index,e);return new wi(i,i)}else if(t.type&47){let i=e[St];return new wi(i,e)}return null}var Ah=class{constructor(){}supports(e){return Vw(e)}create(e){return new Mh(e)}},fO=(t,e)=>e,Mh=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||fO}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){let o=!i||n&&n.currentIndex<Oy(i,r,s)?n:i,a=Oy(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(n=n._next,o.previousIndex==null)r++;else{s||(s=[]);let c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!Vw(e))throw new I(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,i=!1,r,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),i=!0):(i&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else r=0,gR(e,a=>{o=this._trackByFn(r,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,r),i=!0):(i&&(n=this._verifyReinsertion(n,a,o,r)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,i,r){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,r)):e=this._addAfter(new Rh(n,i),s,r)),e}_verifyReinsertion(e,n,i,r){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return s!==null?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,s=e._nextRemoved;return r===null?this._removalsHead=s:r._nextRemoved=s,s===null?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,n,i),this._addToMoves(e,i),e}_moveAfter(e,n,i){return this._unlink(e),this._insertAfter(e,n,i),this._addToMoves(e,i),e}_addAfter(e,n,i){return this._insertAfter(e,n,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,i){let r=n===null?this._itHead:n._next;return e._next=r,e._prev=n,r===null?this._itTail=e:r._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new zl),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,i=e._next;return n===null?this._itHead=i:n._next=i,i===null?this._itTail=n:i._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new zl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Rh=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Oh=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let i;for(i=this._head;i!==null;i=i._nextDup)if((n===null||n<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let n=e._prevDup,i=e._nextDup;return n===null?this._head=i:n._nextDup=i,i===null?this._tail=n:i._prevDup=n,this._head===null}},zl=class{constructor(){this.map=new Map}put(e){let n=e.trackById,i=this.map.get(n);i||(i=new Oh,this.map.set(n,i)),i.add(e)}get(e,n){let i=e,r=this.map.get(i);return r?r.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Oy(t,e,n){let i=t.previousIndex;if(i===null)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}function xy(){return new If([new Ah])}var If=(()=>{class t{static{this.\u0275prov=E({token:t,providedIn:"root",factory:xy})}constructor(n){this.factories=n}static create(n,i){if(i!=null){let r=i.factories.slice();n=n.concat(r)}return new t(n)}static extend(n){return{provide:t,useFactory:i=>t.create(n,i||xy()),deps:[[t,new Fh,new ht]]}}find(n){let i=this.factories.find(r=>r.supports(n));if(i!=null)return i;throw new I(901,!1)}}return t})();function eb(t){try{let{rootComponent:e,appProviders:n,platformProviders:i}=t,r=cO(i),s=[rO(),...n||[]],a=new Hl({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,l=a.get(K);return l.run(()=>{a.resolveInjectorInitializers();let c=a.get(Ht,null),u;l.runOutsideAngular(()=>{u=l.onError.subscribe({next:f=>{c.handleError(f)}})});let d=()=>a.destroy(),h=r.get(Xw);return h.add(d),a.onDestroy(()=>{u.unsubscribe(),h.delete(d)}),ZR(c,l,()=>{let f=a.get(Zw);return f.runInitializers(),f.donePromise.then(()=>{let p=a.get(mc,Gl);WR(p||Gl);let _=a.get(Pr);return e!==void 0&&_.bootstrap(e),_})})})}catch(e){return Promise.reject(e)}}function co(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function tb(t){let e=Ln(t);if(!e)return null;let n=new Nr(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var ob=null;function kr(){return ob}function ab(t){ob??=t}var _c=class{};var We=new A(""),Mf=(()=>{class t{historyGo(n){throw new Error("")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>v(gO),providedIn:"platform"})}}return t})(),lb=new A(""),gO=(()=>{class t extends Mf{constructor(){super(),this._doc=v(We),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return kr().getBaseHref(this._doc)}onPopState(n){let i=kr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){let i=kr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,r){this._history.pushState(n,i,r)}replaceState(n,i,r){this._history.replaceState(n,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>new t,providedIn:"platform"})}}return t})();function Rf(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function nb(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,i=n-(t[n-1]==="/"?1:0);return t.slice(0,i)+t.slice(n)}function bn(t){return t&&t[0]!=="?"?"?"+t:t}var Jt=(()=>{class t{historyGo(n){throw new Error("")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>v(Of),providedIn:"root"})}}return t})(),cb=new A(""),Of=(()=>{class t extends Jt{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??v(We).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Rf(this._baseHref,n)}path(n=!1){let i=this._platformLocation.pathname+bn(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){let o=this.prepareExternalUrl(r+bn(s));this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){let o=this.prepareExternalUrl(r+bn(s));this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static{this.\u0275fac=function(i){return new(i||t)(T(Mf),T(cb,8))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),xf=(()=>{class t extends Jt{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(n){let i=Rf(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,s){let o=this.prepareExternalUrl(r+bn(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){let o=this.prepareExternalUrl(r+bn(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static{this.\u0275fac=function(i){return new(i||t)(T(Mf),T(cb,8))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),Fr=(()=>{class t{constructor(n){this._subject=new je,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;let i=this._locationStrategy.getBaseHref();this._basePath=vO(nb(ib(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+bn(i))}normalize(n){return t.stripTrailingSlash(_O(this._basePath,ib(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._locationStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+bn(i)),r)}replaceState(n,i="",r=null){this._locationStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+bn(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}static{this.normalizeQueryParams=bn}static{this.joinWithSlash=Rf}static{this.stripTrailingSlash=nb}static{this.\u0275fac=function(i){return new(i||t)(T(Jt))}}static{this.\u0275prov=E({token:t,factory:()=>mO(),providedIn:"root"})}}return t})();function mO(){return new Fr(T(Jt))}function _O(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function ib(t){return t.replace(/\/index.html$/,"")}function vO(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function ub(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let i=n.indexOf("="),[r,s]=i==-1?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var Sf=class{constructor(e,n,i,r){this.$implicit=e,this.ngForOf=n,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},db=(()=>{class t{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let n=this._ngForOf;if(!this._differ&&n)if(0)try{}catch{}else this._differ=this._differs.find(n).create(this.ngForTrackBy)}if(this._differ){let n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){let i=this._viewContainer;n.forEachOperation((r,s,o)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Sf(r.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)i.remove(s===null?void 0:s);else if(s!==null){let a=i.get(s);i.move(a,o),rb(a,r)}});for(let r=0,s=i.length;r<s;r++){let a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{let s=i.get(r.currentIndex);rb(s,r)})}static ngTemplateContextGuard(n,i){return!0}static{this.\u0275fac=function(i){return new(i||t)(De(zt),De(pn),De(If))}}static{this.\u0275dir=gn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return t})();function rb(t,e){t.context.$implicit=e.item}var hb=(()=>{class t{constructor(n,i){this._viewContainer=n,this._context=new Tf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){sb("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){sb("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}static{this.\u0275fac=function(i){return new(i||t)(De(zt),De(pn))}}static{this.\u0275dir=gn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return t})(),Tf=class{constructor(){this.$implicit=null,this.ngIf=null}};function sb(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${$e(e)}'.`)}var fb=(()=>{class t{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(this._shouldRecreateView(n)){let i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(n){return!!n.ngTemplateOutlet||!!n.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(n,i,r)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,i,r):!1,get:(n,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static{this.\u0275fac=function(i){return new(i||t)(De(zt))}}static{this.\u0275dir=gn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[jn]})}}return t})();var Pf=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=Di({type:t})}static{this.\u0275inj=Ei({})}}return t})(),kf="browser",yO="server";function pb(t){return t===kf}function Ff(t){return t===yO}var gb=(()=>{class t{static{this.\u0275prov=E({token:t,providedIn:"root",factory:()=>pb(v(Tt))?new Nf(v(We),window):new Af})}}return t})(),Nf=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=wO(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}};function wO(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let i=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),r=i.currentNode;for(;r;){let s=r.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}var Af=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},vc=class{};var Bf=class extends _c{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Vf=class t extends Bf{static makeCurrent(){ab(new t)}onAndCancel(e,n,i){return e.addEventListener(n,i),()=>{e.removeEventListener(n,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=bO();return n==null?null:EO(n)}resetBaseElement(){uo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ub(document.cookie,e)}},uo=null;function bO(){return uo=uo||document.querySelector("base"),uo?uo.getAttribute("href"):null}function EO(t){return new URL(t,document.baseURI).pathname}var DO=(()=>{class t{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),jf=new A(""),wb=(()=>{class t{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>{r.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(s=>s.supports(n)),!i)throw new I(5101,!1);return this._eventNameToPlugin.set(n,i),i}static{this.\u0275fac=function(i){return new(i||t)(T(jf),T(K))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),yc=class{constructor(e){this._doc=e}},Lf="ng-app-id",bb=(()=>{class t{constructor(n,i,r,s={}){this.doc=n,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ff(s),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(r=>r.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${Lf}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(r=>{r.textContent!=null&&i.set(r.textContent,r)}),i}return null}changeUsageCount(n,i){let r=this.styleRef;if(r.has(n)){let s=r.get(n);return s.usage+=i,s.usage}return r.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===n)return r.delete(i),s.removeAttribute(Lf),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(Lf,this.appId),n.appendChild(o),o}}addStyleToHost(n,i){let r=this.getStyleElement(n,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||t)(T(We),T(tf),T(rf,8),T(Tt))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),Uf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Hf=/%COMP%/g,Eb="%COMP%",CO=`_nghost-${Eb}`,IO=`_ngcontent-${Eb}`,SO=!0,TO=new A("",{providedIn:"root",factory:()=>SO});function NO(t){return IO.replace(Hf,t)}function AO(t){return CO.replace(Hf,t)}function Db(t,e){return e.map(n=>n.replace(Hf,t))}var _b=(()=>{class t{constructor(n,i,r,s,o,a,l,c=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=Ff(a),this.defaultRenderer=new ho(n,o,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===jt.ShadowDom&&(i=ue(w({},i),{encapsulation:jt.Emulated}));let r=this.getOrCreateRenderer(n,i);return r instanceof wc?r.applyToHost(n):r instanceof fo&&r.applyStyles(),r}getOrCreateRenderer(n,i){let r=this.rendererByCompId,s=r.get(i.id);if(!s){let o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case jt.Emulated:s=new wc(l,c,i,this.appId,u,o,a,d);break;case jt.ShadowDom:return new $f(l,c,n,i,o,a,this.nonce,d);default:s=new fo(l,c,i,u,o,a,d);break}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||t)(T(wb),T(bb),T(tf),T(TO),T(We),T(Tt),T(K),T(rf))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),ho=class{constructor(e,n,i,r){this.eventManager=e,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Uf[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(vb(e)?e.content:e).appendChild(n)}insertBefore(e,n,i){e&&(vb(e)?e.content:e).insertBefore(n,i)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new I(-5104,!1);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;let s=Uf[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){let r=Uf[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(fn.DashCase|fn.Important)?e.style.setProperty(n,i,r&fn.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&fn.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e!=null&&(e[n]=i)}setValue(e,n){e.nodeValue=n}listen(e,n,i){if(typeof e=="string"&&(e=kr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(i))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function vb(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var $f=class extends ho{constructor(e,n,i,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=Db(r.id,r.styles);for(let u of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},fo=class extends ho{constructor(e,n,i,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=l?Db(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},wc=class extends fo{constructor(e,n,i,r,s,o,a,l){let c=r+"-"+i.id;super(e,n,i,s,o,a,l,c),this.contentAttr=NO(c),this.hostAttr=AO(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}},MO=(()=>{class t extends yc{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||t)(T(We))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),yb=["alt","control","meta","shift"],RO={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},OO={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},xO=(()=>{class t extends yc{constructor(n){super(n)}supports(n){return t.parseEventName(n)!=null}addEventListener(n,i,r){let s=t.parseEventName(i),o=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>kr().onAndCancel(n,s.domEventName,o))}static parseEventName(n){let i=n.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let s=t._normalizeKey(i.pop()),o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),yb.forEach(c=>{let u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,i.length!=0||s.length===0)return null;let l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(n,i){let r=RO[n.key]||n.key,s="";return i.indexOf("code.")>-1&&(r=n.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),yb.forEach(o=>{if(o!==r){let a=OO[o];a(n)&&(s+=o+".")}}),s+=r,s===i)}static eventCallback(n,i,r){return s=>{t.matchEventFullKeyCode(s,n)&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return n==="esc"?"escape":n}static{this.\u0275fac=function(i){return new(i||t)(T(We))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})();function Cb(t,e){return eb(w({rootComponent:t},PO(e)))}function PO(t){return{appProviders:[...BO,...t?.providers??[]],platformProviders:UO}}function kO(){Vf.makeCurrent()}function FO(){return new Ht}function LO(){return K0(document),document}var UO=[{provide:Tt,useValue:kf},{provide:nf,useValue:kO,multi:!0},{provide:We,useFactory:LO,deps:[]}];var BO=[{provide:Jl,useValue:"root"},{provide:Ht,useFactory:FO,deps:[]},{provide:jf,useClass:MO,multi:!0,deps:[We,K,Tt]},{provide:jf,useClass:xO,multi:!0,deps:[We]},_b,bb,wb,{provide:Ws,useExisting:_b},{provide:vc,useClass:DO,deps:[]},[]];var Ib=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static{this.\u0275fac=function(i){return new(i||t)(T(We))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var O="primary",Ao=Symbol("RouteTitle"),Yf=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function jr(t){return new Yf(t)}function jO(t,e,n){let i=n.path.split("/");if(i.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||i.length<t.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],a=t[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function $O(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Qt(t[n],e[n]))return!1;return!0}function Qt(t,e){let n=t?Kf(t):void 0,i=e?Kf(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!Pb(t[r],e[r]))return!1;return!0}function Kf(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function Pb(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),i=[...e].sort();return n.every((r,s)=>i[s]===r)}else return t===e}function kb(t){return t.length>0?t[t.length-1]:null}function Yn(t){return wd(t)?t:lo(t)?_e(Promise.resolve(t)):C(t)}var HO={exact:Lb,subset:Ub},Fb={exact:WO,subset:GO,ignored:()=>!0};function Sb(t,e,n){return HO[n.paths](t.root,e.root,n.matrixParams)&&Fb[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function WO(t,e){return Qt(t,e)}function Lb(t,e,n){if(!Si(t.segments,e.segments)||!Dc(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!t.children[i]||!Lb(t.children[i],e.children[i],n))return!1;return!0}function GO(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>Pb(t[n],e[n]))}function Ub(t,e,n){return Bb(t,e,e.segments,n)}function Bb(t,e,n,i){if(t.segments.length>n.length){let r=t.segments.slice(0,n.length);return!(!Si(r,n)||e.hasChildren()||!Dc(r,n,i))}else if(t.segments.length===n.length){if(!Si(t.segments,n)||!Dc(t.segments,n,i))return!1;for(let r in e.children)if(!t.children[r]||!Ub(t.children[r],e.children[r],i))return!1;return!0}else{let r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Si(t.segments,r)||!Dc(t.segments,r,i)||!t.children[O]?!1:Bb(t.children[O],e,s,i)}}function Dc(t,e,n){return e.every((i,r)=>Fb[n](t[r].parameters,i.parameters))}var Wn=class{constructor(e=new Z([],{}),n={},i=null){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap??=jr(this.queryParams),this._queryParamMap}toString(){return YO.serialize(this)}},Z=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Cc(this)}},Ii=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=jr(this.parameters),this._parameterMap}toString(){return jb(this)}};function zO(t,e){return Si(t,e)&&t.every((n,i)=>Qt(n.parameters,e[i].parameters))}function Si(t,e){return t.length!==e.length?!1:t.every((n,i)=>n.path===e[i].path)}function qO(t,e){let n=[];return Object.entries(t.children).forEach(([i,r])=>{i===O&&(n=n.concat(e(r,i)))}),Object.entries(t.children).forEach(([i,r])=>{i!==O&&(n=n.concat(e(r,i)))}),n}var Mo=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>new wo,providedIn:"root"})}}return t})(),wo=class{parse(e){let n=new Qf(e);return new Wn(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${po(e.root,!0)}`,i=QO(e.queryParams),r=typeof e.fragment=="string"?`#${KO(e.fragment)}`:"";return`${n}${i}${r}`}},YO=new wo;function Cc(t){return t.segments.map(e=>jb(e)).join("/")}function po(t,e){if(!t.hasChildren())return Cc(t);if(e){let n=t.children[O]?po(t.children[O],!1):"",i=[];return Object.entries(t.children).forEach(([r,s])=>{r!==O&&i.push(`${r}:${po(s,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}else{let n=qO(t,(i,r)=>r===O?[po(t.children[O],!1)]:[`${r}:${po(i,!1)}`]);return Object.keys(t.children).length===1&&t.children[O]!=null?`${Cc(t)}/${n[0]}`:`${Cc(t)}/(${n.join("//")})`}}function Vb(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function bc(t){return Vb(t).replace(/%3B/gi,";")}function KO(t){return encodeURI(t)}function Jf(t){return Vb(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ic(t){return decodeURIComponent(t)}function Tb(t){return Ic(t.replace(/\+/g,"%20"))}function jb(t){return`${Jf(t.path)}${JO(t.parameters)}`}function JO(t){return Object.entries(t).map(([e,n])=>`;${Jf(e)}=${Jf(n)}`).join("")}function QO(t){let e=Object.entries(t).map(([n,i])=>Array.isArray(i)?i.map(r=>`${bc(n)}=${bc(r)}`).join("&"):`${bc(n)}=${bc(i)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var ZO=/^[^\/()?;#]+/;function Wf(t){let e=t.match(ZO);return e?e[0]:""}var XO=/^[^\/()?;=#]+/;function ex(t){let e=t.match(XO);return e?e[0]:""}var tx=/^[^=?&#]+/;function nx(t){let e=t.match(tx);return e?e[0]:""}var ix=/^[^&#]+/;function rx(t){let e=t.match(ix);return e?e[0]:""}var Qf=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Z([],{}):new Z([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[O]=new Z(e,n)),i}parseSegment(){let e=Wf(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new I(4009,!1);return this.capture(e),new Ii(Ic(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=ex(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let r=Wf(this.remaining);r&&(i=r,this.capture(i))}e[Ic(n)]=Ic(i)}parseQueryParam(e){let n=nx(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let o=rx(this.remaining);o&&(i=o,this.capture(i))}let r=Tb(n),s=Tb(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Wf(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new I(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=O);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[O]:new Z([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new I(4011,!1)}};function $b(t){return t.segments.length>0?new Z([],{[O]:t}):t}function Hb(t){let e={};for(let[i,r]of Object.entries(t.children)){let s=Hb(r);if(i===O&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let n=new Z(t.segments,e);return sx(n)}function sx(t){if(t.numberOfChildren===1&&t.children[O]){let e=t.children[O];return new Z(t.segments.concat(e.segments),e.children)}return t}function $r(t){return t instanceof Wn}function ox(t,e,n=null,i=null){let r=Wb(t);return Gb(r,e,n,i)}function Wb(t){let e;function n(s){let o={};for(let l of s.children){let c=n(l);o[l.outlet]=c}let a=new Z(s.url,o);return s===t&&(e=a),a}let i=n(t.root),r=$b(i);return e??r}function Gb(t,e,n,i){let r=t;for(;r.parent;)r=r.parent;if(e.length===0)return Gf(r,r,r,n,i);let s=ax(e);if(s.toRoot())return Gf(r,r,new Z([],{}),n,i);let o=lx(s,r,t),a=o.processChildren?_o(o.segmentGroup,o.index,s.commands):qb(o.segmentGroup,o.index,s.commands);return Gf(r,o.segmentGroup,a,n,i)}function Sc(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function bo(t){return typeof t=="object"&&t!=null&&t.outlets}function Gf(t,e,n,i,r){let s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let o;t===e?o=n:o=zb(t,e,n);let a=$b(Hb(o));return new Wn(a,s,r)}function zb(t,e,n){let i={};return Object.entries(t.children).forEach(([r,s])=>{s===e?i[r]=n:i[r]=zb(s,e,n)}),new Z(t.segments,i)}var Tc=class{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&Sc(i[0]))throw new I(4003,!1);let r=i.find(bo);if(r&&r!==kb(i))throw new I(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function ax(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Tc(!0,0,t);let e=0,n=!1,i=t.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?n=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new Tc(n,e,i)}var Br=class{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}};function lx(t,e,n){if(t.isAbsolute)return new Br(e,!0,0);if(!n)return new Br(e,!1,NaN);if(n.parent===null)return new Br(n,!0,0);let i=Sc(t.commands[0])?0:1,r=n.segments.length-1+i;return cx(n,r,t.numberOfDoubleDots)}function cx(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new I(4005,!1);r=i.segments.length}return new Br(i,!1,r-s)}function ux(t){return bo(t[0])?t[0].outlets:{[O]:t}}function qb(t,e,n){if(t??=new Z([],{}),t.segments.length===0&&t.hasChildren())return _o(t,e,n);let i=dx(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){let s=new Z(t.segments.slice(0,i.pathIndex),{});return s.children[O]=new Z(t.segments.slice(i.pathIndex),t.children),_o(s,0,r)}else return i.match&&r.length===0?new Z(t.segments,{}):i.match&&!t.hasChildren()?Zf(t,e,n):i.match?_o(t,0,r):Zf(t,e,n)}function _o(t,e,n){if(n.length===0)return new Z(t.segments,{});{let i=ux(n),r={};if(Object.keys(i).some(s=>s!==O)&&t.children[O]&&t.numberOfChildren===1&&t.children[O].segments.length===0){let s=_o(t.children[O],e,n);return new Z(t.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=qb(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new Z(t.segments,r)}}function dx(t,e,n){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;let o=t.segments[r],a=n[i];if(bo(a))break;let l=`${a}`,c=i<n.length-1?n[i+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!Ab(l,c,o))return s;i+=2}else{if(!Ab(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function Zf(t,e,n){let i=t.segments.slice(0,e),r=0;for(;r<n.length;){let s=n[r];if(bo(s)){let l=hx(s.outlets);return new Z(i,l)}if(r===0&&Sc(n[0])){let l=t.segments[e];i.push(new Ii(l.path,Nb(n[0]))),r++;continue}let o=bo(s)?s.outlets[O]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&Sc(a)?(i.push(new Ii(o,Nb(a))),r+=2):(i.push(new Ii(o,{})),r++)}return new Z(i,{})}function hx(t){let e={};return Object.entries(t).forEach(([n,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[n]=Zf(new Z([],{}),0,i))}),e}function Nb(t){let e={};return Object.entries(t).forEach(([n,i])=>e[n]=`${i}`),e}function Ab(t,e,n){return t==n.path&&Qt(e,n.parameters)}var vo="imperative",Se=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Se||{}),pt=class{constructor(e,n){this.id=e,this.url=n}},Hr=class extends pt{constructor(e,n,i="imperative",r=null){super(e,n),this.type=Se.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Zt=class extends pt{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i,this.type=Se.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},st=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(st||{}),Nc=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Nc||{}),Gn=class extends pt{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=Se.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},zn=class extends pt{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=Se.NavigationSkipped}},Eo=class extends pt{constructor(e,n,i,r){super(e,n),this.error=i,this.target=r,this.type=Se.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ac=class extends pt{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=Se.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xf=class extends pt{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=Se.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ep=class extends pt{constructor(e,n,i,r,s){super(e,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=Se.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},tp=class extends pt{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=Se.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},np=class extends pt{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=Se.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ip=class{constructor(e){this.route=e,this.type=Se.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},rp=class{constructor(e){this.route=e,this.type=Se.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},sp=class{constructor(e){this.snapshot=e,this.type=Se.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},op=class{constructor(e){this.snapshot=e,this.type=Se.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ap=class{constructor(e){this.snapshot=e,this.type=Se.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lp=class{constructor(e){this.snapshot=e,this.type=Se.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mc=class{constructor(e,n,i){this.routerEvent=e,this.position=n,this.anchor=i,this.type=Se.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Do=class{},Co=class{constructor(e){this.url=e}};var cp=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ro,this.attachRef=null}},Ro=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){let r=this.getOrCreateContext(n);r.outlet=i,this.contexts.set(n,r)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new cp,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Rc=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=up(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){let n=up(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=dp(e,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return dp(e,this._root).map(n=>n.value)}};function up(t,e){if(t===e.value)return e;for(let n of e.children){let i=up(t,n);if(i)return i}return null}function dp(t,e){if(t===e.value)return[e];for(let n of e.children){let i=dp(t,n);if(i.length)return i.unshift(e),i}return[]}var rt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Ur(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Oc=class extends Rc{constructor(e,n){super(e),this.snapshot=n,bp(this,e)}toString(){return this.snapshot.toString()}};function Yb(t){let e=fx(t),n=new Ie([new Ii("",{})]),i=new Ie({}),r=new Ie({}),s=new Ie({}),o=new Ie(""),a=new qn(n,i,s,o,r,O,t,e.root);return a.snapshot=e.root,new Oc(new rt(a,[]),e)}function fx(t){let e={},n={},i={},r="",s=new Io([],e,i,r,n,O,t,null,{});return new xc("",new rt(s,[]))}var qn=class{constructor(e,n,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(j(c=>c[Ao]))??C(void 0),this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>jr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>jr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function wp(t,e,n="emptyOnly"){let i,{routeConfig:r}=t;return e!==null&&(n==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:w(w({},e.params),t.params),data:w(w({},e.data),t.data),resolve:w(w(w(w({},t.data),e.data),r?.data),t._resolvedData)}:i={params:w({},t.params),data:w({},t.data),resolve:w(w({},t.data),t._resolvedData??{})},r&&Jb(r)&&(i.resolve[Ao]=r.title),i}var Io=class{get title(){return this.data?.[Ao]}constructor(e,n,i,r,s,o,a,l,c){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=jr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=jr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},xc=class extends Rc{constructor(e,n){super(n),this.url=e,bp(this,n)}toString(){return Kb(this._root)}};function bp(t,e){e.value._routerState=t,e.children.forEach(n=>bp(t,n))}function Kb(t){let e=t.children.length>0?` { ${t.children.map(Kb).join(", ")} } `:"";return`${t.value}${e}`}function zf(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Qt(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Qt(e.params,n.params)||t.paramsSubject.next(n.params),$O(e.url,n.url)||t.urlSubject.next(n.url),Qt(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function hp(t,e){let n=Qt(t.params,e.params)&&zO(t.url,e.url),i=!t.parent!=!e.parent;return n&&!i&&(!t.parent||hp(t.parent,e.parent))}function Jb(t){return typeof t.title=="string"||t.title===null}var Ep=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=O,this.activateEvents=new je,this.deactivateEvents=new je,this.attachEvents=new je,this.detachEvents=new je,this.parentContexts=v(Ro),this.location=v(zt),this.changeDetector=v(Ci),this.environmentInjector=v(He),this.inputBinder=v(Lc,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:r}=n.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new I(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new I(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new I(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new I(4013,!1);this._activatedRoute=n;let r=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new fp(n,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=gn({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[jn]})}}return t})(),fp=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===qn?this.route:e===Ro?this.childContexts:this.parent.get(e,n)}},Lc=new A(""),Mb=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){let{activatedRoute:i}=n,r=pr([i.queryParams,i.params,i.data]).pipe(et(([s,o,a],l)=>(a=w(w(w({},s),o),a),l===0?C(a):Promise.resolve(a)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(n);return}let o=tb(i.component);if(!o){this.unsubscribeFromRouteData(n);return}for(let{templateName:a}of o.inputs)n.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(n,r)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})();function px(t,e,n){let i=So(t,e._root,n?n._root:void 0);return new Oc(i,e)}function So(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let i=n.value;i._futureSnapshot=e.value;let r=gx(t,e,n);return new rt(i,r)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>So(t,a)),o}}let i=mx(e.value),r=e.children.map(s=>So(t,s));return new rt(i,r)}}function gx(t,e,n){return e.children.map(i=>{for(let r of n.children)if(t.shouldReuseRoute(i.value,r.value.snapshot))return So(t,i,r);return So(t,i)})}function mx(t){return new qn(new Ie(t.url),new Ie(t.params),new Ie(t.queryParams),new Ie(t.fragment),new Ie(t.data),t.outlet,t.component,t)}var Qb="ngNavigationCancelingError";function Zb(t,e){let{redirectTo:n,navigationBehaviorOptions:i}=$r(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=Xb(!1,st.Redirect);return r.url=n,r.navigationBehaviorOptions=i,r}function Xb(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[Qb]=!0,n.cancellationCode=e,n}function _x(t){return eE(t)&&$r(t.url)}function eE(t){return!!t&&t[Qb]}var vx=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=Wt({type:t,selectors:[["ng-component"]],standalone:!0,features:[Kt],decls:1,vars:0,template:function(i,r){i&1&&Ce(0,"router-outlet")},dependencies:[Ep],encapsulation:2})}}return t})();function yx(t,e){return t.providers&&!t._injector&&(t._injector=uc(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Dp(t){let e=t.children&&t.children.map(Dp),n=e?ue(w({},t),{children:e}):w({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==O&&(n.component=vx),n}function Xt(t){return t.outlet||O}function wx(t,e){let n=t.filter(i=>Xt(i)===e);return n.push(...t.filter(i=>Xt(i)!==e)),n}function Oo(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var bx=(t,e,n,i)=>j(r=>(new pp(e,r.targetRouterState,r.currentRouterState,n,i).activate(t),r)),pp=class{constructor(e,n,i,r,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),zf(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){let r=Ur(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=Ur(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=Ur(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,n,i){let r=Ur(n);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new lp(s.value.snapshot))}),e.children.length&&this.forwardEvent(new op(e.value.snapshot))}activateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(zf(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),zf(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Oo(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}},Pc=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Vr=class{constructor(e,n){this.component=e,this.route=n}};function Ex(t,e,n){let i=t._root,r=e?e._root:null;return go(i,r,n,[i.value])}function Dx(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Gr(t,e){let n=Symbol(),i=e.get(t,n);return i===n?typeof t=="function"&&!Ly(t)?t:e.get(t):i}function go(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ur(e);return t.children.forEach(o=>{Cx(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>yo(a,n.getContext(o),r)),r}function Cx(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=Ix(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Pc(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?go(t,e,a?a.children:null,i,r):go(t,e,n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Vr(a.outlet.component,o))}else o&&yo(e,a,r),r.canActivateChecks.push(new Pc(i)),s.component?go(t,null,a?a.children:null,i,r):go(t,null,n,i,r);return r}function Ix(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Si(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Si(t.url,e.url)||!Qt(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hp(t,e)||!Qt(t.queryParams,e.queryParams);case"paramsChange":default:return!hp(t,e)}}function yo(t,e,n){let i=Ur(t),r=t.value;Object.entries(i).forEach(([s,o])=>{r.component?e?yo(o,e.children.getContext(s),n):yo(o,null,n):yo(o,e,n)}),r.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Vr(e.outlet.component,r)):n.canDeactivateChecks.push(new Vr(null,r)):n.canDeactivateChecks.push(new Vr(null,r))}function xo(t){return typeof t=="function"}function Sx(t){return typeof t=="boolean"}function Tx(t){return t&&xo(t.canLoad)}function Nx(t){return t&&xo(t.canActivate)}function Ax(t){return t&&xo(t.canActivateChild)}function Mx(t){return t&&xo(t.canDeactivate)}function Rx(t){return t&&xo(t.canMatch)}function tE(t){return t instanceof dn||t?.name==="EmptyError"}var Ec=Symbol("INITIAL_VALUE");function Wr(){return et(t=>pr(t.map(e=>e.pipe(Lt(1),vl(Ec)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===Ec)return Ec;if(n===!1||n instanceof Wn)return n}return!0}),Ye(e=>e!==Ec),Lt(1)))}function Ox(t,e){return he(n=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?C(ue(w({},n),{guardsResult:!0})):xx(o,i,r,t).pipe(he(a=>a&&Sx(a)?Px(i,s,t,e):C(a)),j(a=>ue(w({},n),{guardsResult:a})))})}function xx(t,e,n,i){return _e(t).pipe(he(r=>Bx(r.component,r.route,n,e,i)),Ut(r=>r!==!0,!0))}function Px(t,e,n,i){return _e(e).pipe(di(r=>Rn(Fx(r.route.parent,i),kx(r.route,i),Ux(t,r.path,n),Lx(t,r.route,n))),Ut(r=>r!==!0,!0))}function kx(t,e){return t!==null&&e&&e(new ap(t)),C(!0)}function Fx(t,e){return t!==null&&e&&e(new sp(t)),C(!0)}function Lx(t,e,n){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return C(!0);let r=i.map(s=>ml(()=>{let o=Oo(e)??n,a=Gr(s,o),l=Nx(a)?a.canActivate(e,t):mn(o,()=>a(e,t));return Yn(l).pipe(Ut())}));return C(r).pipe(Wr())}function Ux(t,e,n){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Dx(o)).filter(o=>o!==null).map(o=>ml(()=>{let a=o.guards.map(l=>{let c=Oo(o.node)??n,u=Gr(l,c),d=Ax(u)?u.canActivateChild(i,t):mn(c,()=>u(i,t));return Yn(d).pipe(Ut())});return C(a).pipe(Wr())}));return C(s).pipe(Wr())}function Bx(t,e,n,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return C(!0);let o=s.map(a=>{let l=Oo(e)??r,c=Gr(a,l),u=Mx(c)?c.canDeactivate(t,e,n,i):mn(l,()=>c(t,e,n,i));return Yn(u).pipe(Ut())});return C(o).pipe(Wr())}function Vx(t,e,n,i){let r=e.canLoad;if(r===void 0||r.length===0)return C(!0);let s=r.map(o=>{let a=Gr(o,t),l=Tx(a)?a.canLoad(e,n):mn(t,()=>a(e,n));return Yn(l)});return C(s).pipe(Wr(),nE(i))}function nE(t){return hd(ye(e=>{if($r(e))throw Zb(t,e)}),j(e=>e===!0))}function jx(t,e,n,i){let r=e.canMatch;if(!r||r.length===0)return C(!0);let s=r.map(o=>{let a=Gr(o,t),l=Rx(a)?a.canMatch(e,n):mn(t,()=>a(e,n));return Yn(l)});return C(s).pipe(Wr(),nE(i))}var To=class{constructor(e){this.segmentGroup=e||null}},kc=class extends Error{constructor(e){super(),this.urlTree=e}};function Lr(t){return fr(new To(t))}function $x(t){return fr(new I(4e3,!1))}function Hx(t){return fr(Xb(!1,st.GuardRejected))}var gp=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return C(i);if(r.numberOfChildren>1||!r.children[O])return $x(e.redirectTo);r=r.children[O]}}applyRedirectCommands(e,n,i){let r=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,i);if(n.startsWith("/"))throw new kc(r);return r}applyRedirectCreateUrlTree(e,n,i,r){let s=this.createSegmentGroup(e,n.root,i,r);return new Wn(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);i[r]=n[a]}else i[r]=s}),i}createSegmentGroup(e,n,i,r){let s=this.createSegments(e,n.segments,i,r),o={};return Object.entries(n.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new Z(s,o)}createSegments(e,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,n,i){let r=i[n.path.substring(1)];if(!r)throw new I(4001,!1);return r}findOrReturn(e,n){let i=0;for(let r of n){if(r.path===e.path)return n.splice(i),r;i++}return e}},mp={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Wx(t,e,n,i,r){let s=Cp(t,e,n);return s.matched?(i=yx(e,i),jx(i,e,n,r).pipe(j(o=>o===!0?s:w({},mp)))):C(s)}function Cp(t,e,n){if(e.path==="**")return Gx(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?w({},mp):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let r=(e.matcher||jO)(n,t,e);if(!r)return w({},mp);let s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let o=r.consumed.length>0?w(w({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:n.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function Gx(t){return{matched:!0,parameters:t.length>0?kb(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function Rb(t,e,n,i){return n.length>0&&Yx(t,n,i)?{segmentGroup:new Z(e,qx(i,new Z(n,t.children))),slicedSegments:[]}:n.length===0&&Kx(t,n,i)?{segmentGroup:new Z(t.segments,zx(t,n,i,t.children)),slicedSegments:n}:{segmentGroup:new Z(t.segments,t.children),slicedSegments:n}}function zx(t,e,n,i){let r={};for(let s of n)if(Uc(t,e,s)&&!i[Xt(s)]){let o=new Z([],{});r[Xt(s)]=o}return w(w({},i),r)}function qx(t,e){let n={};n[O]=e;for(let i of t)if(i.path===""&&Xt(i)!==O){let r=new Z([],{});n[Xt(i)]=r}return n}function Yx(t,e,n){return n.some(i=>Uc(t,e,i)&&Xt(i)!==O)}function Kx(t,e,n){return n.some(i=>Uc(t,e,i))}function Uc(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Jx(t,e,n,i){return Xt(t)!==i&&(i===O||!Uc(e,n,t))?!1:Cp(e,t,n).matched}function Qx(t,e,n){return e.length===0&&!t.children[n]}var _p=class{};function Zx(t,e,n,i,r,s,o="emptyOnly"){return new vp(t,e,n,i,r,o,s).recognize()}var Xx=31,vp=class{constructor(e,n,i,r,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new gp(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new I(4002,`'${e.segmentGroup}'`)}recognize(){let e=Rb(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let i=new Io([],Object.freeze({}),Object.freeze(w({},this.urlTree.queryParams)),this.urlTree.fragment,{},O,this.rootComponentType,null,{}),r=new rt(i,n),s=new xc("",r),o=ox(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,O).pipe(On(i=>{if(i instanceof kc)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof To?this.noMatchError(i):i}))}inheritParamsAndData(e,n){let i=e.value,r=wp(i,n,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,n,i,r){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,n,i):this.processSegment(e,n,i,i.segments,r,!0).pipe(j(s=>s instanceof rt?[s]:[]))}processChildren(e,n,i){let r=[];for(let s of Object.keys(i.children))s==="primary"?r.unshift(s):r.push(s);return _e(r).pipe(di(s=>{let o=i.children[s],a=wx(n,s);return this.processSegmentGroup(e,a,o,s)}),Sd((s,o)=>(s.push(...o),s)),xn(null),Id(),he(s=>{if(s===null)return Lr(i);let o=iE(s);return eP(o),C(o)}))}processSegment(e,n,i,r,s,o){return _e(n).pipe(di(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,i,r,s,o).pipe(On(l=>{if(l instanceof To)return C(null);throw l}))),Ut(a=>!!a),On(a=>{if(tE(a))return Qx(i,r,s)?C(new _p):Lr(i);throw a}))}processSegmentAgainstRoute(e,n,i,r,s,o,a){return Jx(i,r,s,o)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,o):Lr(r):Lr(r)}expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,o){let{matched:a,consumedSegments:l,positionalParamSegments:c,remainingSegments:u}=Cp(n,r,s);if(!a)return Lr(n);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Xx&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,c);return this.applyRedirects.lineralizeSegments(r,d).pipe(he(h=>this.processSegment(e,i,n,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,n,i,r,s){let o=Wx(n,i,r,e,this.urlSerializer);return i.path==="**"&&(n.children={}),o.pipe(et(a=>a.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(et(({routes:l})=>{let c=i._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new Io(u,h,Object.freeze(w({},this.urlTree.queryParams)),this.urlTree.fragment,nP(i),Xt(i),i.component??i._loadedComponent??null,i,iP(i)),{segmentGroup:p,slicedSegments:_}=Rb(n,u,d,l);if(_.length===0&&p.hasChildren())return this.processChildren(c,l,p).pipe(j(x=>x===null?null:new rt(f,x)));if(l.length===0&&_.length===0)return C(new rt(f,[]));let b=Xt(i)===s;return this.processSegment(c,l,p,_,b?O:s,!0).pipe(j(x=>new rt(f,x instanceof rt?[x]:[])))}))):Lr(n)))}getChildConfig(e,n,i){return n.children?C({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?C({routes:n._loadedRoutes,injector:n._loadedInjector}):Vx(e,n,i,this.urlSerializer).pipe(he(r=>r?this.configLoader.loadChildren(e,n).pipe(ye(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):Hx(n))):C({routes:[],injector:e})}};function eP(t){t.sort((e,n)=>e.value.outlet===O?-1:n.value.outlet===O?1:e.value.outlet.localeCompare(n.value.outlet))}function tP(t){let e=t.value.routeConfig;return e&&e.path===""}function iE(t){let e=[],n=new Set;for(let i of t){if(!tP(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),n.add(r)):e.push(i)}for(let i of n){let r=iE(i.children);e.push(new rt(i.value,r))}return e.filter(i=>!n.has(i))}function nP(t){return t.data||{}}function iP(t){return t.resolve||{}}function rP(t,e,n,i,r,s){return he(o=>Zx(t,e,n,i,o.extractedUrl,r,s).pipe(j(({state:a,tree:l})=>ue(w({},o),{targetSnapshot:a,urlAfterRedirects:l}))))}function sP(t,e){return he(n=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return C(n);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let c of rE(l))o.add(c);let a=0;return _e(o).pipe(di(l=>s.has(l)?oP(l,i,t,e):(l.data=wp(l,l.parent,t).resolve,C(void 0))),ye(()=>a++),_r(1),he(l=>a===o.size?C(n):Ve))})}function rE(t){let e=t.children.map(n=>rE(n)).flat();return[t,...e]}function oP(t,e,n,i){let r=t.routeConfig,s=t._resolve;return r?.title!==void 0&&!Jb(r)&&(s[Ao]=r.title),aP(s,t,e,i).pipe(j(o=>(t._resolvedData=o,t.data=wp(t,t.parent,n).resolve,null)))}function aP(t,e,n,i){let r=Kf(t);if(r.length===0)return C({});let s={};return _e(r).pipe(he(o=>lP(t[o],e,n,i).pipe(Ut(),ye(a=>{s[o]=a}))),_r(1),Dd(s),On(o=>tE(o)?Ve:fr(o)))}function lP(t,e,n,i){let r=Oo(e)??i,s=Gr(t,r),o=s.resolve?s.resolve(e,n):mn(r,()=>s(e,n));return Yn(o)}function qf(t){return et(e=>{let n=t(e);return n?_e(n).pipe(j(()=>e)):C(e)})}var sE=(()=>{class t{buildTitle(n){let i,r=n.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===O);return i}getResolvedTitleForRoute(n){return n.data[Ao]}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>v(cP),providedIn:"root"})}}return t})(),cP=(()=>{class t extends sE{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||t)(T(Ib))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Po=new A("",{providedIn:"root",factory:()=>({})}),No=new A(""),Ip=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=v(gc)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return C(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=Yn(n.loadComponent()).pipe(j(oE),ye(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),mr(()=>{this.componentLoaders.delete(n)})),r=new lr(i,()=>new be).pipe(ar());return this.componentLoaders.set(n,r),r}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return C({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=uP(i,this.compiler,n,this.onLoadEndListener).pipe(mr(()=>{this.childrenLoaders.delete(i)})),o=new lr(s,()=>new be).pipe(ar());return this.childrenLoaders.set(i,o),o}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function uP(t,e,n,i){return Yn(t.loadChildren()).pipe(j(oE),he(r=>r instanceof Gs||Array.isArray(r)?C(r):_e(e.compileModuleAsync(r))),j(r=>{i&&i(t);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(n).injector,o=s.get(No,[],{optional:!0,self:!0}).flat()),{routes:o.map(Dp),injector:s}}))}function dP(t){return t&&typeof t=="object"&&"default"in t}function oE(t){return dP(t)?t.default:t}var Sp=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>v(hP),providedIn:"root"})}}return t})(),hP=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),aE=new A(""),lE=new A("");function fP(t,e,n){let i=t.get(lE),r=t.get(We);return t.get(K).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s,o=new Promise(c=>{s=c}),a=r.startViewTransition(()=>(s(),pP(t))),{onViewTransitionCreated:l}=i;return l&&mn(t,()=>l({transition:a,from:e,to:n})),o})}function pP(t){return new Promise(e=>{xr(e,{injector:t})})}var Tp=(()=>{class t{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new be,this.transitionAbortSubject=new be,this.configLoader=v(Ip),this.environmentInjector=v(He),this.urlSerializer=v(Mo),this.rootContexts=v(Ro),this.location=v(Fr),this.inputBindingEnabled=v(Lc,{optional:!0})!==null,this.titleStrategy=v(sE),this.options=v(Po,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=v(Sp),this.createViewTransition=v(aE,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>C(void 0),this.rootComponentType=null;let n=r=>this.events.next(new ip(r)),i=r=>this.events.next(new rp(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(ue(w(w({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,r){return this.transitions=new Ie({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:vo,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ye(s=>s.id!==0),j(s=>ue(w({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),et(s=>{let o=!1,a=!1;return C(s).pipe(et(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",st.SupersededByNewNavigation),Ve;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?ue(w({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!c&&u!=="reload"){let d="";return this.events.next(new zn(l.id,this.urlSerializer.serialize(l.rawUrl),d,Nc.IgnoredSameUrlNavigation)),l.resolve(null),Ve}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return C(l).pipe(et(d=>{let h=this.transitions?.getValue();return this.events.next(new Hr(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions?.getValue()?Ve:Promise.resolve(d)}),rP(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),ye(d=>{s.targetSnapshot=d.targetSnapshot,s.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=ue(w({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let h=new Ac(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:d,extractedUrl:h,source:f,restoredState:p,extras:_}=l,b=new Hr(d,this.urlSerializer.serialize(h),f,p);this.events.next(b);let x=Yb(this.rootComponentType).snapshot;return this.currentTransition=s=ue(w({},l),{targetSnapshot:x,urlAfterRedirects:h,extras:ue(w({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=h,C(s)}else{let d="";return this.events.next(new zn(l.id,this.urlSerializer.serialize(l.extractedUrl),d,Nc.IgnoredByUrlHandlingStrategy)),l.resolve(null),Ve}}),ye(l=>{let c=new Xf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),j(l=>(this.currentTransition=s=ue(w({},l),{guards:Ex(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),Ox(this.environmentInjector,l=>this.events.next(l)),ye(l=>{if(s.guardsResult=l.guardsResult,$r(l.guardsResult))throw Zb(this.urlSerializer,l.guardsResult);let c=new ep(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),Ye(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",st.GuardRejected),!1)),qf(l=>{if(l.guards.canActivateChecks.length)return C(l).pipe(ye(c=>{let u=new tp(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),et(c=>{let u=!1;return C(c).pipe(sP(this.paramsInheritanceStrategy,this.environmentInjector),ye({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",st.NoDataFromResolver)}}))}),ye(c=>{let u=new np(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),qf(l=>{let c=u=>{let d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(ye(h=>{u.component=h}),j(()=>{})));for(let h of u.children)d.push(...c(h));return d};return pr(c(l.targetSnapshot.root)).pipe(xn(null),Lt(1))}),qf(()=>this.afterPreactivation()),et(()=>{let{currentSnapshot:l,targetSnapshot:c}=s,u=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return u?_e(u).pipe(j(()=>s)):C(s)}),j(l=>{let c=px(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=ue(w({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,s}),ye(()=>{this.events.next(new Do)}),bx(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Lt(1),ye({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Zt(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),hi(this.transitionAbortSubject.pipe(ye(l=>{throw l}))),mr(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",st.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),On(l=>{if(a=!0,eE(l))this.events.next(new Gn(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),_x(l)?this.events.next(new Co(l.url)):s.resolve(!1);else{this.events.next(new Eo(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(n.errorHandler(l))}catch(c){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(c)}}return Ve}))}))}cancelNavigationTransition(n,i,r){let s=new Gn(n.id,this.urlSerializer.serialize(n.extractedUrl),i,r);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function gP(t){return t!==vo}var mP=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>v(_P),providedIn:"root"})}}return t})(),yp=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},_P=(()=>{class t extends yp{static{this.\u0275fac=(()=>{let n;return function(r){return(n||(n=ec(t)))(r||t)}})()}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),cE=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:()=>v(vP),providedIn:"root"})}}return t})(),vP=(()=>{class t extends cE{constructor(){super(...arguments),this.location=v(Fr),this.urlSerializer=v(Mo),this.options=v(Po,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=v(Sp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Wn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Yb(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof Hr)this.stateMemento=this.createStateMemento();else if(n instanceof zn)this.rawUrlTree=i.initialUrl;else if(n instanceof Ac){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(r,i)}}else n instanceof Do?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof Gn&&(n.code===st.GuardRejected||n.code===st.NoDataFromResolver)?this.restoreHistory(i):n instanceof Eo?this.restoreHistory(i,!0):n instanceof Zt&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let r=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){let s=this.browserPageId,o=w(w({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(r,"",o)}else{let s=w(w({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&s===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}static{this.\u0275fac=(()=>{let n;return function(r){return(n||(n=ec(t)))(r||t)}})()}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),mo=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(mo||{});function uE(t,e){t.events.pipe(Ye(n=>n instanceof Zt||n instanceof Gn||n instanceof Eo||n instanceof zn),j(n=>n instanceof Zt||n instanceof zn?mo.COMPLETE:(n instanceof Gn?n.code===st.Redirect||n.code===st.SupersededByNewNavigation:!1)?mo.REDIRECTING:mo.FAILED),Ye(n=>n!==mo.REDIRECTING),Lt(1)).subscribe(()=>{e()})}function yP(t){throw t}var wP={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bP={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},At=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=v(hc),this.stateManager=v(cE),this.options=v(Po,{optional:!0})||{},this.pendingTasks=v(dc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=v(Tp),this.urlSerializer=v(Mo),this.location=v(Fr),this.urlHandlingStrategy=v(Sp),this._events=new be,this.errorHandler=this.options.errorHandler||yP,this.navigated=!1,this.routeReuseStrategy=v(mP),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=v(No,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!v(Lc,{optional:!0}),this.eventsSubscription=new me,this.isNgZoneEnabled=v(K)instanceof K&&K.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof Gn&&i.code!==st.Redirect&&i.code!==st.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Zt)this.navigated=!0;else if(i instanceof Co){let o=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),a={info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||gP(r.source)};this.scheduleNavigation(o,vo,null,a,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}DP(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),vo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let l=w({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let a=this.parseUrl(n);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Dp),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o,u=null;switch(a){case"merge":u=w(w({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let h=r?r.snapshot:this.routerState.snapshot.root;d=Wb(h)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),d=this.currentUrlTree.root}return Gb(d,n,u,c??null)}navigateByUrl(n,i={skipLocationChange:!1}){let r=$r(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,vo,null,i)}navigate(n,i={skipLocationChange:!1}){return EP(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let r;if(i===!0?r=w({},wP):i===!1?r=w({},bP):r=i,$r(n))return Sb(this.currentUrlTree,n,r);let s=this.parseUrl(n);return Sb(this.currentUrlTree,s,r)}removeEmptyProps(n){return Object.entries(n).reduce((i,[r,s])=>(s!=null&&(i[r]=s),i),{})}scheduleNavigation(n,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h});let u=this.pendingTasks.add();return uE(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function EP(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new I(4008,!1)}function DP(t){return!(t instanceof Do)&&!(t instanceof Co)}var dE=(()=>{class t{constructor(n,i,r,s,o,a){this.router=n,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new be,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(c=>{c instanceof Zt&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n!=null?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,r,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(n!==0||i||r||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:Z0(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let r=this.renderer,s=this.el.nativeElement;i!==null?r.setAttribute(s,n,i):r.removeAttribute(s,n)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(i){return new(i||t)(De(At),De(qn),eo("tabindex"),De(lc),De(Gt),De(Jt))}}static{this.\u0275dir=gn({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){i&1&&Nt("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),i&2&&so("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[ct.HasDecoratorInputTransform,"preserveFragment","preserveFragment",co],skipLocationChange:[ct.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",co],replaceUrl:[ct.HasDecoratorInputTransform,"replaceUrl","replaceUrl",co],routerLink:"routerLink"},standalone:!0,features:[yf,jn]})}}return t})();var Fc=class{};var CP=(()=>{class t{constructor(n,i,r,s,o){this.router=n,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ye(n=>n instanceof Zt),di(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){let r=[];for(let s of i){s.providers&&!s._injector&&(s._injector=uc(s.providers,n,`Route: ${s.path}`));let o=s._injector??n,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return _e(r).pipe(gr())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let r;i.loadChildren&&i.canLoad===void 0?r=this.loader.loadChildren(n,i):r=C(null);let s=r.pipe(he(o=>o===null?C(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??n,o.routes))));if(i.loadComponent&&!i._loadedComponent){let o=this.loader.loadComponent(i);return _e([s,o]).pipe(gr())}else return s})}static{this.\u0275fac=function(i){return new(i||t)(T(At),T(gc),T(He),T(Fc),T(Ip))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),hE=new A(""),IP=(()=>{class t{constructor(n,i,r,s,o={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=v(He),o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof Hr?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Zt?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof zn&&n.code===Nc.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof Mc&&(n.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(n.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(r=>{setTimeout(()=>{r()}),xr(()=>{r()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Mc(n,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(i){hw()}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})();function fE(t,...e){return Vn([{provide:No,multi:!0,useValue:t},[],{provide:qn,useFactory:pE,deps:[At]},{provide:pc,multi:!0,useFactory:gE},e.map(n=>n.\u0275providers)])}function pE(t){return t.routerState.root}function zr(t,e){return{\u0275kind:t,\u0275providers:e}}function gE(){let t=v(Je);return e=>{let n=t.get(Pr);if(e!==n.components[0])return;let i=t.get(At),r=t.get(mE);t.get(Np)===1&&i.initialNavigation(),t.get(_E,null,L.Optional)?.setUpPreloading(),t.get(hE,null,L.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var mE=new A("",{factory:()=>new be}),Np=new A("",{providedIn:"root",factory:()=>1});function SP(){return zr(2,[{provide:Np,useValue:0},{provide:fc,multi:!0,deps:[Je],useFactory:e=>{let n=e.get(lb,Promise.resolve());return()=>n.then(()=>new Promise(i=>{let r=e.get(At),s=e.get(mE);uE(r,()=>{i(!0)}),e.get(Tp).afterPreactivation=()=>(i(!0),s.closed?C(void 0):s),r.initialNavigation()}))}}])}function TP(){return zr(3,[{provide:fc,multi:!0,useFactory:()=>{let e=v(At);return()=>{e.setUpLocationChangeListener()}}},{provide:Np,useValue:2}])}var _E=new A("");function NP(t){return zr(0,[{provide:_E,useExisting:CP},{provide:Fc,useExisting:t}])}function vE(){return zr(6,[{provide:Jt,useClass:xf}])}function AP(){return zr(8,[Mb,{provide:Lc,useExisting:Mb}])}function MP(t){let e=[{provide:aE,useValue:fP},{provide:lE,useValue:w({skipNextTransition:!!t?.skipInitialTransition},t)}];return zr(9,e)}var Ob=new A("ROUTER_FORROOT_GUARD"),RP=[Fr,{provide:Mo,useClass:wo},At,Ro,{provide:qn,useFactory:pE,deps:[At]},Ip,[]],yE=(()=>{class t{constructor(n){}static forRoot(n,i){return{ngModule:t,providers:[RP,[],{provide:No,multi:!0,useValue:n},{provide:Ob,useFactory:kP,deps:[[At,new ht,new Fh]]},{provide:Po,useValue:i||{}},i?.useHash?xP():PP(),OP(),i?.preloadingStrategy?NP(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?FP(i):[],i?.bindToComponentInputs?AP().\u0275providers:[],i?.enableViewTransitions?MP().\u0275providers:[],LP()]}}static forChild(n){return{ngModule:t,providers:[{provide:No,multi:!0,useValue:n}]}}static{this.\u0275fac=function(i){return new(i||t)(T(Ob,8))}}static{this.\u0275mod=Di({type:t})}static{this.\u0275inj=Ei({})}}return t})();function OP(){return{provide:hE,useFactory:()=>{let t=v(gb),e=v(K),n=v(Po),i=v(Tp),r=v(Mo);return n.scrollOffset&&t.setOffset(n.scrollOffset),new IP(r,i,t,e,n)}}}function xP(){return{provide:Jt,useClass:xf}}function PP(){return{provide:Jt,useClass:Of}}function kP(t){return"guarded"}function FP(t){return[t.initialNavigation==="disabled"?TP().\u0275providers:[],t.initialNavigation==="enabledBlocking"?SP().\u0275providers:[]]}var xb=new A("");function LP(){return[{provide:xb,useFactory:gE},{provide:pc,multi:!0,useExisting:xb}]}var Ap=(()=>{class t{constructor(n){this.router=n}goToList(){this.router.navigate(["/book-list"])}static{this.\u0275fac=function(i){return new(i||t)(De(At))}}static{this.\u0275cmp=Wt({type:t,selectors:[["app-home"]],standalone:!0,features:[Kt],decls:16,vars:0,consts:[[1,"flex-container"],[1,"text-center","text-regular","text-regular"],["src","assets/30s.png","alt","30s",1,"image-30s","align-self-center"],[1,"col-subtitle","align-items-center"],[1,"text-center","m-0","text-semibold","text-medium"],[1,"col-paragraph","align-items-center"],[1,"text-center","m-0","text-light","text-small"],[1,"btn","btn-primary","align-self-center",3,"click"]],template:function(i,r){i&1&&(N(0,"div",0)(1,"h3",1),ee(2,"LISTA DE REGALOS"),M(),Ce(3,"img",2),N(4,"div",3)(5,"h6",4),ee(6,"These are some books I would like to have in my library."),M(),N(7,"h6",4),ee(8,"I like the NEW book smell as well as the USED book smell."),M(),N(9,"h6",4),ee(10,"I don't like surprises, that's why this list exists."),M()(),N(11,"div",5)(12,"p",6),ee(13,"I recommend consulting the list when you go to buy it to avoid more than one person with the same book."),M()(),N(14,"button",7),Nt("click",function(){return r.goToList()}),ee(15,"Go to list"),M()())},styles:[".image-30s[_ngcontent-%COMP%]{width:128px;height:128px}.image-hand[_ngcontent-%COMP%]{width:25px;height:45px;margin-bottom:24px}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}"]})}}return t})();var UP=["*"];function BP(t,e){if(t&1&&(N(0,"strong",3),ee(1),M()),t&2){let n=yn();le(),Yt(n.header)}}function VP(t,e){}function jP(t,e){if(t&1){let n=oo();N(0,"div",1),qt(1,VP,0,0,"ng-template",4),N(2,"button",5),Nt("click",function(){Qs(n);let r=yn();return Zs(r.hide())}),M()()}if(t&2){let n=yn(),i=zw(1);le(),Oe("ngTemplateOutlet",n.contentHeaderTpl||i)}}var EE={animation:!0,transitionTimerDelayMs:5},$P=(()=>{class t{constructor(){this.animation=EE.animation}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function HP(t){let{transitionDelay:e,transitionDuration:n}=window.getComputedStyle(t),i=parseFloat(e),r=parseFloat(n);return(i+r)*1e3}function WP(t){return(t||document.body).getBoundingClientRect()}function GP(t){return e=>new P(n=>{let i=o=>t.run(()=>n.next(o)),r=o=>t.run(()=>n.error(o)),s=()=>t.run(()=>n.complete());return e.subscribe({next:i,error:r,complete:s})})}var zP=()=>{},{transitionTimerDelayMs:qP}=EE,Bc=new Map,bE=(t,e,n,i)=>{let r=i.context||{},s=Bc.get(e);if(s)switch(i.runningTransition){case"continue":return Ve;case"stop":t.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),Bc.delete(e)}let o=n(e,i.animation,r)||zP;if(!i.animation||window.getComputedStyle(e).transitionProperty==="none")return t.run(()=>o()),C(void 0).pipe(GP(t));let a=new be,l=new be,c=a.pipe(Cd(!0));Bc.set(e,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});let u=HP(e);return t.runOutsideAngular(()=>{let d=xs(e,"transitionend").pipe(hi(c),Ye(({target:f})=>f===e)),h=bd(u+qP).pipe(hi(c));Ed(h,d,l).pipe(hi(c)).subscribe(()=>{Bc.delete(e),t.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};var aq=(()=>{let t=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2,e=()=>/Android/.test(navigator.userAgent);return typeof navigator<"u"?!!navigator.userAgent&&(t()||e()):!1})();var lq=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");var cq=new Date(1882,10,12),uq=new Date(2174,10,25);var dq=1e3*60*60*24;var Mp=1080,YP=24*Mp,KP=12*Mp+793,hq=29*YP+KP,fq=11*Mp+204;var JP=(()=>{class t{constructor(){this._ngbConfig=v($P),this.autohide=!0,this.delay=5e3,this.ariaLive="polite"}get animation(){return this._animation??this._ngbConfig.animation}set animation(n){this._animation=n}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),QP=(t,e)=>{let{classList:n}=t;if(e)n.add("fade");else{n.add("show");return}return WP(t),n.add("show","showing"),()=>{n.remove("showing")}},ZP=({classList:t})=>(t.add("showing"),()=>{t.remove("show","showing")}),XP=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=gn({type:t,selectors:[["","ngbToastHeader",""]],standalone:!0})}}return t})(),DE=(()=>{class t{constructor(n){this.ariaLive=n,this._config=v(JP),this._zone=v(K),this._injector=v(Je),this._element=v(Gt),this.animation=this._config.animation,this.delay=this._config.delay,this.autohide=this._config.autohide,this.contentHeaderTpl=null,this.shown=new je,this.hidden=new je,this.ariaLive??=this._config.ariaLive}ngAfterContentInit(){xr(()=>{this._init(),this.show()},{phase:kn.MixedReadWrite,injector:this._injector})}ngOnChanges(n){"autohide"in n&&(this._clearTimeout(),this._init())}hide(){this._clearTimeout();let n=bE(this._zone,this._element.nativeElement,ZP,{animation:this.animation,runningTransition:"stop"});return n.subscribe(()=>{this.hidden.emit()}),n}show(){let n=bE(this._zone,this._element.nativeElement,QP,{animation:this.animation,runningTransition:"continue"});return n.subscribe(()=>{this.shown.emit()}),n}_init(){this.autohide&&!this._timeoutID&&(this._timeoutID=setTimeout(()=>this.hide(),this.delay))}_clearTimeout(){this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}static{this.\u0275fac=function(i){return new(i||t)(eo("aria-live"))}}static{this.\u0275cmp=Wt({type:t,selectors:[["ngb-toast"]],contentQueries:function(i,r,s){if(i&1&&bf(s,XP,7,pn),i&2){let o;Ef(o=Df())&&(r.contentHeaderTpl=o.first)}},hostAttrs:["role","alert","aria-atomic","true",1,"toast"],hostVars:3,hostBindings:function(i,r){i&2&&(so("aria-live",r.ariaLive),wf("fade",r.animation))},inputs:{animation:"animation",delay:"delay",autohide:"autohide",header:"header"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbToast"],standalone:!0,features:[jn,Kt],ngContentSelectors:UP,decls:5,vars:1,consts:()=>{let n;return n=$localize`:@@ngb.toast.close-aria:Close`,[["headerTpl",""],[1,"toast-header"],[1,"toast-body"],[1,"me-auto"],[3,"ngTemplateOutlet"],["type","button","aria-label",n,1,"btn-close",3,"click"]]},template:function(i,r){i&1&&(Hw(),qt(0,BP,2,1,"ng-template",null,0,Yw)(2,jP,3,1,"div",1),N(3,"div",2),Ww(4),M()),i&2&&(le(2),$w(2,r.contentHeaderTpl||r.header?2:-1))},dependencies:[fb],styles:[`ngb-toast{display:block}ngb-toast .toast-header .close{margin-left:auto;margin-bottom:.25rem}
`],encapsulation:2})}}return t})(),CE=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=Di({type:t})}static{this.\u0275inj=Ei({})}}return t})();var pq=new A("live announcer delay",{providedIn:"root",factory:()=>100});var Rp={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var m=function(t,e){if(!t)throw Ai(e)},Ai=function(t){return new Error("Firebase Database ("+Rp.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var SE=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},tk=function(t){let e=[],n=0,i=0;for(;n<t.length;){let r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},jc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){let s=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(h=64)),i.push(n[u],n[d],n[h],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(SE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):tk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){let s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;let c=r<t.length?n[t.charAt(r)]:64;++r;let d=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||c==null||d==null)throw new Op;let h=s<<2|a>>4;if(i.push(h),c!==64){let f=a<<4&240|c>>2;if(i.push(f),d!==64){let p=c<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Op=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},xp=function(t){let e=SE(t);return jc.encodeByteArray(e,!0)},Pp=function(t){return xp(t).replace(/\./g,"")},IE=function(t){try{return jc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function TE(t){return NE(void 0,t)}function NE(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!nk(n)||(t[n]=NE(t[n],e[n]));return t}function nk(t){return t!=="__proto__"}var Ti=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}};function ik(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ik())}function AE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function en(){return Rp.NODE_CLIENT===!0||Rp.NODE_ADMIN===!0}function ME(){try{return typeof indexedDB=="object"}catch{return!1}}function RE(){return new Promise((t,e)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var rk="FirebaseError",Ni=class t extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=rk,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ko.prototype.create)}},ko=class{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){let i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?sk(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Ni(r,a,i)}};function sk(t,e){return t.replace(ok,(n,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var ok=/\{\$([^}]+)}/g;function qr(t){return JSON.parse(t)}function we(t){return JSON.stringify(t)}var OE=function(t){let e={},n={},i={},r="";try{let s=t.split(".");e=qr(IE(s[0])||""),n=qr(IE(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}};var xE=function(t){let e=OE(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},PE=function(t){let e=OE(t).claims;return typeof e=="object"&&e.admin===!0};function Mt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Mi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Fp(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fo(t,e,n){let i={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function kE(t){let e=[];for(let[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var Vc=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)i[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){let h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(h<<1|h>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):d<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);let h=(r<<5|r>>>27)+c+l+u+i[d]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=h}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let i=n-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function $c(t,e){return`${t} failed: ${e} argument `}var FE=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,m(i<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Lo=function(t){let e=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};var mq=4*60*60*1e3;function Uo(t){return t&&t._delegate?t._delegate:t}var Kn=class{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ak=[],oe=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(oe||{}),lk={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},ck=oe.INFO,uk={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},dk=(t,e,...n)=>{if(e<t.logLevel)return;let i=new Date().toISOString(),r=uk[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Yr=class{constructor(e){this.name=e,this._logLevel=ck,this._logHandler=dk,this._userLogHandler=null,ak.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}};var hk=(t,e)=>e.some(n=>t instanceof n),LE,UE;function fk(){return LE||(LE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pk(){return UE||(UE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var BE=new WeakMap,Up=new WeakMap,VE=new WeakMap,Lp=new WeakMap,Vp=new WeakMap;function gk(t){let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(tn(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&BE.set(n,t)}).catch(()=>{}),Vp.set(e,t),e}function mk(t){if(Up.has(t))return;let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Up.set(t,e)}var Bp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Up.get(t);if(e==="objectStoreNames")return t.objectStoreNames||VE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function jE(t){Bp=t(Bp)}function _k(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let i=t.call(Hc(this),e,...n);return VE.set(i,e.sort?e.sort():[e]),tn(i)}:pk().includes(t)?function(...e){return t.apply(Hc(this),e),tn(BE.get(this))}:function(...e){return tn(t.apply(Hc(this),e))}}function vk(t){return typeof t=="function"?_k(t):(t instanceof IDBTransaction&&mk(t),hk(t,fk())?new Proxy(t,Bp):t)}function tn(t){if(t instanceof IDBRequest)return gk(t);if(Lp.has(t))return Lp.get(t);let e=vk(t);return e!==t&&(Lp.set(t,e),Vp.set(e,t)),e}var Hc=t=>Vp.get(t);function Wc(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(t,e),a=tn(o);return i&&o.addEventListener("upgradeneeded",l=>{i(tn(o.result),l.oldVersion,l.newVersion,tn(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var yk=["get","getKey","getAll","getAllKeys","count"],wk=["put","add","delete","clear"],jp=new Map;function $E(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jp.get(e))return jp.get(e);let n=e.replace(/FromIndex$/,""),i=e!==n,r=wk.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||yk.includes(n)))return;let s=function(o,...a){return g(this,null,function*(){let l=this.transaction(o,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(yield Promise.all([c[n](...a),r&&l.done]))[0]})};return jp.set(e,s),s}jE(t=>ue(w({},t),{get:(e,n,i)=>$E(e,n)||t.get(e,n,i),has:(e,n)=>!!$E(e,n)||t.has(e,n)}));var Hp=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Ek(n)){let i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}};function Ek(t){let e=t.getComponent();return e?.type==="VERSION"}var Wp="@firebase/app",HE="0.10.15";var En=new Yr("@firebase/app"),Dk="@firebase/app-compat",Ck="@firebase/analytics-compat",Ik="@firebase/analytics",Sk="@firebase/app-check-compat",Tk="@firebase/app-check",Nk="@firebase/auth",Ak="@firebase/auth-compat",Mk="@firebase/database",Rk="@firebase/data-connect",Ok="@firebase/database-compat",xk="@firebase/functions",Pk="@firebase/functions-compat",kk="@firebase/installations",Fk="@firebase/installations-compat",Lk="@firebase/messaging",Uk="@firebase/messaging-compat",Bk="@firebase/performance",Vk="@firebase/performance-compat",jk="@firebase/remote-config",$k="@firebase/remote-config-compat",Hk="@firebase/storage",Wk="@firebase/storage-compat",Gk="@firebase/firestore",zk="@firebase/vertexai",qk="@firebase/firestore-compat",Yk="firebase",Kk="11.0.1";var Jk={[Wp]:"fire-core",[Dk]:"fire-core-compat",[Ik]:"fire-analytics",[Ck]:"fire-analytics-compat",[Tk]:"fire-app-check",[Sk]:"fire-app-check-compat",[Nk]:"fire-auth",[Ak]:"fire-auth-compat",[Mk]:"fire-rtdb",[Rk]:"fire-data-connect",[Ok]:"fire-rtdb-compat",[xk]:"fire-fn",[Pk]:"fire-fn-compat",[kk]:"fire-iid",[Fk]:"fire-iid-compat",[Lk]:"fire-fcm",[Uk]:"fire-fcm-compat",[Bk]:"fire-perf",[Vk]:"fire-perf-compat",[jk]:"fire-rc",[$k]:"fire-rc-compat",[Hk]:"fire-gcs",[Wk]:"fire-gcs-compat",[Gk]:"fire-fst",[qk]:"fire-fst-compat",[zk]:"fire-vertex","fire-js":"fire-js",[Yk]:"fire-js-all"};var Qk=new Map,Zk=new Map,WE=new Map;function GE(t,e){try{t.container.addComponent(e)}catch(n){En.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Bo(t){let e=t.name;if(WE.has(e))return En.debug(`There were multiple attempts to register component ${e}.`),!1;WE.set(e,t);for(let n of Qk.values())GE(n,t);for(let n of Zk.values())GE(n,t);return!0}var Xk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qp=new ko("app","Firebase",Xk);var KE=Kk;function Kr(t,e,n){var i;let r=(i=Jk[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),En.warn(a.join(" "));return}Bo(new Kn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var eF="firebase-heartbeat-database",tF=1,Vo="firebase-heartbeat-store",$p=null;function JE(){return $p||($p=Wc(eF,tF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vo)}catch(n){console.warn(n)}}}}).catch(t=>{throw qp.create("idb-open",{originalErrorMessage:t.message})})),$p}function nF(t){return g(this,null,function*(){try{let n=(yield JE()).transaction(Vo),i=yield n.objectStore(Vo).get(QE(t));return yield n.done,i}catch(e){if(e instanceof Ni)En.warn(e.message);else{let n=qp.create("idb-get",{originalErrorMessage:e?.message});En.warn(n.message)}}})}function zE(t,e){return g(this,null,function*(){try{let i=(yield JE()).transaction(Vo,"readwrite");yield i.objectStore(Vo).put(e,QE(t)),yield i.done}catch(n){if(n instanceof Ni)En.warn(n.message);else{let i=qp.create("idb-set",{originalErrorMessage:n?.message});En.warn(i.message)}}})}function QE(t){return`${t.name}!${t.options.appId}`}var iF=1024,rF=30*24*60*60*1e3,Gp=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new zp(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return g(this,null,function*(){var e,n;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=qE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=rF}),this._storage.overwrite(this._heartbeatsCache))}catch(i){En.warn(i)}})}getHeartbeatsHeader(){return g(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=qE(),{heartbeatsToSend:i,unsentEntries:r}=sF(this._heartbeatsCache.heartbeats),s=Pp(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return En.warn(n),""}})}};function qE(){return new Date().toISOString().substring(0,10)}function sF(t,e=iF){let n=[],i=t.slice();for(let r of t){let s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),YE(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),YE(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}var zp=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return ME()?RE().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield nF(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return zE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return zE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function YE(t){return Pp(JSON.stringify({version:2,heartbeats:t})).length}function oF(t){Bo(new Kn("platform-logger",e=>new Hp(e),"PRIVATE")),Bo(new Kn("heartbeat",e=>new Gp(e),"PRIVATE")),Kr(Wp,HE,t),Kr(Wp,HE,"esm2017"),Kr("fire-js","")}oF("");var ZE="@firebase/database",XE="1.0.9";var Zg="";function aF(t){Zg=t}var tg=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),we(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:qr(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var ng=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Mt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var RD=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new tg(e)}}catch{}return new ng},Oi=RD("localStorage"),ig=RD("sessionStorage");var Zr=new Yr("@firebase/database"),lF=function(){let t=1;return function(){return t++}}(),OD=function(t){let e=FE(t),n=new Vc;n.update(e);let i=n.digest();return jc.encodeByteArray(i)},oa=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=oa.apply(null,i):typeof i=="object"?e+=we(i):e+=i,e+=" "}return e},Pi=null,eD=!0,cF=function(t,e){m(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Zr.logLevel=oe.VERBOSE,Pi=Zr.log.bind(Zr),e&&ig.set("logging_enabled",!0)):typeof t=="function"?Pi=t:(Pi=null,ig.remove("logging_enabled"))},xe=function(...t){if(eD===!0&&(eD=!1,Pi===null&&ig.get("logging_enabled")===!0&&cF(!0)),Pi){let e=oa.apply(null,t);Pi(e)}},aa=function(t){return function(...e){xe(t,...e)}},rg=function(...t){let e="FIREBASE INTERNAL ERROR: "+oa(...t);Zr.error(e)},ki=function(...t){let e=`FIREBASE FATAL ERROR: ${oa(...t)}`;throw Zr.error(e),new Error(e)},Qe=function(...t){let e="FIREBASE WARNING: "+oa(...t);Zr.warn(e)},uF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Qe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Xg=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},dF=function(t){if(en()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},es="[MIN_NAME]",Fi="[MAX_NAME]",Ui=function(t,e){if(t===e)return 0;if(t===es||e===Fi)return-1;if(e===es||t===Fi)return 1;{let n=tD(t),i=tD(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},hF=function(t,e){return t===e?0:t<e?-1:1},jo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+we(e))},em=function(t){if(typeof t!="object"||t===null)return we(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=we(e[i]),n+=":",n+=em(t[e[i]]);return n+="}",n},xD=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function Pe(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var PD=function(t){m(!Xg(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,r,s,o,a,l;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));let c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let u=c.join(""),d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},fF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},pF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function gF(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var mF=new RegExp("^-?(0*)\\d{1,10}$"),_F=-2147483648,vF=2147483647,tD=function(t){if(mF.test(t)){let e=Number(t);if(e>=_F&&e<=vF)return e}return null},as=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Qe("Exception was thrown by user callback.",n),e},Math.floor(0))}},yF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},zo=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var sg=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Qe(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var og=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(xe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Qe(e)}},nD=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),zc="5",kD="v",FD="s",LD="r",UD="f",BD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,VD="ls",jD="p",ag="ac",$D="websocket",HD="long_polling";var lg=class{constructor(e,n,i,r,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Oi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Oi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function wF(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function WD(t,e,n){m(typeof e=="string","typeof type must == string"),m(typeof n=="object","typeof params must == object");let i;if(e===$D)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===HD)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);wF(t)&&(n.ns=t.namespace);let r=[];return Pe(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var cg=class{constructor(){this.counters_={}}incrementCounter(e,n=1){Mt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return TE(this.counters_)}};var Yp={},Kp={};function tm(t){let e=t.toString();return Yp[e]||(Yp[e]=new cg),Yp[e]}function bF(t,e){let n=t.toString();return Kp[n]||(Kp[n]=e()),Kp[n]}var ug=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&as(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var iD="start",EF="close",DF="pLPCommand",CF="pRTLPCB",GD="id",zD="pw",qD="ser",IF="cb",SF="seg",TF="ts",NF="d",AF="dframe",YD=1870,KD=30,MF=YD-KD,RF=25e3,OF=3e4,dg=class t{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=aa(e),this.stats_=tm(n),this.urlFn=l=>(this.appCheckToken&&(l[ag]=this.appCheckToken),WD(n,HD,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new ug(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(OF)),dF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hg((...s)=>{let[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===iD)this.id=a,this.password=l;else if(o===EF)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[iD]="t",i[qD]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[IF]=this.scriptTagHolder.uniqueCallbackIdentifier),i[kD]=zc,this.transportSessionId&&(i[FD]=this.transportSessionId),this.lastSessionId&&(i[VD]=this.lastSessionId),this.applicationId&&(i[jD]=this.applicationId),this.appCheckToken&&(i[ag]=this.appCheckToken),typeof location<"u"&&location.hostname&&BD.test(location.hostname)&&(i[LD]=UD);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return en()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!fF()&&!pF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=we(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=xp(n),r=xD(i,MF);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(en())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[AF]="t",i[GD]=e,i[zD]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=we(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},hg=class t{constructor(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,en())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=lF(),window[DF+this.uniqueCallbackIdentifier]=e,window[CF+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){xe("frame writing exception"),a.stack&&xe(a.stack),xe(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||xe("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[GD]=this.myID,e[zD]=this.myPW,e[qD]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+KD+i.length<=YD;){let o=this.pendingSegs.shift();i=i+"&"+SF+r+"="+o.seg+"&"+TF+r+"="+o.ts+"&"+NF+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(RF)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){en()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{xe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var xF=16384,PF=45e3,qc=null;typeof MozWebSocket<"u"?qc=MozWebSocket:typeof WebSocket<"u"&&(qc=WebSocket);var $o=(()=>{class t{constructor(n,i,r,s,o,a,l){this.connId=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=aa(this.connId),this.stats_=tm(i),this.connURL=t.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,r,s,o){let a={};return a[kD]=zc,!en()&&typeof location<"u"&&location.hostname&&BD.test(location.hostname)&&(a[LD]=UD),i&&(a[FD]=i),r&&(a[VD]=r),s&&(a[ag]=s),o&&(a[jD]=o),WD(n,$D,a)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Oi.set("previous_websocket_failure",!0);try{let r;if(en()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${zc}/${Zg}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new qc(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(n=!0)}return!n&&qc!==null&&!t.forceDisallow_}static previouslyFailed(){return Oi.isInMemoryStorage||Oi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Oi.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=qr(i);this.onMessage(r)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(m(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(n){this.resetKeepAlive();let i=we(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=xD(i,xF);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(PF))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),kF=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[dg,$o]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=$o&&$o.isAvailable(),r=i&&!$o.previouslyFailed();if(n.webSocketOnly&&(i||Qe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[$o];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),FF=6e4,LF=5e3,UF=10*1024,BF=100*1024,Jp="t",rD="d",VF="s",sD="r",jF="e",oD="o",aD="a",lD="n",cD="p",$F="h",fg=class{constructor(e,n,i,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=aa("c:"+this.id+":"),this.transportManager_=new kF(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=zo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BF?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>UF?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Jp in e){let n=e[Jp];n===aD?this.upgradeIfSecondaryHealthy_():n===sD?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===oD&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=jo("t",e),i=jo("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:cD,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:aD,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:lD,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=jo("t",e),i=jo("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=jo(Jp,e);if(rD in e){let i=e[rD];if(n===$F){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===lD){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===VF?this.onConnectionShutdown_(i):n===sD?this.onReset_(i):n===jF?rg("Server Error: "+i):n===oD?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rg("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),zc!==i&&Qe("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),zo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(FF))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):zo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(LF))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:cD,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Oi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Yc=class{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var Kc=class{constructor(e){this.allowedEvents_=e,this.listeners_={},m(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){m(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Jc=class t extends Kc{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!kp()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return m(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var uD=32,dD=768,X=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Y(){return new X("")}function $(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Zn(t){return t.pieces_.length-t.pieceNum_}function ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new X(t.pieces_,e)}function nm(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function HF(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Jo(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function JD(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new X(e,0)}function pe(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof X)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new X(n,0)}function B(t){return t.pieceNum_>=t.pieces_.length}function Ge(t,e){let n=$(t),i=$(e);if(n===null)return e;if(n===i)return Ge(ae(t),ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function WF(t,e){let n=Jo(t,0),i=Jo(e,0);for(let r=0;r<n.length&&r<i.length;r++){let s=Ui(n[r],i[r]);if(s!==0)return s}return n.length===i.length?0:n.length<i.length?-1:1}function QD(t,e){if(Zn(t)!==Zn(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function gt(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Zn(t)>Zn(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var pg=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Jo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Lo(this.parts_[i]);ZD(this)}};function GF(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Lo(e),ZD(t)}function zF(t){let e=t.parts_.pop();t.byteLength_-=Lo(e),t.parts_.length>0&&(t.byteLength_-=1)}function ZD(t){if(t.byteLength_>dD)throw new Error(t.errorPrefix_+"has a key path longer than "+dD+" bytes ("+t.byteLength_+").");if(t.parts_.length>uD)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+uD+") or object contains a cycle "+Ri(t))}function Ri(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var gg=class t extends Kc{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return m(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ho=1e3,qF=60*5*1e3,hD=30*1e3,YF=1.3,KF=3e4,JF="server_kill",fD=3,im=(()=>{class t extends Yc{constructor(n,i,r,s,o,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=aa("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ho,this.maxReconnectDelay_=qF,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!en())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");gg.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Jc.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,r){let s=++this.requestNumber_,o={r:s,a:n,b:i};this.log_(we(o)),m(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(n){this.initConnection_();let i=new Ti,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,r,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),m(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:n,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(n){let i=n.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,u=l.s;t.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===n&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),n.onComplete&&n.onComplete(u,c))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&Mt(n,"w")){let r=Mi(n,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();Qe(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||PE(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=hD)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=xE(n)?"auth":"gauth",r={cred:n};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,r=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(n,i){let r=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,n._queryObject,i)}sendUnlisten_(n,i,r,s){this.log_("Unlisten on "+n+" for "+i);let o={p:n},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:r})}onDisconnectMerge(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:r})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,i,r,s){this.putInternal("p",n,i,r,s)}merge(n,i,r,s){this.putInternal("m",n,i,r,s)}putInternal(n,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,r=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+we(n));let i=n.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):rg("Unrecognized action received from server: "+we(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){m(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ho,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Ho,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>KF&&(this.reconnectDelay_=Ho),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*YF)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,r())},u=function(h){m(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?xe("getToken() completed but was canceled"):(xe("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,l=new fg(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,r,p=>{Qe(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(JF)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Qe(h),c())}}})}interrupt(n){xe("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){xe("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Fp(this.interruptReasons_)&&(this.reconnectDelay_=Ho,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let r;i?r=i.map(o=>em(o)).join("$"):r="default";let s=this.removeListen_(n,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,i){let r=new X(n).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(n,i){xe("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=fD&&(this.reconnectDelay_=hD,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){xe("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=fD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";en()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+Zg.replace(/\./g,"-")]=1,kp()?n["framework.cordova"]=1:AE()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Jc.getInstance().currentlyOnline();return Fp(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),U=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var ts=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new U(es,e),r=new U(es,n);return this.compare(i,r)!==0}minPost(){return U.MIN}};var Gc,Qc=class extends ts{static get __EMPTY_NODE(){return Gc}static set __EMPTY_NODE(e){Gc=e}compare(e,n){return Ui(e.name,n.name)}isDefinedOn(e){throw Ai("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return U.MIN}maxPost(){return new U(Fi,Gc)}makePost(e,n){return m(typeof e=="string","KeyIndex indexValue must always be a string."),new U(e,Gc)}toString(){return".key"}},Xr=new Qc;var Qr=class{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Rt=(()=>{class t{constructor(n,i,r,s,o){this.key=n,this.value=i,this.color=r??t.RED,this.left=s??mt.EMPTY_NODE,this.right=o??mt.EMPTY_NODE}copy(n,i,r,s,o){return new t(n??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,r){let s=this,o=r(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return mt.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let r,s;if(r=this,i(n,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(n,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(n,r.key)===0){if(r.right.isEmpty())return mt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(n,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),mg=class{copy(e,n,i,r,s){return this}insert(e,n,i){return new Rt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},mt=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Rt.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Rt.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Qr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Qr(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Qr(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Qr(this.root_,null,this.comparator_,!0,e)}};mt.EMPTY_NODE=new mg;function QF(t,e){return Ui(t.name,e.name)}function rm(t,e){return Ui(t,e)}var _g;function ZF(t){_g=t}var XD=function(t){return typeof t=="number"?"number:"+PD(t):"string:"+t},eC=function(t){if(t.isLeafNode()){let e=t.val();m(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Mt(e,".sv"),"Priority must be a string or number.")}else m(t===_g||t.isEmpty(),"priority of unexpected type.");m(t===_g||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var pD,ns=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,m(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),eC(this.priorityNode_)}static set __childrenNodeConstructor(n){pD=n}static get __childrenNodeConstructor(){return pD}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return B(n)?this:$(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let r=$(n);return r===null?i:i.isEmpty()&&r!==".priority"?this:(m(r!==".priority"||Zn(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(ae(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+XD(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=PD(this.value_):n+=this.value_,this.lazyHash_=OD(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(m(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,r=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(r);return m(s>=0,"Unknown leaf type: "+i),m(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),tC,nC;function XF(t){tC=t}function eL(t){nC=t}var vg=class extends ts{compare(e,n){let i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Ui(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return U.MIN}maxPost(){return new U(Fi,new ns("[PRIORITY-POST]",nC))}makePost(e,n){let i=tC(e);return new U(n,new ns("[PRIORITY-POST]",i))}toString(){return".priority"}},ge=new vg;var tL=Math.log(2),yg=class{constructor(e){let n=s=>parseInt(Math.log(s)/tL,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Zc=function(t,e,n,i){t.sort(e);let r=function(l,c){let u=c-l,d,h;if(u===0)return null;if(u===1)return d=t[l],h=n?n(d):d,new Rt(h,d.node,Rt.BLACK,null,null);{let f=parseInt(u/2,10)+l,p=r(l,f),_=r(f+1,c);return d=t[f],h=n?n(d):d,new Rt(h,d.node,Rt.BLACK,p,_)}},s=function(l){let c=null,u=null,d=t.length,h=function(p,_){let b=d-p,x=d;d-=p;let ve=r(b+1,x),se=t[b],ke=n?n(se):se;f(new Rt(ke,se.node,_,null,ve))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){let _=l.nextBitIsOne(),b=Math.pow(2,l.count-(p+1));_?h(b,Rt.BLACK):(h(b,Rt.BLACK),h(b,Rt.RED))}return u},o=new yg(t.length),a=s(o);return new mt(i||e,a)};var Qp,Jr={},is=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return m(Jr&&ge,"ChildrenNode.ts has not been loaded"),Qp=Qp||new t({".priority":Jr},{".priority":ge}),Qp}get(e){let n=Mi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof mt?n:null}hasIndex(e){return Mt(this.indexSet_,e.toString())}addIndex(e,n){m(e!==Xr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=n.getIterator(U.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Zc(i,e.getCompare()):a=Jr;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new t(u,c)}addToIndexes(e,n){let i=Fo(this.indexes_,(r,s)=>{let o=Mi(this.indexSet_,s);if(m(o,"Missing index implementation for "+s),r===Jr)if(o.isDefinedOn(e.node)){let a=[],l=n.getIterator(U.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Zc(a,o.getCompare())}else return Jr;else{let a=n.get(e.name),l=r;return a&&(l=l.remove(new U(e.name,a))),l.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=Fo(this.indexes_,r=>{if(r===Jr)return r;{let s=n.get(e.name);return s?r.remove(new U(e.name,s)):r}});return new t(i,this.indexSet_)}};var Wo,R=(()=>{class t{constructor(n,i,r){this.children_=n,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&eC(this.priorityNode_),this.children_.isEmpty()&&m(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Wo||(Wo=new t(new mt(rm),null,is.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Wo}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?Wo:i}}getChild(n){let i=$(n);return i===null?this:this.getImmediateChild(i).getChild(ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(m(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let r=new U(n,i),s,o;i.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?Wo:this.priorityNode_;return new t(s,a,o)}}updateChild(n,i){let r=$(n);if(r===null)return i;{m($(n)!==".priority"||Zn(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(ae(n),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(ge,(a,l)=>{i[a]=l.val(n),r++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*r){let a=[];for(let l in i)a[l]=i[l];return a}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+XD(this.getPriority().val())+":"),this.forEachChild(ge,(i,r)=>{let s=r.hash();s!==""&&(n+=":"+i+":"+s)}),this.lazyHash_=n===""?"":OD(n)}return this.lazyHash_}getPredecessorChildName(n,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new U(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new U(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new U(i,this.children_.get(i)):null}forEachChild(n,i){let r=this.resolveIndex_(n);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,U.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,U.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===la?-1:0}withIndex(n){if(n===Xr||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===Xr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(ge),s=i.getIterator(ge),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Xr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),wg=class extends R{constructor(){super(new mt(rm),R.EMPTY_NODE,is.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return R.EMPTY_NODE}isEmpty(){return!1}},la=new wg;Object.defineProperties(U,{MIN:{value:new U(es,R.EMPTY_NODE)},MAX:{value:new U(Fi,la)}});Qc.__EMPTY_NODE=R.EMPTY_NODE;ns.__childrenNodeConstructor=R;ZF(la);eL(la);var nL=!0;function Te(t,e=null){if(t===null)return R.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),m(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new ns(n,Te(e))}if(!(t instanceof Array)&&nL){let n=[],i=!1;if(Pe(t,(o,a)=>{if(o.substring(0,1)!=="."){let l=Te(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new U(o,l)))}}),n.length===0)return R.EMPTY_NODE;let s=Zc(n,QF,o=>o.name,rm);if(i){let o=Zc(n,ge.getCompare());return new R(s,Te(e),new is({".priority":o},{".priority":ge}))}else return new R(s,Te(e),is.Default)}else{let n=R.EMPTY_NODE;return Pe(t,(i,r)=>{if(Mt(t,i)&&i.substring(0,1)!=="."){let s=Te(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(Te(e))}}XF(Te);var bg=class extends ts{constructor(e){super(),this.indexPath_=e,m(!B(e)&&$(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Ui(e.name,n.name):s}makePost(e,n){let i=Te(e),r=R.EMPTY_NODE.updateChild(this.indexPath_,i);return new U(n,r)}maxPost(){let e=R.EMPTY_NODE.updateChild(this.indexPath_,la);return new U(Fi,e)}toString(){return Jo(this.indexPath_,0).join("/")}};var Eg=class extends ts{compare(e,n){let i=e.node.compareTo(n.node);return i===0?Ui(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return U.MIN}maxPost(){return U.MAX}makePost(e,n){let i=Te(e);return new U(n,i)}toString(){return".value"}},iL=new Eg;function iC(t){return{type:"value",snapshotNode:t}}function rs(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Qo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Zo(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function rL(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Xo=class{constructor(e){this.index_=e}updateChild(e,n,i,r,s,o){m(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Qo(n,a)):m(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(rs(n,i)):o.trackChildChange(Zo(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(ge,(r,s)=>{n.hasChild(r)||i.trackChildChange(Qo(r,s))}),n.isLeafNode()||n.forEachChild(ge,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Zo(r,s,o))}else i.trackChildChange(rs(r,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?R.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Xc=class t{constructor(e){this.indexedFilter_=new Xo(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,r,s,o){return this.matches(new U(n,i))||(i=R.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,r,s,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=R.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(R.EMPTY_NODE);let s=this;return n.forEachChild(ge,(o,a)=>{s.matches(new U(o,a))||(r=r.updateImmediateChild(o,R.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Dg=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Xc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,r,s,o){return this.rangedFilter_.matches(new U(n,i))||(i=R.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,r,s,o):this.fullLimitUpdateChild_(e,n,i,s,o)}updateFullNode(e,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=R.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=R.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(R.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,R.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,r,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;m(a.numChildren()===this.limit_,"");let l=new U(n,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=r.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,l);if(u&&!i.isEmpty()&&f>=0)return s?.trackChildChange(Zo(n,i,d)),a.updateImmediateChild(n,i);{s?.trackChildChange(Qo(n,d));let _=a.updateImmediateChild(n,R.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(rs(h.name,h.node)),_.updateImmediateChild(h.name,h.node)):_}}else return i.isEmpty()?e:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Qo(c.name,c.node)),s.trackChildChange(rs(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(c.name,R.EMPTY_NODE)):e}};var Cg=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return m(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return m(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:es}hasEnd(){return this.endSet_}getIndexEndValue(){return m(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return m(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Fi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return m(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ge}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function sL(t){return t.loadsAllData()?new Xo(t.getIndex()):t.hasLimit()?new Dg(t):new Xc(t)}function gD(t){let e={};if(t.isDefault())return e;let n;if(t.index_===ge?n="$priority":t.index_===iL?n="$value":t.index_===Xr?n="$key":(m(t.index_ instanceof bg,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=we(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=we(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+we(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=we(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+we(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function mD(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ge&&(e.i=t.index_.toString()),e}var Ig=class t extends Yc{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=aa("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(m(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,i),a={};this.listens_[o]=a;let l=gD(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,i),Mi(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",r(h,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=gD(e._queryParams),i=e._path.toString(),r=new Ti;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+kE(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=qr(a.responseText)}catch{Qe("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&Qe("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var Sg=class{constructor(){this.rootNode_=R.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function eu(){return{value:null,children:new Map}}function rC(t,e,n){if(B(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=$(e);t.children.has(i)||t.children.set(i,eu());let r=t.children.get(i);e=ae(e),rC(r,e,n)}}function Tg(t,e,n){t.value!==null?n(e,t.value):oL(t,(i,r)=>{let s=new X(e.toString()+"/"+i);Tg(r,s,n)})}function oL(t,e){t.children.forEach((n,i)=>{e(i,n)})}var Ng=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Pe(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}};var _D=10*1e3,aL=30*1e3,lL=5*60*1e3,Ag=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Ng(e);let i=_D+(aL-_D)*Math.random();zo(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;Pe(e,(r,s)=>{s>0&&Mt(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),zo(this.reportStats_.bind(this),Math.floor(Math.random()*2*lL))}};var nn=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(nn||{});function sm(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function om(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function am(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Mg=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=nn.ACK_USER_WRITE,this.source=sm()}operationForChild(e){if(B(this.path)){if(this.affectedTree.value!=null)return m(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new X(e));return new t(Y(),n,this.revert)}}else return m($(this.path)===e,"operationForChild called for unrelated child."),new t(ae(this.path),this.affectedTree,this.revert)}};var tu=class t{constructor(e,n){this.source=e,this.path=n,this.type=nn.LISTEN_COMPLETE}operationForChild(e){return B(this.path)?new t(this.source,Y()):new t(this.source,ae(this.path))}};var ss=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=nn.OVERWRITE}operationForChild(e){return B(this.path)?new t(this.source,Y(),this.snap.getImmediateChild(e)):new t(this.source,ae(this.path),this.snap)}};var ea=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=nn.MERGE}operationForChild(e){if(B(this.path)){let n=this.children.subtree(new X(e));return n.isEmpty()?null:n.value?new ss(this.source,Y(),n.value):new t(this.source,Y(),n)}else return m($(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var rn=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(B(e))return this.isFullyInitialized()&&!this.filtered_;let n=$(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Rg=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function cL(t,e,n,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(rL(o.childName,o.snapshotNode))}),Go(t,r,"child_removed",e,i,n),Go(t,r,"child_added",e,i,n),Go(t,r,"child_moved",s,i,n),Go(t,r,"child_changed",e,i,n),Go(t,r,"value",e,i,n),r}function Go(t,e,n,i,r,s){let o=i.filter(a=>a.type===n);o.sort((a,l)=>dL(t,a,l)),o.forEach(a=>{let l=uL(t,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function uL(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function dL(t,e,n){if(e.childName==null||n.childName==null)throw Ai("Should only compare child_ events.");let i=new U(e.childName,e.snapshotNode),r=new U(n.childName,n.snapshotNode);return t.index_.compare(i,r)}function du(t,e){return{eventCache:t,serverCache:e}}function qo(t,e,n,i){return du(new rn(e,n,i),t.serverCache)}function sC(t,e,n,i){return du(t.eventCache,new rn(e,n,i))}function nu(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Li(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Zp,hL=()=>(Zp||(Zp=new mt(hF)),Zp),ze=class t{constructor(e,n=hL()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Pe(e,(i,r)=>{n=n.set(new X(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Y(),value:this.value};if(B(e))return null;{let i=$(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(ae(e),n);return s!=null?{path:pe(new X(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(B(e))return this;{let n=$(e),i=this.children.get(n);return i!==null?i.subtree(ae(e)):new t(null)}}set(e,n){if(B(e))return new t(n,this.children);{let i=$(e),s=(this.children.get(i)||new t(null)).set(ae(e),n),o=this.children.insert(i,s);return new t(this.value,o)}}remove(e){if(B(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=$(e),i=this.children.get(n);if(i){let r=i.remove(ae(e)),s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(B(e))return this.value;{let n=$(e),i=this.children.get(n);return i?i.get(ae(e)):null}}setTree(e,n){if(B(e))return n;{let i=$(e),s=(this.children.get(i)||new t(null)).setTree(ae(e),n),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new t(this.value,o)}}fold(e){return this.fold_(Y(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(pe(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,Y(),n)}findOnPath_(e,n,i){let r=this.value?i(n,this.value):!1;if(r)return r;if(B(e))return null;{let s=$(e),o=this.children.get(s);return o?o.findOnPath_(ae(e),pe(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Y(),n)}foreachOnPath_(e,n,i){if(B(e))return this;{this.value&&i(n,this.value);let r=$(e),s=this.children.get(r);return s?s.foreachOnPath_(ae(e),pe(n,r),i):new t(null)}}foreach(e){this.foreach_(Y(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(pe(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var Ot=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new ze(null))}};function Yo(t,e,n){if(B(e))return new Ot(new ze(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=Ge(r,e);return s=s.updateChild(o,n),new Ot(t.writeTree_.set(r,s))}else{let r=new ze(n),s=t.writeTree_.setTree(e,r);return new Ot(s)}}}function Og(t,e,n){let i=t;return Pe(n,(r,s)=>{i=Yo(i,pe(e,r),s)}),i}function vD(t,e){if(B(e))return Ot.empty();{let n=t.writeTree_.setTree(e,new ze(null));return new Ot(n)}}function xg(t,e){return Bi(t,e)!=null}function Bi(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ge(n.path,e)):null}function yD(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ge,(i,r)=>{e.push(new U(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new U(i,r.value))}),e}function Jn(t,e){if(B(e))return t;{let n=Bi(t,e);return n!=null?new Ot(new ze(n)):new Ot(t.writeTree_.subtree(e))}}function Pg(t){return t.writeTree_.isEmpty()}function os(t,e){return oC(Y(),t.writeTree_,e)}function oC(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(m(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=oC(pe(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(pe(t,".priority"),i)),n}}function hu(t,e){return uC(e,t)}function fL(t,e,n,i,r){m(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Yo(t.visibleWrites,e,n)),t.lastWriteId=i}function pL(t,e,n,i){m(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=Og(t.visibleWrites,e,n),t.lastWriteId=i}function gL(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function mL(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);m(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&_L(a,i.path)?r=!1:gt(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return vL(t),!0;if(i.snap)t.visibleWrites=vD(t.visibleWrites,i.path);else{let a=i.children;Pe(a,l=>{t.visibleWrites=vD(t.visibleWrites,pe(i.path,l))})}return!0}else return!1}function _L(t,e){if(t.snap)return gt(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&gt(pe(t.path,n),e))return!0;return!1}function vL(t){t.visibleWrites=aC(t.allWrites,yL,Y()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function yL(t){return t.visible}function aC(t,e,n){let i=Ot.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let o=s.path,a;if(s.snap)gt(n,o)?(a=Ge(n,o),i=Yo(i,a,s.snap)):gt(o,n)&&(a=Ge(o,n),i=Yo(i,Y(),s.snap.getChild(a)));else if(s.children){if(gt(n,o))a=Ge(n,o),i=Og(i,a,s.children);else if(gt(o,n))if(a=Ge(o,n),B(a))i=Og(i,Y(),s.children);else{let l=Mi(s.children,$(a));if(l){let c=l.getChild(ae(a));i=Yo(i,Y(),c)}}}else throw Ai("WriteRecord should have .snap or .children")}}return i}function lC(t,e,n,i,r){if(!i&&!r){let s=Bi(t.visibleWrites,e);if(s!=null)return s;{let o=Jn(t.visibleWrites,e);if(Pg(o))return n;if(n==null&&!xg(o,Y()))return null;{let a=n||R.EMPTY_NODE;return os(o,a)}}}else{let s=Jn(t.visibleWrites,e);if(!r&&Pg(s))return n;if(!r&&n==null&&!xg(s,Y()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(gt(c.path,e)||gt(e,c.path))},a=aC(t.allWrites,o,e),l=n||R.EMPTY_NODE;return os(a,l)}}}function wL(t,e,n){let i=R.EMPTY_NODE,r=Bi(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(ge,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){let s=Jn(t.visibleWrites,e);return n.forEachChild(ge,(o,a)=>{let l=os(Jn(s,new X(o)),a);i=i.updateImmediateChild(o,l)}),yD(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Jn(t.visibleWrites,e);return yD(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function bL(t,e,n,i,r){m(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=pe(e,n);if(xg(t.visibleWrites,s))return null;{let o=Jn(t.visibleWrites,s);return Pg(o)?r.getChild(n):os(o,r.getChild(n))}}function EL(t,e,n,i){let r=pe(e,n),s=Bi(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){let o=Jn(t.visibleWrites,r);return os(o,i.getNode().getImmediateChild(n))}else return null}function DL(t,e){return Bi(t.visibleWrites,e)}function CL(t,e,n,i,r,s,o){let a,l=Jn(t.visibleWrites,e),c=Bi(l,Y());if(c!=null)a=c;else if(n!=null)a=os(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),f=h.getNext();for(;f&&u.length<r;)d(f,i)!==0&&u.push(f),f=h.getNext();return u}else return[]}function IL(){return{visibleWrites:Ot.empty(),allWrites:[],lastWriteId:-1}}function iu(t,e,n,i){return lC(t.writeTree,t.treePath,e,n,i)}function lm(t,e){return wL(t.writeTree,t.treePath,e)}function wD(t,e,n,i){return bL(t.writeTree,t.treePath,e,n,i)}function ru(t,e){return DL(t.writeTree,pe(t.treePath,e))}function SL(t,e,n,i,r,s){return CL(t.writeTree,t.treePath,e,n,i,r,s)}function cm(t,e,n){return EL(t.writeTree,t.treePath,e,n)}function cC(t,e){return uC(pe(t.treePath,e),t.writeTree)}function uC(t,e){return{treePath:t,writeTree:e}}var kg=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;m(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),m(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,Zo(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Qo(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,rs(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,Zo(i,e.snapshotNode,r.oldSnap));else throw Ai("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var Fg=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},dC=new Fg,ta=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new rn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return cm(this.writes_,e,i)}}getChildAfterChild(e,n,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Li(this.viewCache_),s=SL(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}};function TL(t){return{filter:t}}function NL(t,e){m(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),m(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function AL(t,e,n,i,r){let s=new kg,o,a;if(n.type===nn.OVERWRITE){let c=n;c.source.fromUser?o=Lg(t,e,c.path,c.snap,i,r,s):(m(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!B(c.path),o=su(t,e,c.path,c.snap,i,r,a,s))}else if(n.type===nn.MERGE){let c=n;c.source.fromUser?o=RL(t,e,c.path,c.children,i,r,s):(m(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Ug(t,e,c.path,c.children,i,r,a,s))}else if(n.type===nn.ACK_USER_WRITE){let c=n;c.revert?o=PL(t,e,c.path,i,r,s):o=OL(t,e,c.path,c.affectedTree,i,r,s)}else if(n.type===nn.LISTEN_COMPLETE)o=xL(t,e,n.path,i,s);else throw Ai("Unknown operation type: "+n.type);let l=s.getChanges();return ML(e,o,l),{viewCache:o,changes:l}}function ML(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=nu(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(iC(nu(e)))}}function hC(t,e,n,i,r,s){let o=e.eventCache;if(ru(i,n)!=null)return e;{let a,l;if(B(n))if(m(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Li(e),u=c instanceof R?c:R.EMPTY_NODE,d=lm(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=iu(i,Li(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=$(n);if(c===".priority"){m(Zn(n)===1,"Can't have a priority with additional path components");let u=o.getNode();l=e.serverCache.getNode();let d=wD(i,n,u,l);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=ae(n),d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let h=wD(i,n,o.getNode(),l);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=cm(i,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,u,r,s):a=o.getNode()}}return qo(e,a,o.isFullyInitialized()||B(n),t.filter.filtersNodes())}}function su(t,e,n,i,r,s,o,a){let l=e.serverCache,c,u=o?t.filter:t.filter.getIndexedFilter();if(B(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){let f=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),f,null)}else{let f=$(n);if(!l.isCompleteForPath(n)&&Zn(n)>1)return e;let p=ae(n),b=l.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?c=u.updatePriority(l.getNode(),b):c=u.updateChild(l.getNode(),f,b,p,dC,null)}let d=sC(e,c,l.isFullyInitialized()||B(n),u.filtersNodes()),h=new ta(r,d,s);return hC(t,d,n,r,h,a)}function Lg(t,e,n,i,r,s,o){let a=e.eventCache,l,c,u=new ta(r,e,s);if(B(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=qo(e,c,!0,t.filter.filtersNodes());else{let d=$(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),l=qo(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=ae(n),f=a.getNode().getImmediateChild(d),p;if(B(h))p=i;else{let _=u.getCompleteChild(d);_!=null?nm(h)===".priority"&&_.getChild(JD(h)).isEmpty()?p=_:p=_.updateChild(h,i):p=R.EMPTY_NODE}if(f.equals(p))l=e;else{let _=t.filter.updateChild(a.getNode(),d,p,h,u,o);l=qo(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function bD(t,e){return t.eventCache.isCompleteForChild(e)}function RL(t,e,n,i,r,s,o){let a=e;return i.foreach((l,c)=>{let u=pe(n,l);bD(e,$(u))&&(a=Lg(t,a,u,c,r,s,o))}),i.foreach((l,c)=>{let u=pe(n,l);bD(e,$(u))||(a=Lg(t,a,u,c,r,s,o))}),a}function ED(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function Ug(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;B(n)?c=i:c=new ze(null).setTree(n,i);let u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=ED(t,f,h);l=su(t,l,new X(d),p,r,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),_=ED(t,p,h);l=su(t,l,new X(d),_,r,s,o,a)}}),l}function OL(t,e,n,i,r,s,o){if(ru(r,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(B(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return su(t,e,n,l.getNode().getChild(n),r,s,a,o);if(B(n)){let c=new ze(null);return l.getNode().forEachChild(Xr,(u,d)=>{c=c.set(new X(u),d)}),Ug(t,e,n,c,r,s,a,o)}else return e}else{let c=new ze(null);return i.foreach((u,d)=>{let h=pe(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),Ug(t,e,n,c,r,s,a,o)}}function xL(t,e,n,i,r){let s=e.serverCache,o=sC(e,s.getNode(),s.isFullyInitialized()||B(n),s.isFiltered());return hC(t,o,n,i,dC,r)}function PL(t,e,n,i,r,s){let o;if(ru(i,n)!=null)return e;{let a=new ta(i,e,r),l=e.eventCache.getNode(),c;if(B(n)||$(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=iu(i,Li(e));else{let d=e.serverCache.getNode();m(d instanceof R,"serverChildren would be complete if leaf node"),u=lm(i,d)}u=u,c=t.filter.updateFullNode(l,u,s)}else{let u=$(n),d=cm(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,ae(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,R.EMPTY_NODE,ae(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=iu(i,Li(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||ru(i,Y())!=null,qo(e,c,o,t.filter.filtersNodes())}}var Bg=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new Xo(i.getIndex()),s=sL(i);this.processor_=TL(s);let o=n.serverCache,a=n.eventCache,l=r.updateFullNode(R.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(R.EMPTY_NODE,a.getNode(),null),u=new rn(l,o.isFullyInitialized(),r.filtersNodes()),d=new rn(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=du(d,u),this.eventGenerator_=new Rg(this.query_)}get query(){return this.query_}};function kL(t){return t.viewCache_.serverCache.getNode()}function FL(t){return nu(t.viewCache_)}function LL(t,e){let n=Li(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!B(e)&&!n.getImmediateChild($(e)).isEmpty())?n.getChild(e):null}function DD(t){return t.eventRegistrations_.length===0}function UL(t,e){t.eventRegistrations_.push(e)}function CD(t,e,n){let i=[];if(n){m(e==null,"A cancel should cancel all event registrations.");let r=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return i}function ID(t,e,n,i){e.type===nn.MERGE&&e.source.queryId!==null&&(m(Li(t.viewCache_),"We should always have a full cache before handling merges"),m(nu(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=AL(t.processor_,r,e,n,i);return NL(t.processor_,s.viewCache),m(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,fC(t,s.changes,s.viewCache.eventCache.getNode(),null)}function BL(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ge,(s,o)=>{i.push(rs(s,o))}),n.isFullyInitialized()&&i.push(iC(n.getNode())),fC(t,i,n.getNode(),e)}function fC(t,e,n,i){let r=i?[i]:t.eventRegistrations_;return cL(t.eventGenerator_,e,n,r)}var ou,au=class{constructor(){this.views=new Map}};function VL(t){m(!ou,"__referenceConstructor has already been defined"),ou=t}function jL(){return m(ou,"Reference.ts has not been loaded"),ou}function $L(t){return t.views.size===0}function um(t,e,n,i){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return m(s!=null,"SyncTree gave us an op for an invalid query."),ID(s,e,n,i)}else{let s=[];for(let o of t.views.values())s=s.concat(ID(o,e,n,i));return s}}function pC(t,e,n,i,r){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=iu(n,r?i:null),l=!1;a?l=!0:i instanceof R?(a=lm(n,i),l=!1):(a=R.EMPTY_NODE,l=!1);let c=du(new rn(a,l,!1),new rn(i,r,!1));return new Bg(e,c)}return o}function HL(t,e,n,i,r,s){let o=pC(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),UL(o,n),BL(o,n)}function WL(t,e,n,i){let r=e._queryIdentifier,s=[],o=[],a=Xn(t);if(r==="default")for(let[l,c]of t.views.entries())o=o.concat(CD(c,n,i)),DD(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=t.views.get(r);l&&(o=o.concat(CD(l,n,i)),DD(l)&&(t.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Xn(t)&&s.push(new(jL())(e._repo,e._path)),{removed:s,events:o}}function gC(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Qn(t,e){let n=null;for(let i of t.views.values())n=n||LL(i,e);return n}function mC(t,e){if(e._queryParams.loadsAllData())return fu(t);{let i=e._queryIdentifier;return t.views.get(i)}}function _C(t,e){return mC(t,e)!=null}function Xn(t){return fu(t)!=null}function fu(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var lu;function GL(t){m(!lu,"__referenceConstructor has already been defined"),lu=t}function zL(){return m(lu,"Reference.ts has not been loaded"),lu}var qL=1,cu=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ze(null),this.pendingWriteTree_=IL(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function YL(t,e,n,i,r){return fL(t.pendingWriteTree_,e,n,i,r),r?ls(t,new ss(sm(),e,n)):[]}function KL(t,e,n,i){pL(t.pendingWriteTree_,e,n,i);let r=ze.fromObject(n);return ls(t,new ea(sm(),e,r))}function xi(t,e,n=!1){let i=gL(t.pendingWriteTree_,e);if(mL(t.pendingWriteTree_,e)){let s=new ze(null);return i.snap!=null?s=s.set(Y(),!0):Pe(i.children,o=>{s=s.set(new X(o),!0)}),ls(t,new Mg(i.path,s,n))}else return[]}function ca(t,e,n){return ls(t,new ss(om(),e,n))}function JL(t,e,n){let i=ze.fromObject(n);return ls(t,new ea(om(),e,i))}function QL(t,e){return ls(t,new tu(om(),e))}function ZL(t,e,n){let i=dm(t,n);if(i){let r=hm(i),s=r.path,o=r.queryId,a=Ge(s,e),l=new tu(am(o),a);return fm(t,s,l)}else return[]}function vC(t,e,n,i,r=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||_C(o,e))){let l=WL(o,e,n,i);$L(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!r){let u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Xn(f));if(u&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=n2(h);for(let p=0;p<f.length;++p){let _=f[p],b=_.query,x=DC(t,_);t.listenProvider_.startListening(Ko(b),na(t,b),x.hashFn,x.onComplete)}}}!d&&c.length>0&&!i&&(u?t.listenProvider_.stopListening(Ko(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(pu(h));t.listenProvider_.stopListening(Ko(h),f)}))}i2(t,c)}return a}function yC(t,e,n,i){let r=dm(t,i);if(r!=null){let s=hm(r),o=s.path,a=s.queryId,l=Ge(o,e),c=new ss(am(a),l,n);return fm(t,o,c)}else return[]}function XL(t,e,n,i){let r=dm(t,i);if(r){let s=hm(r),o=s.path,a=s.queryId,l=Ge(o,e),c=ze.fromObject(n),u=new ea(am(a),l,c);return fm(t,o,u)}else return[]}function e2(t,e,n,i=!1){let r=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(r,(h,f)=>{let p=Ge(h,r);s=s||Qn(f,p),o=o||Xn(f)});let a=t.syncPointTree_.get(r);a?(o=o||Xn(a),s=s||Qn(a,Y())):(a=new au,t.syncPointTree_=t.syncPointTree_.set(r,a));let l;s!=null?l=!0:(l=!1,s=R.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((f,p)=>{let _=Qn(p,Y());_&&(s=s.updateImmediateChild(f,_))}));let c=_C(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=pu(e);m(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=r2();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let u=hu(t.pendingWriteTree_,r),d=HL(a,e,n,u,s,l);if(!c&&!o&&!i){let h=mC(a,e);d=d.concat(s2(t,e,h))}return d}function wC(t,e,n){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let l=Ge(o,e),c=Qn(a,l);if(c)return c});return lC(r,e,s,n,!0)}function t2(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{let d=Ge(c,n);i=i||Qn(u,d)});let r=t.syncPointTree_.get(n);r?i=i||Qn(r,Y()):(r=new au,t.syncPointTree_=t.syncPointTree_.set(n,r));let s=i!=null,o=s?new rn(i,!0,!1):null,a=hu(t.pendingWriteTree_,e._path),l=pC(r,e,a,s?o.getNode():R.EMPTY_NODE,s);return FL(l)}function ls(t,e){return bC(e,t.syncPointTree_,null,hu(t.pendingWriteTree_,Y()))}function bC(t,e,n,i){if(B(t.path))return EC(t,e,n,i);{let r=e.get(Y());n==null&&r!=null&&(n=Qn(r,Y()));let s=[],o=$(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){let c=n?n.getImmediateChild(o):null,u=cC(i,o);s=s.concat(bC(a,l,c,u))}return r&&(s=s.concat(um(r,t,i,n))),s}}function EC(t,e,n,i){let r=e.get(Y());n==null&&r!=null&&(n=Qn(r,Y()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=n?n.getImmediateChild(o):null,c=cC(i,o),u=t.operationForChild(o);u&&(s=s.concat(EC(u,a,l,c)))}),r&&(s=s.concat(um(r,t,i,n))),s}function DC(t,e){let n=e.query,i=na(t,n);return{hashFn:()=>(kL(e)||R.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?ZL(t,n._path,i):QL(t,n._path);{let s=gF(r,n);return vC(t,n,null,s)}}}}function na(t,e){let n=pu(e);return t.queryToTagMap.get(n)}function pu(t){return t._path.toString()+"$"+t._queryIdentifier}function dm(t,e){return t.tagToQueryMap.get(e)}function hm(t){let e=t.indexOf("$");return m(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new X(t.substr(0,e))}}function fm(t,e,n){let i=t.syncPointTree_.get(e);m(i,"Missing sync point for query tag that we're tracking");let r=hu(t.pendingWriteTree_,e);return um(i,n,r,null)}function n2(t){return t.fold((e,n,i)=>{if(n&&Xn(n))return[fu(n)];{let r=[];return n&&(r=gC(n)),Pe(i,(s,o)=>{r=r.concat(o)}),r}})}function Ko(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(zL())(t._repo,t._path):t}function i2(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let r=pu(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}function r2(){return qL++}function s2(t,e,n){let i=e._path,r=na(t,e),s=DC(t,n),o=t.listenProvider_.startListening(Ko(e),r,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(i);if(r)m(!Xn(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,u,d)=>{if(!B(c)&&u&&Xn(u))return[fu(u).query];{let h=[];return u&&(h=h.concat(gC(u).map(f=>f.query))),Pe(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<l.length;++c){let u=l[c];t.listenProvider_.stopListening(Ko(u),na(t,u))}}return o}var Vg=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},jg=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=pe(this.path_,e);return new t(this.syncTree_,n)}node(){return wC(this.syncTree_,this.path_)}},o2=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},SD=function(t,e,n){if(!t||typeof t!="object")return t;if(m(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return a2(t[".sv"],e,n);if(typeof t[".sv"]=="object")return l2(t[".sv"],e);m(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},a2=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:m(!1,"Unexpected server value: "+t)}},l2=function(t,e,n){t.hasOwnProperty("increment")||m(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&m(!1,"Unexpected increment value: "+i);let r=e.node();if(m(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},CC=function(t,e,n,i){return pm(e,new jg(n,t),i)},c2=function(t,e,n){return pm(t,new Vg(e),n)};function pm(t,e,n){let i=t.getPriority().val(),r=SD(i,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=SD(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new ns(a,Te(r)):t}else{let o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new ns(r))),o.forEachChild(ge,(a,l)=>{let c=pm(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var ia=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function gm(t,e){let n=e instanceof X?e:new X(e),i=t,r=$(n);for(;r!==null;){let s=Mi(i.node.children,r)||{children:{},childCount:0};i=new ia(r,i,s),n=ae(n),r=$(n)}return i}function cs(t){return t.node.value}function IC(t,e){t.node.value=e,$g(t)}function SC(t){return t.node.childCount>0}function u2(t){return cs(t)===void 0&&!SC(t)}function gu(t,e){Pe(t.node.children,(n,i)=>{e(new ia(n,t,i))})}function TC(t,e,n,i){n&&!i&&e(t),gu(t,r=>{TC(r,e,!0,i)}),n&&i&&e(t)}function d2(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function ua(t){return new X(t.parent===null?t.name:ua(t.parent)+"/"+t.name)}function $g(t){t.parent!==null&&h2(t.parent,t.name,t)}function h2(t,e,n){let i=u2(n),r=Mt(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,$g(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,$g(t))}var f2=/[\[\].#$\/\u0000-\u001F\u007F]/,p2=/[\[\].#$\u0000-\u001F\u007F]/,Xp=10*1024*1024,mm=function(t){return typeof t=="string"&&t.length!==0&&!f2.test(t)},NC=function(t){return typeof t=="string"&&t.length!==0&&!p2.test(t)},g2=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),NC(t)},m2=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Xg(t)||t&&typeof t=="object"&&Mt(t,".sv")};var _m=function(t,e,n){let i=n instanceof X?new pg(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ri(i));if(typeof e=="function")throw new Error(t+"contains a function "+Ri(i)+" with contents = "+e.toString());if(Xg(e))throw new Error(t+"contains "+e.toString()+" "+Ri(i));if(typeof e=="string"&&e.length>Xp/3&&Lo(e)>Xp)throw new Error(t+"contains a string greater than "+Xp+" utf8 bytes "+Ri(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Pe(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!mm(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ri(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);GF(i,o),_m(t,a,i),zF(i)}),r&&s)throw new Error(t+' contains ".value" child '+Ri(i)+" in addition to actual children.")}},_2=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];let s=Jo(i);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!mm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(WF);let r=null;for(n=0;n<e.length;n++){if(i=e[n],r!==null&&gt(r,i))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}},v2=function(t,e,n,i){if(i&&e===void 0)return;let r=$c(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");let s=[];Pe(e,(o,a)=>{let l=new X(o);if(_m(r,a,pe(n,l)),nm(l)===".priority"&&!m2(a))throw new Error(r+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),_2(r,s)};var AC=function(t,e,n,i){if(!(i&&n===void 0)&&!NC(n))throw new Error($c(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},y2=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),AC(t,e,n,i)};var w2=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!mm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!g2(n))throw new Error($c(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Hg=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function MC(t,e){let n=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();n!==null&&!QD(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function sn(t,e,n){MC(t,n),b2(t,i=>gt(i,e)||gt(e,i))}function b2(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let r=t.eventLists_[i];if(r){let s=r.path;e(s)?(E2(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function E2(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();Pi&&xe("event: "+n.toString()),as(i)}}}var D2="repo_interrupt",C2=25,Wg=class{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Hg,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=eu(),this.transactionQueueTree_=new ia,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function I2(t,e,n){if(t.stats_=tm(t.repoInfo_),t.forceRestClient_||yF())t.server_=new Ig(t.repoInfo_,(i,r,s,o)=>{TD(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>ND(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{we(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new im(t.repoInfo_,e,(i,r,s,o)=>{TD(t,i,r,s,o)},i=>{ND(t,i)},i=>{T2(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=bF(t.repoInfo_,()=>new Ag(t.stats_,t.server_)),t.infoData_=new Sg,t.infoSyncTree_=new cu({startListening:(i,r,s,o)=>{let a=[],l=t.infoData_.getNode(i._path);return l.isEmpty()||(a=ca(t.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),ym(t,"connected",!1),t.serverSyncTree_=new cu({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);sn(t.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function S2(t){let n=t.infoData_.getNode(new X(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function vm(t){return o2({timestamp:S2(t)})}function TD(t,e,n,i,r){t.dataUpdateCount++;let s=new X(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){let l=Fo(n,c=>Te(c));o=XL(t.serverSyncTree_,s,l,r)}else{let l=Te(n);o=yC(t.serverSyncTree_,s,l,r)}else if(i){let l=Fo(n,c=>Te(c));o=JL(t.serverSyncTree_,s,l)}else{let l=Te(n);o=ca(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=ra(t,s)),sn(t.eventQueue_,a,o)}function ND(t,e){ym(t,"connected",e),e===!1&&M2(t)}function T2(t,e){Pe(e,(n,i)=>{ym(t,n,i)})}function ym(t,e,n){let i=new X("/.info/"+e),r=Te(n);t.infoData_.updateSnapshot(i,r);let s=ca(t.infoSyncTree_,i,r);sn(t.eventQueue_,i,s)}function RC(t){return t.nextWriteId_++}function N2(t,e,n){let i=t2(t.serverSyncTree_,e);return i!=null?Promise.resolve(i):t.server_.get(e).then(r=>{let s=Te(r).withIndex(e._queryParams.getIndex());e2(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=ca(t.serverSyncTree_,e._path,s);else{let a=na(t.serverSyncTree_,e);o=yC(t.serverSyncTree_,e._path,s,a)}return sn(t.eventQueue_,e._path,o),vC(t.serverSyncTree_,e,n,null,!0),s},r=>(mu(t,"get for query "+we(e)+" failed: "+r),Promise.reject(new Error(r))))}function A2(t,e,n,i){mu(t,"update",{path:e.toString(),value:n});let r=!0,s=vm(t),o={};if(Pe(n,(a,l)=>{r=!1,o[a]=CC(pe(e,a),Te(l),t.serverSyncTree_,s)}),r)xe("update() called with empty data.  Don't do anything."),AD(t,i,"ok",void 0);else{let a=RC(t),l=KL(t.serverSyncTree_,e,o,a);MC(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{let d=c==="ok";d||Qe("update at "+e+" failed: "+c);let h=xi(t.serverSyncTree_,a,!d),f=h.length>0?ra(t,e):e;sn(t.eventQueue_,f,h),AD(t,i,c,u)}),Pe(n,c=>{let u=FC(t,pe(e,c));ra(t,u)}),sn(t.eventQueue_,e,[])}}function M2(t){mu(t,"onDisconnectEvents");let e=vm(t),n=eu();Tg(t.onDisconnect_,Y(),(r,s)=>{let o=CC(r,s,t.serverSyncTree_,e);rC(n,r,o)});let i=[];Tg(n,Y(),(r,s)=>{i=i.concat(ca(t.serverSyncTree_,r,s));let o=FC(t,r);ra(t,o)}),t.onDisconnect_=eu(),sn(t.eventQueue_,Y(),i)}function R2(t){t.persistentConnection_&&t.persistentConnection_.interrupt(D2)}function mu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),xe(n,...e)}function AD(t,e,n,i){e&&as(()=>{if(n==="ok")e(null);else{let r=(n||"error").toUpperCase(),s=r;i&&(s+=": "+i);let o=new Error(s);o.code=r,e(o)}})}function OC(t,e,n){return wC(t.serverSyncTree_,e,n)||R.EMPTY_NODE}function wm(t,e=t.transactionQueueTree_){if(e||_u(t,e),cs(e)){let n=PC(t,e);m(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&O2(t,ua(e),n)}else SC(e)&&gu(e,n=>{wm(t,n)})}function O2(t,e,n){let i=n.map(c=>c.currentWriteId),r=OC(t,e,i),s=r,o=r.hash();for(let c=0;c<n.length;c++){let u=n[c];m(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=Ge(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{mu(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(xi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();_u(t,gm(t.transactionQueueTree_,e)),wm(t,t.transactionQueueTree_),sn(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)as(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Qe("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}ra(t,e)}},o)}function ra(t,e){let n=xC(t,e),i=ua(n),r=PC(t,n);return x2(t,r,i),i}function x2(t,e,n){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=Ge(n,l.path),u=!1,d;if(m(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,r=r.concat(xi(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=C2)u=!0,d="maxretry",r=r.concat(xi(t.serverSyncTree_,l.currentWriteId,!0));else{let h=OC(t,l.path,o);l.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){_m("transaction failed: Data returned ",f,l.path);let p=Te(f);typeof f=="object"&&f!=null&&Mt(f,".priority")||(p=p.updatePriority(h.getPriority()));let b=l.currentWriteId,x=vm(t),ve=c2(p,h,x);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=ve,l.currentWriteId=RC(t),o.splice(o.indexOf(b),1),r=r.concat(YL(t.serverSyncTree_,l.path,ve,l.currentWriteId,l.applyLocally)),r=r.concat(xi(t.serverSyncTree_,b,!0))}else u=!0,d="nodata",r=r.concat(xi(t.serverSyncTree_,l.currentWriteId,!0))}sn(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}_u(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)as(i[a]);wm(t,t.transactionQueueTree_)}function xC(t,e){let n,i=t.transactionQueueTree_;for(n=$(e);n!==null&&cs(i)===void 0;)i=gm(i,n),e=ae(e),n=$(e);return i}function PC(t,e){let n=[];return kC(t,e,n),n.sort((i,r)=>i.order-r.order),n}function kC(t,e,n){let i=cs(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);gu(e,r=>{kC(t,r,n)})}function _u(t,e){let n=cs(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,IC(e,n.length>0?n:void 0)}gu(e,i=>{_u(t,i)})}function FC(t,e){let n=ua(xC(t,e)),i=gm(t.transactionQueueTree_,e);return d2(i,r=>{eg(t,r)}),eg(t,i),TC(i,r=>{eg(t,r)}),n}function eg(t,e){let n=cs(e);if(n){let i=[],r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(m(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(m(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(xi(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?IC(e,void 0):n.length=s+1,sn(t.eventQueue_,ua(e),r);for(let o=0;o<i.length;o++)as(i[o])}}function P2(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function k2(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Qe(`Invalid query segment '${n}' in query '${t}'`)}return e}var MD=function(t,e){let n=F2(t),i=n.namespace;n.domain==="firebase.com"&&ki(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&ki("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||uF();let r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new lg(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new X(n.pathString)}},F2=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(r=P2(t.substring(u,d)));let h=k2(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=i}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var Gg=class{constructor(e,n,i,r){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+we(this.snapshot.exportVal())}},zg=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var qg=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return m(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Yg=class t{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return B(this._path)?null:nm(this._path)}get ref(){return new Dn(this._repo,this._path)}get _queryIdentifier(){let e=mD(this._queryParams),n=em(e);return n==="{}"?"default":n}get _queryObject(){return mD(this._queryParams)}isEqual(e){if(e=Uo(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=QD(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+HF(this._path)}};var Dn=class t extends Yg{constructor(e,n){super(e,n,new Cg,!1)}get parent(){let e=JD(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},uu=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new X(e),i=sa(this.ref,e);return new t(this._node.getChild(n),i,ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new t(r,sa(this.ref,i),ge)))}hasChild(e){let n=new X(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function bm(t,e){return t=Uo(t),t._checkNotDeleted("ref"),e!==void 0?sa(t._root,e):t._root}function sa(t,e){return t=Uo(t),$(t._path)===null?y2("child","path",e,!1):AC("child","path",e,!1),new Dn(t._repo,pe(t._path,e))}function LC(t,e){v2("update",e,t._path,!1);let n=new Ti;return A2(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function UC(t){t=Uo(t);let e=new qg(()=>{}),n=new Kg(e);return N2(t._repo,t,n).then(i=>new uu(i,new Dn(t._repo,t._path),t._queryParams.getIndex()))}var Kg=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new Gg("value",this,new uu(e.snapshotNode,new Dn(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new zg(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}};VL(Dn);GL(Dn);var L2="FIREBASE_DATABASE_EMULATOR_HOST",Jg={},U2=!1;function B2(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||ki("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),xe("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=MD(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[L2]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=MD(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let u=r&&l?new nD(nD.OWNER):new og(t.name,t.options,e);w2("Invalid Firebase Database URL",o),B(o.path)||ki("Database URL must point to the root of a Firebase Database (not including a child path).");let d=j2(a,t,u,new sg(t.name,n));return new Qg(d,t)}function V2(t,e){let n=Jg[e];(!n||n[t.key]!==t)&&ki(`Database ${e}(${t.repoInfo_}) has already been deleted.`),R2(t),delete n[t.key]}function j2(t,e,n,i){let r=Jg[e.name];r||(r={},Jg[e.name]=r);let s=r[t.toURLString()];return s&&ki("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Wg(t,U2,n,i),r[t.toURLString()]=s,s}var Qg=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(I2(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Dn(this._repo,Y())),this._rootInternal}_delete(){return this._rootInternal!==null&&(V2(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ki("Cannot call "+e+" on a deleted database.")}};function $2(t){aF(KE),Bo(new Kn("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return B2(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),Kr(ZE,XE,t),Kr(ZE,XE,"esm2017")}im.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};im.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};$2();var Dm={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var y=function(t,e){if(!t)throw ji(e)},ji=function(t){return new Error("Firebase Database ("+Dm.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var VC=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},H2=function(t){let e=[],n=0,i=0;for(;n<t.length;){let r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},yu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){let s=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(h=64)),i.push(n[u],n[d],n[h],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(VC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):H2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){let s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;let c=r<t.length?n[t.charAt(r)]:64;++r;let d=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||c==null||d==null)throw new Cm;let h=s<<2|a>>4;if(i.push(h),c!==64){let f=a<<4&240|c>>2;if(i.push(f),d!==64){let p=c<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Cm=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Sm=function(t){let e=VC(t);return yu.encodeByteArray(e,!0)},da=function(t){return Sm(t).replace(/\./g,"")},ha=function(t){try{return yu.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function jC(t){return $C(void 0,t)}function $C(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!W2(n)||(t[n]=$C(t[n],e[n]));return t}function W2(t){return t!=="__proto__"}function G2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var z2=()=>G2().__FIREBASE_DEFAULTS__,q2=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Y2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&ha(t[1]);return e&&JSON.parse(e)},Tm=()=>{try{return z2()||q2()||Y2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},HC=t=>{var e,n;return(n=(e=Tm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},WC=t=>{let e=HC(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},Nm=()=>{var t;return(t=Tm())===null||t===void 0?void 0:t.config},GC=t=>{var e;return(e=Tm())===null||e===void 0?void 0:e[`_${t}`]};var Vi=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}};function zC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[da(JSON.stringify(n)),da(JSON.stringify(o)),""].join(".")}function xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fa(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function qC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function YC(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function wu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function an(){return Dm.NODE_CLIENT===!0||Dm.NODE_ADMIN===!0}function KC(){try{return typeof indexedDB=="object"}catch{return!1}}function JC(){return new Promise((t,e)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var K2="FirebaseError",on=class t extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=K2,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cn.prototype.create)}},Cn=class{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){let i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?J2(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new on(r,a,i)}};function J2(t,e){return t.replace(Q2,(n,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var Q2=/\{\$([^}]+)}/g;function us(t){return JSON.parse(t)}function Ne(t){return JSON.stringify(t)}var QC=function(t){let e={},n={},i={},r="";try{let s=t.split(".");e=us(ha(s[0])||""),n=us(ha(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}};var ZC=function(t){let e=QC(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},XC=function(t){let e=QC(t).claims;return typeof e=="object"&&e.admin===!0};function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $i(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function bu(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pa(t,e,n){let i={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function ga(t,e){if(t===e)return!0;let n=Object.keys(t),i=Object.keys(e);for(let r of n){if(!i.includes(r))return!1;let s=t[r],o=e[r];if(BC(s)&&BC(o)){if(!ga(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!n.includes(r))return!1;return!0}function BC(t){return t!==null&&typeof t=="object"}function ma(t){let e=[];for(let[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var vu=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)i[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){let h=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(h<<1|h>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):d<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);let h=(r<<5|r>>>27)+c+l+u+i[d]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=h}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let i=n-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function eI(t,e){let n=new Im(t,e);return n.subscribe.bind(n)}var Im=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let r;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");Z2(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:i},r.next===void 0&&(r.next=Em),r.error===void 0&&(r.error=Em),r.complete===void 0&&(r.complete=Em);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Z2(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Em(){}function tI(t,e){return`${t} failed: ${e} argument `}var nI=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,y(i<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},_a=function(t){let e=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};var Xq=4*60*60*1e3;function ei(t){return t&&t._delegate?t._delegate:t}var _t=class{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Hi="[DEFAULT]";var Eu=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let i=new Vi;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eU(e))try{this.getOrInitializeService({instanceIdentifier:Hi})}catch{}for(let[n,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Hi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Hi){return this.instances.has(e)}getOptions(e=Hi){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;let r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let i=this.onInitCallbacks.get(n);if(i)for(let r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:X2(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Hi){return this.component?this.component.multipleInstances?e:Hi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function X2(t){return t===Hi?void 0:t}function eU(t){return t.instantiationMode==="EAGER"}var va=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new Eu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var tU=[],te=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(te||{}),nU={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},iU=te.INFO,rU={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},sU=(t,e,...n)=>{if(e<t.logLevel)return;let i=new Date().toISOString(),r=rU[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ti=class{constructor(e){this.name=e,this._logLevel=iU,this._logHandler=sU,this._userLogHandler=null,tU.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...e),this._logHandler(this,te.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...e),this._logHandler(this,te.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,te.INFO,...e),this._logHandler(this,te.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,te.WARN,...e),this._logHandler(this,te.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,te.ERROR,...e),this._logHandler(this,te.ERROR,...e)}};var Mm=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(oU(n)){let i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}};function oU(t){let e=t.getComponent();return e?.type==="VERSION"}var Rm="@firebase/app",iI="0.10.13";var In=new ti("@firebase/app"),aU="@firebase/app-compat",lU="@firebase/analytics-compat",cU="@firebase/analytics",uU="@firebase/app-check-compat",dU="@firebase/app-check",hU="@firebase/auth",fU="@firebase/auth-compat",pU="@firebase/database",gU="@firebase/data-connect",mU="@firebase/database-compat",_U="@firebase/functions",vU="@firebase/functions-compat",yU="@firebase/installations",wU="@firebase/installations-compat",bU="@firebase/messaging",EU="@firebase/messaging-compat",DU="@firebase/performance",CU="@firebase/performance-compat",IU="@firebase/remote-config",SU="@firebase/remote-config-compat",TU="@firebase/storage",NU="@firebase/storage-compat",AU="@firebase/firestore",MU="@firebase/vertexai-preview",RU="@firebase/firestore-compat",OU="firebase",xU="10.14.1";var Om="[DEFAULT]",PU={[Rm]:"fire-core",[aU]:"fire-core-compat",[cU]:"fire-analytics",[lU]:"fire-analytics-compat",[dU]:"fire-app-check",[uU]:"fire-app-check-compat",[hU]:"fire-auth",[fU]:"fire-auth-compat",[pU]:"fire-rtdb",[gU]:"fire-data-connect",[mU]:"fire-rtdb-compat",[_U]:"fire-fn",[vU]:"fire-fn-compat",[yU]:"fire-iid",[wU]:"fire-iid-compat",[bU]:"fire-fcm",[EU]:"fire-fcm-compat",[DU]:"fire-perf",[CU]:"fire-perf-compat",[IU]:"fire-rc",[SU]:"fire-rc-compat",[TU]:"fire-gcs",[NU]:"fire-gcs-compat",[AU]:"fire-fst",[RU]:"fire-fst-compat",[MU]:"fire-vertex","fire-js":"fire-js",[OU]:"fire-js-all"};var ya=new Map,kU=new Map,xm=new Map;function rI(t,e){try{t.container.addComponent(e)}catch(n){In.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ii(t){let e=t.name;if(xm.has(e))return In.debug(`There were multiple attempts to register component ${e}.`),!1;xm.set(e,t);for(let n of ya.values())rI(n,t);for(let n of kU.values())rI(n,t);return!0}function Lm(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ds(t){return t.settings!==void 0}var FU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ni=new Cn("app","Firebase",FU);var Pm=class{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new _t("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ni.create("app-deleted",{appName:this._name})}};var hs=xU;function Um(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let i=Object.assign({name:Om,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw ni.create("bad-app-name",{appName:String(r)});if(n||(n=Nm()),!n)throw ni.create("no-options");let s=ya.get(r);if(s){if(ga(n,s.options)&&ga(i,s.config))return s;throw ni.create("duplicate-app",{appName:r})}let o=new va(r);for(let l of xm.values())o.addComponent(l);let a=new Pm(n,i,o);return ya.set(r,a),a}function ba(t=Om){let e=ya.get(t);if(!e&&t===Om&&Nm())return Um();if(!e)throw ni.create("no-app",{appName:t});return e}function Du(){return Array.from(ya.values())}function Ae(t,e,n){var i;let r=(i=PU[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),In.warn(a.join(" "));return}ii(new _t(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var LU="firebase-heartbeat-database",UU=1,wa="firebase-heartbeat-store",Am=null;function lI(){return Am||(Am=Wc(LU,UU,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(wa)}catch(n){console.warn(n)}}}}).catch(t=>{throw ni.create("idb-open",{originalErrorMessage:t.message})})),Am}function BU(t){return g(this,null,function*(){try{let n=(yield lI()).transaction(wa),i=yield n.objectStore(wa).get(cI(t));return yield n.done,i}catch(e){if(e instanceof on)In.warn(e.message);else{let n=ni.create("idb-get",{originalErrorMessage:e?.message});In.warn(n.message)}}})}function sI(t,e){return g(this,null,function*(){try{let i=(yield lI()).transaction(wa,"readwrite");yield i.objectStore(wa).put(e,cI(t)),yield i.done}catch(n){if(n instanceof on)In.warn(n.message);else{let i=ni.create("idb-set",{originalErrorMessage:n?.message});In.warn(i.message)}}})}function cI(t){return`${t.name}!${t.options.appId}`}var VU=1024,jU=30*24*60*60*1e3,km=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Fm(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return g(this,null,function*(){var e,n;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=oI();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=jU}),this._storage.overwrite(this._heartbeatsCache))}catch(i){In.warn(i)}})}getHeartbeatsHeader(){return g(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=oI(),{heartbeatsToSend:i,unsentEntries:r}=$U(this._heartbeatsCache.heartbeats),s=da(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return In.warn(n),""}})}};function oI(){return new Date().toISOString().substring(0,10)}function $U(t,e=VU){let n=[],i=t.slice();for(let r of t){let s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),aI(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),aI(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}var Fm=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return KC()?JC().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield BU(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return sI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return sI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function aI(t){return da(JSON.stringify({version:2,heartbeats:t})).length}function HU(t){ii(new _t("platform-logger",e=>new Mm(e),"PRIVATE")),ii(new _t("heartbeat",e=>new km(e),"PRIVATE")),Ae(Rm,iI,t),Ae(Rm,iI,"esm2017"),Ae("fire-js","")}HU("");var WU="firebase",GU="10.14.1";Ae(WU,GU,"app");var ps=new Bn("ANGULARFIRE2_VERSION");function Vm(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var Da=(t,e)=>{let n=e?[e]:Du(),i=[];return n.forEach(r=>{r.container.getProvider(t).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},Ea=class{constructor(){return Da(zU)}},zU="app-check";function fs(){}var Cu=class{zone;delegate;constructor(e,n=vd){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,i)}},Bm=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",fs,{},fs,fs)),n.pipe(ye({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ca=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Cu(Zone.current)),this.insideAngular=n.run(()=>new Cu(Zone.current,nl)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||t)(T(K))};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Iu(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function qU(t){return Iu().ngZone.runOutsideAngular(()=>t())}function Wi(t){return Iu().ngZone.run(()=>t())}function YU(t){return KU(Iu())(t)}function KU(t){return function(n){return n=n.lift(new Bm(t.ngZone)),n.pipe(Mn(t.outsideAngular),An(t.insideAngular))}}var JU=(t,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Wi(()=>t.apply(void 0,i))},Ia=(t,e)=>function(){let n,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(n||=Wi(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",fs,{},fs,fs))),i[s]=JU(i[s],n));let r=qU(()=>t.apply(this,i));if(!e)if(r instanceof P){let s=Iu();return r.pipe(Mn(s.outsideAngular),An(s.insideAngular))}else return Wi(()=>r);return r instanceof P?r.pipe(YU):r instanceof Promise?Wi(()=>new Promise((s,o)=>r.then(a=>Wi(()=>s(a)),a=>Wi(()=>o(a))))):typeof r=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),r.apply(this,arguments)}:Wi(()=>r)};var Gi=class{constructor(e){return e}},Sa=class{constructor(){return Du()}};function QU(t){return t&&t.length===1?t[0]:new Gi(ba())}var jm=new A("angularfire2._apps"),ZU={provide:Gi,useFactory:QU,deps:[[new ht,jm]]},XU={provide:Sa,deps:[[new ht,jm]]};function eB(t){return(e,n)=>{let i=n.get(Tt);Ae("angularfire",ps.full,"core"),Ae("angularfire",ps.full,"app"),Ae("angular",Kw.full,i.toString());let r=e.runOutsideAngular(()=>t(n));return new Gi(r)}}function uI(t,...e){return Vn([ZU,XU,{provide:jm,useFactory:eB(t),multi:!0,deps:[K,Je,Ca,...e]}])}var dI=Ia(Um,!0);function yI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var wI=yI,bI=new Cn("auth","Firebase",yI());var Au=new ti("@firebase/auth");function tB(t,...e){Au.logLevel<=te.WARN&&Au.warn(`Auth (${hs}): ${t}`,...e)}function Tu(t,...e){Au.logLevel<=te.ERROR&&Au.error(`Auth (${hs}): ${t}`,...e)}function hI(t,...e){throw Xm(t,...e)}function Zm(t,...e){return Xm(t,...e)}function EI(t,e,n){let i=Object.assign(Object.assign({},wI()),{[e]:n});return new Cn("auth","Firebase",i).create(e,{appName:t.name})}function Nu(t){return EI(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Xm(t,...e){if(typeof t!="string"){let n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return bI.create(t,...e)}function J(t,e,...n){if(!t)throw Xm(e,...n)}function Ta(t){let e="INTERNAL ASSERTION FAILED: "+t;throw Tu(e),new Error(e)}function Mu(t,e){t||Ta(e)}function nB(){return fI()==="http:"||fI()==="https:"}function fI(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function iB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nB()||YC()||"connection"in navigator)?navigator.onLine:!0}function rB(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var qi=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,Mu(n>e,"Short delay should be less than long delay!"),this.isMobile=fa()||wu()}get(){return iB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function sB(t,e){Mu(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Ru=class{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ta("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ta("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ta("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var oB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var aB=new qi(3e4,6e4);function DI(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function ku(s,o,a,l){return g(this,arguments,function*(t,e,n,i,r={}){return CI(t,r,()=>g(this,null,function*(){let c={},u={};i&&(e==="GET"?u=i:c={body:JSON.stringify(i)});let d=ma(Object.assign({key:t.config.apiKey},u)).slice(1),h=yield t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);let f=Object.assign({method:e,headers:h},c);return qC()||(f.referrerPolicy="no-referrer"),Ru.fetch()(II(t,t.config.apiHost,n,d),f)}))})}function CI(t,e,n){return g(this,null,function*(){t._canInitEmulator=!1;let i=Object.assign(Object.assign({},oB),e);try{let r=new Wm(t),s=yield Promise.race([n(),r.promise]);r.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Su(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Su(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Su(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Su(t,"user-disabled",o);let u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw EI(t,u,c);hI(t,u)}}catch(r){if(r instanceof on)throw r;hI(t,"network-request-failed",{message:String(r)})}})}function II(t,e,n,i){let r=`${e}${n}?${i}`;return t.config.emulator?sB(t.config,r):`${t.config.apiScheme}://${r}`}var Wm=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Zm(this.auth,"network-request-failed")),aB.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Su(t,e,n){let i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);let r=Zm(t,e,i);return r.customData._tokenResponse=n,r}function lB(t,e){return g(this,null,function*(){return ku(t,"POST","/v1/accounts:delete",e)})}function SI(t,e){return g(this,null,function*(){return ku(t,"POST","/v1/accounts:lookup",e)})}function Na(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function e_(t,e=!1){return g(this,null,function*(){let n=ei(t),i=yield n.getIdToken(e),r=TI(i);J(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:Na($m(r.auth_time)),issuedAtTime:Na($m(r.iat)),expirationTime:Na($m(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function $m(t){return Number(t)*1e3}function TI(t){let[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return Tu("JWT malformed, contained fewer than 3 sections"),null;try{let r=ha(n);return r?JSON.parse(r):(Tu("Failed to decode base64 JWT payload"),null)}catch(r){return Tu("Caught error parsing JWT payload as JSON",r?.toString()),null}}function pI(t){let e=TI(t);return J(e,"internal-error"),J(typeof e.exp<"u","internal-error"),J(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Gm(t,e,n=!1){return g(this,null,function*(){if(n)return e;try{return yield e}catch(i){throw i instanceof on&&cB(i)&&t.auth.currentUser===t&&(yield t.auth.signOut()),i}})}function cB({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var zm=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),n)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ma=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Na(this.lastLoginAt),this.creationTime=Na(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ou(t){return g(this,null,function*(){var e;let n=t.auth,i=yield t.getIdToken(),r=yield Gm(t,SI(n,{idToken:i}));J(r?.users.length,n,"internal-error");let s=r.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?NI(s.providerUserInfo):[],a=uB(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!a?.length,u=l?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ma(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,d)})}function t_(t){return g(this,null,function*(){let e=ei(t);yield Ou(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function uB(t,e){return[...t.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function NI(t){return t.map(e=>{var{providerId:n}=e,i=yd(e,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function dB(t,e){return g(this,null,function*(){let n=yield CI(t,{},()=>g(this,null,function*(){let i=ma({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=II(t,r,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Ru.fetch()(o,{method:"POST",headers:a,body:i})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function hB(t,e){return g(this,null,function*(){return ku(t,"POST","/v2/accounts:revokeToken",DI(t,e))})}var Aa=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){J(e.idToken,"internal-error"),J(typeof e.idToken<"u","internal-error"),J(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){J(e.length!==0,"internal-error");let n=pI(e);this.updateTokensAndExpiration(e,null,n)}getToken(e,n=!1){return g(this,null,function*(){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(J(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return g(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield dB(e,n);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){let{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new t;return i&&(J(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(J(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(J(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return Ta("not implemented")}};function ri(t,e){J(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Ra=class t{constructor(e){var{uid:n,auth:i,stsTokenManager:r}=e,s=yd(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ma(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let n=yield Gm(this,this.stsTokenManager.getToken(this.auth,e));return J(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return e_(this,e)}reload(){return t_(this)}_assign(e){this!==e&&(J(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){J(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return g(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&(yield Ou(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(ds(this.auth.app))return Promise.reject(Nu(this.auth));let e=yield this.getIdToken();return yield Gm(this,lB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var i,r,s,o,a,l,c,u;let d=(i=n.displayName)!==null&&i!==void 0?i:void 0,h=(r=n.email)!==null&&r!==void 0?r:void 0,f=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,b=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=n.createdAt)!==null&&c!==void 0?c:void 0,ve=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:se,emailVerified:ke,isAnonymous:cn,providerData:Be,stsTokenManager:un}=n;J(se&&un,e,"internal-error");let As=Aa.fromJSON(this.name,un);J(typeof se=="string",e,"internal-error"),ri(d,e.name),ri(h,e.name),J(typeof ke=="boolean",e,"internal-error"),J(typeof cn=="boolean",e,"internal-error"),ri(f,e.name),ri(p,e.name),ri(_,e.name),ri(b,e.name),ri(x,e.name),ri(ve,e.name);let Ms=new t({uid:se,auth:e,email:h,emailVerified:ke,displayName:d,isAnonymous:cn,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:As,createdAt:x,lastLoginAt:ve});return Be&&Array.isArray(Be)&&(Ms.providerData=Be.map(nd=>Object.assign({},nd))),b&&(Ms._redirectEventId=b),Ms}static _fromIdTokenResponse(e,n,i=!1){return g(this,null,function*(){let r=new Aa;r.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield Ou(s),s})}static _fromGetAccountInfoResponse(e,n,i){return g(this,null,function*(){let r=n.users[0];J(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?NI(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new Aa;a.updateFromIdToken(i);let l=new t({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Ma(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,c),l})}};var gI=new Map;function zi(t){Mu(t instanceof Function,"Expected a class definition");let e=gI.get(t);return e?(Mu(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,gI.set(t,e),e)}var fB=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(n,i){return g(this,null,function*(){this.storage[n]=i})}_get(n){return g(this,null,function*(){let i=this.storage[n];return i===void 0?null:i})}_remove(n){return g(this,null,function*(){delete this.storage[n]})}_addListener(n,i){}_removeListener(n,i){}}return t.type="NONE",t})(),qm=fB;function Hm(t,e,n){return`firebase:${t}:${e}:${n}`}var xu=class t{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=Hm(this.userKey,r.apiKey,s),this.fullPersistenceKey=Hm("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Ra._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,i="authUser"){return g(this,null,function*(){if(!n.length)return new t(zi(qm),e,i);let r=(yield Promise.all(n.map(c=>g(this,null,function*(){if(yield c._isAvailable())return c})))).filter(c=>c),s=r[0]||zi(qm),o=Hm(i,e.config.apiKey,e.name),a=null;for(let c of n)try{let u=yield c._get(o);if(u){let d=Ra._fromJSON(e,u);c!==s&&(a=d),s=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new t(s,e,i):(s=l[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(c=>g(this,null,function*(){if(c!==s)try{yield c._remove(o)}catch{}}))),new t(s,e,i))})}};function mI(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_B(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pB(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yB(e))return"Blackberry";if(wB(e))return"Webos";if(gB(e))return"Safari";if((e.includes("chrome/")||mB(e))&&!e.includes("edge/"))return"Chrome";if(vB(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function pB(t=xt()){return/firefox\//i.test(t)}function gB(t=xt()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mB(t=xt()){return/crios\//i.test(t)}function _B(t=xt()){return/iemobile/i.test(t)}function vB(t=xt()){return/android/i.test(t)}function yB(t=xt()){return/blackberry/i.test(t)}function wB(t=xt()){return/webos/i.test(t)}function AI(t,e=[]){let n;switch(t){case"Browser":n=mI(xt());break;case"Worker":n=`${mI(xt())}-${t}`;break;default:n=t}let i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hs}/${i}`}var Ym=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let i=s=>new Promise((o,a)=>{try{let l=e(s);o(l)}catch(l){a(l)}});i.onAbort=n,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let i of this.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(let r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function bB(n){return g(this,arguments,function*(t,e={}){return ku(t,"GET","/v2/passwordPolicy",DI(t,e))})}var EB=6,Km=class{constructor(e){var n,i,r,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:EB,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,i,r,s,o,a;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Jm=class{constructor(e,n,i,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pu(this),this.idTokenSubscription=new Pu(this),this.beforeStateQueue=new Ym(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zi(n)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield xu.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let n=yield SI(this,{idToken:e}),i=yield Ra._fromGetAccountInfoResponse(this,n,e);yield this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var n;if(ds(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!o||o===a)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return J(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return g(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Ou(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=rB()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(ds(this.app))return Promise.reject(Nu(this));let n=e?ei(e):null;return n&&J(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return g(this,null,function*(){if(!this._deleted)return e&&J(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return ds(this.app)?Promise.reject(Nu(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return ds(this.app)?Promise.reject(Nu(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(zi(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield bB(this),n=new Km(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Cn("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},n)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),yield hB(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return g(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&zi(e)||this._popupRedirectResolver;J(n,this,"argument-error"),this.redirectPersistenceManager=yield xu.create(this,[zi(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var n,i;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,r){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(J(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let l=e.addObserver(n,i,r);return()=>{o=!0,l()}}else{let l=e.addObserver(n);return()=>{o=!0,l()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return J(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=AI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n})}_getAppCheckToken(){return g(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&tB(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function DB(t){return ei(t)}var Pu=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=eI(n=>this.observer=n)}get next(){return J(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var CB={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function IB(t){CB=t}function SB(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function TB(t,e){let n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(zi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}var GY=SB("rcb"),zY=new qi(3e4,6e4);var qY=new qi(2e3,1e4);var YY=10*60*1e3;var KY=new qi(3e4,6e4);var JY=new qi(5e3,15e3);var QY=encodeURIComponent("fac");var _I="@firebase/auth",vI="1.7.9";var Qm=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){J(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function NB(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AB(t){ii(new _t("auth",(e,{options:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;J(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:AI(t)},c=new Jm(i,r,s,l);return TB(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),ii(new _t("auth-internal",e=>{let n=DB(e.getProvider("auth").getImmediate());return(i=>new Qm(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ae(_I,vI,NB(t)),Ae(_I,vI,"esm2017")}var MB=5*60,ZY=GC("authIdTokenMaxAge")||MB;function RB(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}IB({loadJS(t){return new Promise((e,n)=>{let i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=r=>{let s=Zm("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",RB().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AB("Browser");var MV="auth";var Fu=class{constructor(){return Da(MV)}};var MI="@firebase/database",RI="1.0.8";var X_="";function RV(t){X_=t}var c_=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ne(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:us(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var u_=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ln(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var cS=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c_(e)}}catch{}return new u_},Ki=cS("localStorage"),d_=cS("sessionStorage");var vs=new ti("@firebase/database"),OV=function(){let t=1;return function(){return t++}}(),uS=function(t){let e=nI(t),n=new vu;n.update(e);let i=n.digest();return yu.encodeByteArray(i)},Wa=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Wa.apply(null,i):typeof i=="object"?e+=Ne(i):e+=i,e+=" "}return e},Ji=null,OI=!0,xV=function(t,e){y(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(vs.logLevel=te.VERBOSE,Ji=vs.log.bind(vs),e&&d_.set("logging_enabled",!0)):typeof t=="function"?Ji=t:(Ji=null,d_.remove("logging_enabled"))},Fe=function(...t){if(OI===!0&&(OI=!1,Ji===null&&d_.get("logging_enabled")===!0&&xV(!0)),Ji){let e=Wa.apply(null,t);Ji(e)}},Ga=function(t){return function(...e){Fe(t,...e)}},h_=function(...t){let e="FIREBASE INTERNAL ERROR: "+Wa(...t);vs.error(e)},Tn=function(...t){let e=`FIREBASE FATAL ERROR: ${Wa(...t)}`;throw vs.error(e),new Error(e)},ot=function(...t){let e="FIREBASE WARNING: "+Wa(...t);vs.warn(e)},PV=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ot("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},dS=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},kV=function(t){if(an()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ws="[MIN_NAME]",Qi="[MAX_NAME]",Ts=function(t,e){if(t===e)return 0;if(t===ws||e===Qi)return-1;if(e===ws||t===Qi)return 1;{let n=xI(t),i=xI(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},FV=function(t,e){return t===e?0:t<e?-1:1},Oa=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ne(e))},ev=function(t){if(typeof t!="object"||t===null)return Ne(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=Ne(e[i]),n+=":",n+=ev(t[e[i]]);return n+="}",n},hS=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function wt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var fS=function(t){y(!dS(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,r,s,o,a,l;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));let c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let u=c.join(""),d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},LV=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},UV=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var BV=new RegExp("^-?(0*)\\d{1,10}$"),VV=-2147483648,jV=2147483647,xI=function(t){if(BV.test(t)){let e=Number(t);if(e>=VV&&e<=jV)return e}return null},za=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw ot("Exception was thrown by user callback.",n),e},Math.floor(0))}},$V=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},La=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var f_=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){ot(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var p_=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Fe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ot(e)}},Ua=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Uu="5",pS="v",gS="s",mS="r",_S="f",vS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,yS="ls",wS="p",g_="ac",bS="websocket",ES="long_polling";var Bu=class{constructor(e,n,i,r,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ki.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ki.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function HV(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function DS(t,e,n){y(typeof e=="string","typeof type must == string"),y(typeof n=="object","typeof params must == object");let i;if(e===bS)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ES)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);HV(t)&&(n.ns=t.namespace);let r=[];return wt(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var m_=class{constructor(){this.counters_={}}incrementCounter(e,n=1){ln(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return jC(this.counters_)}};var n_={},i_={};function tv(t){let e=t.toString();return n_[e]||(n_[e]=new m_),n_[e]}function WV(t,e){let n=t.toString();return i_[n]||(i_[n]=e()),i_[n]}var __=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&za(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var PI="start",GV="close",zV="pLPCommand",qV="pRTLPCB",CS="id",IS="pw",SS="ser",YV="cb",KV="seg",JV="ts",QV="d",ZV="dframe",TS=1870,NS=30,XV=TS-NS,ej=25e3,tj=3e4,v_=class t{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ga(e),this.stats_=tv(n),this.urlFn=l=>(this.appCheckToken&&(l[g_]=this.appCheckToken),DS(n,ES,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new __(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(tj)),kV(()=>{if(this.isClosed_)return;this.scriptTagHolder=new y_((...s)=>{let[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===PI)this.id=a,this.password=l;else if(o===GV)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[PI]="t",i[SS]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[YV]=this.scriptTagHolder.uniqueCallbackIdentifier),i[pS]=Uu,this.transportSessionId&&(i[gS]=this.transportSessionId),this.lastSessionId&&(i[yS]=this.lastSessionId),this.applicationId&&(i[wS]=this.applicationId),this.appCheckToken&&(i[g_]=this.appCheckToken),typeof location<"u"&&location.hostname&&vS.test(location.hostname)&&(i[mS]=_S);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return an()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!LV()&&!UV()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Ne(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=Sm(n),r=hS(i,XV);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(an())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[ZV]="t",i[CS]=e,i[IS]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Ne(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},y_=class t{constructor(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,an())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=OV(),window[zV+this.uniqueCallbackIdentifier]=e,window[qV+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Fe("frame writing exception"),a.stack&&Fe(a.stack),Fe(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Fe("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[CS]=this.myID,e[IS]=this.myPW,e[SS]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+NS+i.length<=TS;){let o=this.pendingSegs.shift();i=i+"&"+KV+r+"="+o.seg+"&"+JV+r+"="+o.ts+"&"+QV+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(ej)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){an()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{Fe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var nj=16384,ij=45e3,Vu=null;typeof MozWebSocket<"u"?Vu=MozWebSocket:typeof WebSocket<"u"&&(Vu=WebSocket);var xa=(()=>{class t{constructor(n,i,r,s,o,a,l){this.connId=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ga(this.connId),this.stats_=tv(i),this.connURL=t.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,r,s,o){let a={};return a[pS]=Uu,!an()&&typeof location<"u"&&location.hostname&&vS.test(location.hostname)&&(a[mS]=_S),i&&(a[gS]=i),r&&(a[yS]=r),s&&(a[g_]=s),o&&(a[wS]=o),DS(n,bS,a)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ki.set("previous_websocket_failure",!0);try{let r;if(an()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${Uu}/${X_}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new Vu(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(n=!0)}return!n&&Vu!==null&&!t.forceDisallow_}static previouslyFailed(){return Ki.isInMemoryStorage||Ki.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ki.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=us(i);this.onMessage(r)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(y(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(n){this.resetKeepAlive();let i=Ne(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=hS(i,nj);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(ij))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),rj=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[v_,xa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=xa&&xa.isAvailable(),r=i&&!xa.previouslyFailed();if(n.webSocketOnly&&(i||ot("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[xa];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),sj=6e4,oj=5e3,aj=10*1024,lj=100*1024,r_="t",kI="d",cj="s",FI="r",uj="e",LI="o",UI="a",BI="n",VI="p",dj="h",w_=class{constructor(e,n,i,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ga("c:"+this.id+":"),this.transportManager_=new rj(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=La(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>lj?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>aj?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(r_ in e){let n=e[r_];n===UI?this.upgradeIfSecondaryHealthy_():n===FI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===LI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Oa("t",e),i=Oa("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:VI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:UI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:BI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Oa("t",e),i=Oa("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Oa(r_,e);if(kI in e){let i=e[kI];if(n===dj){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===BI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===cj?this.onConnectionShutdown_(i):n===FI?this.onReset_(i):n===uj?h_("Server Error: "+i):n===LI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):h_("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Uu!==i&&ot("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),La(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(sj))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):La(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(oj))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:VI,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ki.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var ju=class{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var $u=class{constructor(e){this.allowedEvents_=e,this.listeners_={},y(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){y(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Hu=class t extends $u{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!fa()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return y(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var jI=32,$I=768,re=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ne(){return new re("")}function G(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function oi(t){return t.pieces_.length-t.pieceNum_}function ce(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new re(t.pieces_,e)}function AS(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function hj(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function MS(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function RS(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new re(e,0)}function Me(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof re)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new re(n,0)}function H(t){return t.pieceNum_>=t.pieces_.length}function vt(t,e){let n=G(t),i=G(e);if(n===null)return e;if(n===i)return vt(ce(t),ce(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function OS(t,e){if(oi(t)!==oi(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function kt(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(oi(t)>oi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var b_=class{constructor(e,n){this.errorPrefix_=n,this.parts_=MS(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=_a(this.parts_[i]);xS(this)}};function fj(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=_a(e),xS(t)}function pj(t){let e=t.parts_.pop();t.byteLength_-=_a(e),t.parts_.length>0&&(t.byteLength_-=1)}function xS(t){if(t.byteLength_>$I)throw new Error(t.errorPrefix_+"has a key path longer than "+$I+" bytes ("+t.byteLength_+").");if(t.parts_.length>jI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+jI+") or object contains a cycle "+Yi(t))}function Yi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var E_=class t extends $u{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return y(e==="visible","Unknown event type: "+e),[this.visible_]}};var Pa=1e3,gj=60*5*1e3,HI=30*1e3,mj=1.3,_j=3e4,vj="server_kill",WI=3,nv=(()=>{class t extends ju{constructor(n,i,r,s,o,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Ga("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Pa,this.maxReconnectDelay_=gj,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!an())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");E_.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Hu.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,r){let s=++this.requestNumber_,o={r:s,a:n,b:i};this.log_(Ne(o)),y(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(n){this.initConnection_();let i=new Vi,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,r,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),y(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),y(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:n,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(n){let i=n.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,u=l.s;t.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===n&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),n.onComplete&&n.onComplete(u,c))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&ln(n,"w")){let r=$i(n,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();ot(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||XC(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=HI)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=ZC(n)?"auth":"gauth",r={cred:n};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,r=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(n,i){let r=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),y(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,n._queryObject,i)}sendUnlisten_(n,i,r,s){this.log_("Unlisten on "+n+" for "+i);let o={p:n},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:r})}onDisconnectMerge(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:r})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,i,r,s){this.putInternal("p",n,i,r,s)}merge(n,i,r,s){this.putInternal("m",n,i,r,s)}putInternal(n,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,r=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Ne(n));let i=n.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):h_("Unrecognized action received from server: "+Ne(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){y(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pa,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Pa,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>_j&&(this.reconnectDelay_=Pa),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*mj)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,r())},u=function(h){y(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Fe("getToken() completed but was canceled"):(Fe("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,l=new w_(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,r,p=>{ot(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(vj)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&ot(h),c())}}})}interrupt(n){Fe("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Fe("Resuming connection for reason: "+n),delete this.interruptReasons_[n],bu(this.interruptReasons_)&&(this.reconnectDelay_=Pa,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let r;i?r=i.map(o=>ev(o)).join("$"):r="default";let s=this.removeListen_(n,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,i){let r=new re(n).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(n,i){Fe("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=WI&&(this.reconnectDelay_=HI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){Fe("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=WI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";an()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+X_.replace(/\./g,"-")]=1,fa()?n["framework.cordova"]=1:wu()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Hu.getInstance().currentlyOnline();return bu(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),z=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var bs=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new z(ws,e),r=new z(ws,n);return this.compare(i,r)!==0}minPost(){return z.MIN}};var Lu,Wu=class extends bs{static get __EMPTY_NODE(){return Lu}static set __EMPTY_NODE(e){Lu=e}compare(e,n){return Ts(e.name,n.name)}isDefinedOn(e){throw ji("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return z.MIN}maxPost(){return new z(Qi,Lu)}makePost(e,n){return y(typeof e=="string","KeyIndex indexValue must always be a string."),new z(e,Lu)}toString(){return".key"}},ys=new Wu;var ms=class{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Pt=(()=>{class t{constructor(n,i,r,s,o){this.key=n,this.value=i,this.color=r??t.RED,this.left=s??yt.EMPTY_NODE,this.right=o??yt.EMPTY_NODE}copy(n,i,r,s,o){return new t(n??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,r){let s=this,o=r(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return yt.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let r,s;if(r=this,i(n,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(n,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(n,r.key)===0){if(r.right.isEmpty())return yt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(n,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),D_=class{copy(e,n,i,r,s){return this}insert(e,n,i){return new Pt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},yt=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Pt.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Pt.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ms(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ms(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ms(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ms(this.root_,null,this.comparator_,!0,e)}};yt.EMPTY_NODE=new D_;function yj(t,e){return Ts(t.name,e.name)}function iv(t,e){return Ts(t,e)}var C_;function wj(t){C_=t}var PS=function(t){return typeof t=="number"?"number:"+fS(t):"string:"+t},kS=function(t){if(t.isLeafNode()){let e=t.val();y(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ln(e,".sv"),"Priority must be a string or number.")}else y(t===C_||t.isEmpty(),"priority of unexpected type.");y(t===C_||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var GI,Es=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,y(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),kS(this.priorityNode_)}static set __childrenNodeConstructor(n){GI=n}static get __childrenNodeConstructor(){return GI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return H(n)?this:G(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let r=G(n);return r===null?i:i.isEmpty()&&r!==".priority"?this:(y(r!==".priority"||oi(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(ce(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+PS(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=fS(this.value_):n+=this.value_,this.lazyHash_=uS(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(y(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,r=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(r);return y(s>=0,"Unknown leaf type: "+i),y(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),FS,LS;function bj(t){FS=t}function Ej(t){LS=t}var I_=class extends bs{compare(e,n){let i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Ts(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return z.MIN}maxPost(){return new z(Qi,new Es("[PRIORITY-POST]",LS))}makePost(e,n){let i=FS(e);return new z(n,new Es("[PRIORITY-POST]",i))}toString(){return".priority"}},Ue=new I_;var Dj=Math.log(2),S_=class{constructor(e){let n=s=>parseInt(Math.log(s)/Dj,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Gu=function(t,e,n,i){t.sort(e);let r=function(l,c){let u=c-l,d,h;if(u===0)return null;if(u===1)return d=t[l],h=n?n(d):d,new Pt(h,d.node,Pt.BLACK,null,null);{let f=parseInt(u/2,10)+l,p=r(l,f),_=r(f+1,c);return d=t[f],h=n?n(d):d,new Pt(h,d.node,Pt.BLACK,p,_)}},s=function(l){let c=null,u=null,d=t.length,h=function(p,_){let b=d-p,x=d;d-=p;let ve=r(b+1,x),se=t[b],ke=n?n(se):se;f(new Pt(ke,se.node,_,null,ve))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){let _=l.nextBitIsOne(),b=Math.pow(2,l.count-(p+1));_?h(b,Pt.BLACK):(h(b,Pt.BLACK),h(b,Pt.RED))}return u},o=new S_(t.length),a=s(o);return new yt(i||e,a)};var s_,gs={},Ds=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return y(gs&&Ue,"ChildrenNode.ts has not been loaded"),s_=s_||new t({".priority":gs},{".priority":Ue}),s_}get(e){let n=$i(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof yt?n:null}hasIndex(e){return ln(this.indexSet_,e.toString())}addIndex(e,n){y(e!==ys,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=n.getIterator(z.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Gu(i,e.getCompare()):a=gs;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new t(u,c)}addToIndexes(e,n){let i=pa(this.indexes_,(r,s)=>{let o=$i(this.indexSet_,s);if(y(o,"Missing index implementation for "+s),r===gs)if(o.isDefinedOn(e.node)){let a=[],l=n.getIterator(z.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Gu(a,o.getCompare())}else return gs;else{let a=n.get(e.name),l=r;return a&&(l=l.remove(new z(e.name,a))),l.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=pa(this.indexes_,r=>{if(r===gs)return r;{let s=n.get(e.name);return s?r.remove(new z(e.name,s)):r}});return new t(i,this.indexSet_)}};var ka,fe=(()=>{class t{constructor(n,i,r){this.children_=n,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&kS(this.priorityNode_),this.children_.isEmpty()&&y(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ka||(ka=new t(new yt(iv),null,Ds.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ka}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?ka:i}}getChild(n){let i=G(n);return i===null?this:this.getImmediateChild(i).getChild(ce(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(y(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let r=new z(n,i),s,o;i.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?ka:this.priorityNode_;return new t(s,a,o)}}updateChild(n,i){let r=G(n);if(r===null)return i;{y(G(n)!==".priority"||oi(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(ce(n),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(Ue,(a,l)=>{i[a]=l.val(n),r++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*r){let a=[];for(let l in i)a[l]=i[l];return a}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+PS(this.getPriority().val())+":"),this.forEachChild(Ue,(i,r)=>{let s=r.hash();s!==""&&(n+=":"+i+":"+s)}),this.lazyHash_=n===""?"":uS(n)}return this.lazyHash_}getPredecessorChildName(n,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new z(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new z(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new z(i,this.children_.get(i)):null}forEachChild(n,i){let r=this.resolveIndex_(n);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,z.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,z.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===qa?-1:0}withIndex(n){if(n===ys||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===ys||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(Ue),s=i.getIterator(Ue),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===ys?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),T_=class extends fe{constructor(){super(new yt(iv),fe.EMPTY_NODE,Ds.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return fe.EMPTY_NODE}isEmpty(){return!1}},qa=new T_;Object.defineProperties(z,{MIN:{value:new z(ws,fe.EMPTY_NODE)},MAX:{value:new z(Qi,qa)}});Wu.__EMPTY_NODE=fe.EMPTY_NODE;Es.__childrenNodeConstructor=fe;wj(qa);Ej(qa);var Cj=!0;function Le(t,e=null){if(t===null)return fe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),y(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Es(n,Le(e))}if(!(t instanceof Array)&&Cj){let n=[],i=!1;if(wt(t,(o,a)=>{if(o.substring(0,1)!=="."){let l=Le(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new z(o,l)))}}),n.length===0)return fe.EMPTY_NODE;let s=Gu(n,yj,o=>o.name,iv);if(i){let o=Gu(n,Ue.getCompare());return new fe(s,Le(e),new Ds({".priority":o},{".priority":Ue}))}else return new fe(s,Le(e),Ds.Default)}else{let n=fe.EMPTY_NODE;return wt(t,(i,r)=>{if(ln(t,i)&&i.substring(0,1)!=="."){let s=Le(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(Le(e))}}bj(Le);var N_=class extends bs{constructor(e){super(),this.indexPath_=e,y(!H(e)&&G(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Ts(e.name,n.name):s}makePost(e,n){let i=Le(e),r=fe.EMPTY_NODE.updateChild(this.indexPath_,i);return new z(n,r)}maxPost(){let e=fe.EMPTY_NODE.updateChild(this.indexPath_,qa);return new z(Qi,e)}toString(){return MS(this.indexPath_,0).join("/")}};var A_=class extends bs{compare(e,n){let i=e.node.compareTo(n.node);return i===0?Ts(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return z.MIN}maxPost(){return z.MAX}makePost(e,n){let i=Le(e);return new z(n,i)}toString(){return".value"}},Ij=new A_;function Sj(t){return{type:"value",snapshotNode:t}}function Tj(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Nj(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function zI(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Aj(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var M_=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ue}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return y(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return y(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ws}hasEnd(){return this.endSet_}getIndexEndValue(){return y(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return y(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return y(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ue}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function qI(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ue?n="$priority":t.index_===Ij?n="$value":t.index_===ys?n="$key":(y(t.index_ instanceof N_,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ne(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=Ne(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+Ne(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=Ne(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+Ne(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function YI(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ue&&(e.i=t.index_.toString()),e}var R_=class t extends ju{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Ga("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(y(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,i),a={};this.listens_[o]=a;let l=qI(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,i),$i(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",r(h,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=qI(e._queryParams),i=e._path.toString(),r=new Vi;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ma(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=us(a.responseText)}catch{ot("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&ot("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var O_=class{constructor(){this.rootNode_=fe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function zu(){return{value:null,children:new Map}}function US(t,e,n){if(H(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=G(e);t.children.has(i)||t.children.set(i,zu());let r=t.children.get(i);e=ce(e),US(r,e,n)}}function x_(t,e,n){t.value!==null?n(e,t.value):Mj(t,(i,r)=>{let s=new re(e.toString()+"/"+i);x_(r,s,n)})}function Mj(t,e){t.children.forEach((n,i)=>{e(i,n)})}var P_=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&wt(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}};var KI=10*1e3,Rj=30*1e3,Oj=5*60*1e3,k_=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new P_(e);let i=KI+(Rj-KI)*Math.random();La(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;wt(e,(r,s)=>{s>0&&ln(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),La(this.reportStats_.bind(this),Math.floor(Math.random()*2*Oj))}};var Sn=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Sn||{});function BS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function VS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function jS(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var F_=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=Sn.ACK_USER_WRITE,this.source=BS()}operationForChild(e){if(H(this.path)){if(this.affectedTree.value!=null)return y(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new re(e));return new t(ne(),n,this.revert)}}else return y(G(this.path)===e,"operationForChild called for unrelated child."),new t(ce(this.path),this.affectedTree,this.revert)}};var Cs=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=Sn.OVERWRITE}operationForChild(e){return H(this.path)?new t(this.source,ne(),this.snap.getImmediateChild(e)):new t(this.source,ce(this.path),this.snap)}};var qu=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=Sn.MERGE}operationForChild(e){if(H(this.path)){let n=this.children.subtree(new re(e));return n.isEmpty()?null:n.value?new Cs(this.source,ne(),n.value):new t(this.source,ne(),n)}else return y(G(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,ce(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var ja=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(H(e))return this.isFullyInitialized()&&!this.filtered_;let n=G(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function xj(t,e,n,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Aj(o.childName,o.snapshotNode))}),Fa(t,r,"child_removed",e,i,n),Fa(t,r,"child_added",e,i,n),Fa(t,r,"child_moved",s,i,n),Fa(t,r,"child_changed",e,i,n),Fa(t,r,"value",e,i,n),r}function Fa(t,e,n,i,r,s){let o=i.filter(a=>a.type===n);o.sort((a,l)=>kj(t,a,l)),o.forEach(a=>{let l=Pj(t,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function Pj(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function kj(t,e,n){if(e.childName==null||n.childName==null)throw ji("Should only compare child_ events.");let i=new z(e.childName,e.snapshotNode),r=new z(n.childName,n.snapshotNode);return t.index_.compare(i,r)}function $S(t,e){return{eventCache:t,serverCache:e}}function Ba(t,e,n,i){return $S(new ja(e,n,i),t.serverCache)}function HS(t,e,n,i){return $S(t.eventCache,new ja(e,n,i))}function L_(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Zi(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var o_,Fj=()=>(o_||(o_=new yt(FV)),o_),Ze=class t{constructor(e,n=Fj()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return wt(e,(i,r)=>{n=n.set(new re(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ne(),value:this.value};if(H(e))return null;{let i=G(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(ce(e),n);return s!=null?{path:Me(new re(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(H(e))return this;{let n=G(e),i=this.children.get(n);return i!==null?i.subtree(ce(e)):new t(null)}}set(e,n){if(H(e))return new t(n,this.children);{let i=G(e),s=(this.children.get(i)||new t(null)).set(ce(e),n),o=this.children.insert(i,s);return new t(this.value,o)}}remove(e){if(H(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=G(e),i=this.children.get(n);if(i){let r=i.remove(ce(e)),s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(H(e))return this.value;{let n=G(e),i=this.children.get(n);return i?i.get(ce(e)):null}}setTree(e,n){if(H(e))return n;{let i=G(e),s=(this.children.get(i)||new t(null)).setTree(ce(e),n),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new t(this.value,o)}}fold(e){return this.fold_(ne(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Me(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,ne(),n)}findOnPath_(e,n,i){let r=this.value?i(n,this.value):!1;if(r)return r;if(H(e))return null;{let s=G(e),o=this.children.get(s);return o?o.findOnPath_(ce(e),Me(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ne(),n)}foreachOnPath_(e,n,i){if(H(e))return this;{this.value&&i(n,this.value);let r=G(e),s=this.children.get(r);return s?s.foreachOnPath_(ce(e),Me(n,r),i):new t(null)}}foreach(e){this.foreach_(ne(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(Me(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var Ft=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Ze(null))}};function Va(t,e,n){if(H(e))return new Ft(new Ze(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=vt(r,e);return s=s.updateChild(o,n),new Ft(t.writeTree_.set(r,s))}else{let r=new Ze(n),s=t.writeTree_.setTree(e,r);return new Ft(s)}}}function JI(t,e,n){let i=t;return wt(n,(r,s)=>{i=Va(i,Me(e,r),s)}),i}function QI(t,e){if(H(e))return Ft.empty();{let n=t.writeTree_.setTree(e,new Ze(null));return new Ft(n)}}function U_(t,e){return Xi(t,e)!=null}function Xi(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(vt(n.path,e)):null}function ZI(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ue,(i,r)=>{e.push(new z(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new z(i,r.value))}),e}function si(t,e){if(H(e))return t;{let n=Xi(t,e);return n!=null?new Ft(new Ze(n)):new Ft(t.writeTree_.subtree(e))}}function B_(t){return t.writeTree_.isEmpty()}function Is(t,e){return WS(ne(),t.writeTree_,e)}function WS(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(y(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=WS(Me(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(Me(t,".priority"),i)),n}}function GS(t,e){return JS(e,t)}function Lj(t,e,n,i,r){y(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Va(t.visibleWrites,e,n)),t.lastWriteId=i}function Uj(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function Bj(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);y(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&Vj(a,i.path)?r=!1:kt(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return jj(t),!0;if(i.snap)t.visibleWrites=QI(t.visibleWrites,i.path);else{let a=i.children;wt(a,l=>{t.visibleWrites=QI(t.visibleWrites,Me(i.path,l))})}return!0}else return!1}function Vj(t,e){if(t.snap)return kt(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&kt(Me(t.path,n),e))return!0;return!1}function jj(t){t.visibleWrites=zS(t.allWrites,$j,ne()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function $j(t){return t.visible}function zS(t,e,n){let i=Ft.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let o=s.path,a;if(s.snap)kt(n,o)?(a=vt(n,o),i=Va(i,a,s.snap)):kt(o,n)&&(a=vt(o,n),i=Va(i,ne(),s.snap.getChild(a)));else if(s.children){if(kt(n,o))a=vt(n,o),i=JI(i,a,s.children);else if(kt(o,n))if(a=vt(o,n),H(a))i=JI(i,ne(),s.children);else{let l=$i(s.children,G(a));if(l){let c=l.getChild(ce(a));i=Va(i,ne(),c)}}}else throw ji("WriteRecord should have .snap or .children")}}return i}function qS(t,e,n,i,r){if(!i&&!r){let s=Xi(t.visibleWrites,e);if(s!=null)return s;{let o=si(t.visibleWrites,e);if(B_(o))return n;if(n==null&&!U_(o,ne()))return null;{let a=n||fe.EMPTY_NODE;return Is(o,a)}}}else{let s=si(t.visibleWrites,e);if(!r&&B_(s))return n;if(!r&&n==null&&!U_(s,ne()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(kt(c.path,e)||kt(e,c.path))},a=zS(t.allWrites,o,e),l=n||fe.EMPTY_NODE;return Is(a,l)}}}function Hj(t,e,n){let i=fe.EMPTY_NODE,r=Xi(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Ue,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){let s=si(t.visibleWrites,e);return n.forEachChild(Ue,(o,a)=>{let l=Is(si(s,new re(o)),a);i=i.updateImmediateChild(o,l)}),ZI(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=si(t.visibleWrites,e);return ZI(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Wj(t,e,n,i,r){y(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=Me(e,n);if(U_(t.visibleWrites,s))return null;{let o=si(t.visibleWrites,s);return B_(o)?r.getChild(n):Is(o,r.getChild(n))}}function Gj(t,e,n,i){let r=Me(e,n),s=Xi(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){let o=si(t.visibleWrites,r);return Is(o,i.getNode().getImmediateChild(n))}else return null}function zj(t,e){return Xi(t.visibleWrites,e)}function qj(t,e,n,i,r,s,o){let a,l=si(t.visibleWrites,e),c=Xi(l,ne());if(c!=null)a=c;else if(n!=null)a=Is(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),f=h.getNext();for(;f&&u.length<r;)d(f,i)!==0&&u.push(f),f=h.getNext();return u}else return[]}function Yj(){return{visibleWrites:Ft.empty(),allWrites:[],lastWriteId:-1}}function V_(t,e,n,i){return qS(t.writeTree,t.treePath,e,n,i)}function YS(t,e){return Hj(t.writeTree,t.treePath,e)}function XI(t,e,n,i){return Wj(t.writeTree,t.treePath,e,n,i)}function Yu(t,e){return zj(t.writeTree,Me(t.treePath,e))}function Kj(t,e,n,i,r,s){return qj(t.writeTree,t.treePath,e,n,i,r,s)}function rv(t,e,n){return Gj(t.writeTree,t.treePath,e,n)}function KS(t,e){return JS(Me(t.treePath,e),t.writeTree)}function JS(t,e){return{treePath:t,writeTree:e}}var j_=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;y(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),y(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,zI(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Nj(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Tj(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,zI(i,e.snapshotNode,r.oldSnap));else throw ji("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var $_=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},QS=new $_,$a=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new ja(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return rv(this.writes_,e,i)}}getChildAfterChild(e,n,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Zi(this.viewCache_),s=Kj(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}};function Jj(t,e){y(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),y(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Qj(t,e,n,i,r){let s=new j_,o,a;if(n.type===Sn.OVERWRITE){let c=n;c.source.fromUser?o=H_(t,e,c.path,c.snap,i,r,s):(y(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!H(c.path),o=Ku(t,e,c.path,c.snap,i,r,a,s))}else if(n.type===Sn.MERGE){let c=n;c.source.fromUser?o=Xj(t,e,c.path,c.children,i,r,s):(y(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=W_(t,e,c.path,c.children,i,r,a,s))}else if(n.type===Sn.ACK_USER_WRITE){let c=n;c.revert?o=n$(t,e,c.path,i,r,s):o=e$(t,e,c.path,c.affectedTree,i,r,s)}else if(n.type===Sn.LISTEN_COMPLETE)o=t$(t,e,n.path,i,s);else throw ji("Unknown operation type: "+n.type);let l=s.getChanges();return Zj(e,o,l),{viewCache:o,changes:l}}function Zj(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=L_(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(Sj(L_(e)))}}function ZS(t,e,n,i,r,s){let o=e.eventCache;if(Yu(i,n)!=null)return e;{let a,l;if(H(n))if(y(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Zi(e),u=c instanceof fe?c:fe.EMPTY_NODE,d=YS(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=V_(i,Zi(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=G(n);if(c===".priority"){y(oi(n)===1,"Can't have a priority with additional path components");let u=o.getNode();l=e.serverCache.getNode();let d=XI(i,n,u,l);d!=null?a=t.filter.updatePriority(u,d):a=o.getNode()}else{let u=ce(n),d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let h=XI(i,n,o.getNode(),l);h!=null?d=o.getNode().getImmediateChild(c).updateChild(u,h):d=o.getNode().getImmediateChild(c)}else d=rv(i,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,u,r,s):a=o.getNode()}}return Ba(e,a,o.isFullyInitialized()||H(n),t.filter.filtersNodes())}}function Ku(t,e,n,i,r,s,o,a){let l=e.serverCache,c,u=o?t.filter:t.filter.getIndexedFilter();if(H(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){let f=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),f,null)}else{let f=G(n);if(!l.isCompleteForPath(n)&&oi(n)>1)return e;let p=ce(n),b=l.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?c=u.updatePriority(l.getNode(),b):c=u.updateChild(l.getNode(),f,b,p,QS,null)}let d=HS(e,c,l.isFullyInitialized()||H(n),u.filtersNodes()),h=new $a(r,d,s);return ZS(t,d,n,r,h,a)}function H_(t,e,n,i,r,s,o){let a=e.eventCache,l,c,u=new $a(r,e,s);if(H(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Ba(e,c,!0,t.filter.filtersNodes());else{let d=G(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),l=Ba(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=ce(n),f=a.getNode().getImmediateChild(d),p;if(H(h))p=i;else{let _=u.getCompleteChild(d);_!=null?AS(h)===".priority"&&_.getChild(RS(h)).isEmpty()?p=_:p=_.updateChild(h,i):p=fe.EMPTY_NODE}if(f.equals(p))l=e;else{let _=t.filter.updateChild(a.getNode(),d,p,h,u,o);l=Ba(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function eS(t,e){return t.eventCache.isCompleteForChild(e)}function Xj(t,e,n,i,r,s,o){let a=e;return i.foreach((l,c)=>{let u=Me(n,l);eS(e,G(u))&&(a=H_(t,a,u,c,r,s,o))}),i.foreach((l,c)=>{let u=Me(n,l);eS(e,G(u))||(a=H_(t,a,u,c,r,s,o))}),a}function tS(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function W_(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;H(n)?c=i:c=new Ze(null).setTree(n,i);let u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=tS(t,f,h);l=Ku(t,l,new re(d),p,r,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),_=tS(t,p,h);l=Ku(t,l,new re(d),_,r,s,o,a)}}),l}function e$(t,e,n,i,r,s,o){if(Yu(r,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(H(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Ku(t,e,n,l.getNode().getChild(n),r,s,a,o);if(H(n)){let c=new Ze(null);return l.getNode().forEachChild(ys,(u,d)=>{c=c.set(new re(u),d)}),W_(t,e,n,c,r,s,a,o)}else return e}else{let c=new Ze(null);return i.foreach((u,d)=>{let h=Me(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),W_(t,e,n,c,r,s,a,o)}}function t$(t,e,n,i,r){let s=e.serverCache,o=HS(e,s.getNode(),s.isFullyInitialized()||H(n),s.isFiltered());return ZS(t,o,n,i,QS,r)}function n$(t,e,n,i,r,s){let o;if(Yu(i,n)!=null)return e;{let a=new $a(i,e,r),l=e.eventCache.getNode(),c;if(H(n)||G(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=V_(i,Zi(e));else{let d=e.serverCache.getNode();y(d instanceof fe,"serverChildren would be complete if leaf node"),u=YS(i,d)}u=u,c=t.filter.updateFullNode(l,u,s)}else{let u=G(n),d=rv(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,ce(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,fe.EMPTY_NODE,ce(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=V_(i,Zi(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Yu(i,ne())!=null,Ba(e,c,o,t.filter.filtersNodes())}}function i$(t,e){let n=Zi(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!H(e)&&!n.getImmediateChild(G(e)).isEmpty())?n.getChild(e):null}function nS(t,e,n,i){e.type===Sn.MERGE&&e.source.queryId!==null&&(y(Zi(t.viewCache_),"We should always have a full cache before handling merges"),y(L_(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=Qj(t.processor_,r,e,n,i);return Jj(t.processor_,s.viewCache),y(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,r$(t,s.changes,s.viewCache.eventCache.getNode(),null)}function r$(t,e,n,i){let r=i?[i]:t.eventRegistrations_;return xj(t.eventGenerator_,e,n,r)}var iS;function s$(t){y(!iS,"__referenceConstructor has already been defined"),iS=t}function sv(t,e,n,i){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return y(s!=null,"SyncTree gave us an op for an invalid query."),nS(s,e,n,i)}else{let s=[];for(let o of t.views.values())s=s.concat(nS(o,e,n,i));return s}}function ov(t,e){let n=null;for(let i of t.views.values())n=n||i$(i,e);return n}var rS;function o$(t){y(!rS,"__referenceConstructor has already been defined"),rS=t}var Ju=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ze(null),this.pendingWriteTree_=Yj(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function a$(t,e,n,i,r){return Lj(t.pendingWriteTree_,e,n,i,r),r?Zu(t,new Cs(BS(),e,n)):[]}function _s(t,e,n=!1){let i=Uj(t.pendingWriteTree_,e);if(Bj(t.pendingWriteTree_,e)){let s=new Ze(null);return i.snap!=null?s=s.set(ne(),!0):wt(i.children,o=>{s=s.set(new re(o),!0)}),Zu(t,new F_(i.path,s,n))}else return[]}function Qu(t,e,n){return Zu(t,new Cs(VS(),e,n))}function l$(t,e,n){let i=Ze.fromObject(n);return Zu(t,new qu(VS(),e,i))}function c$(t,e,n,i){let r=nT(t,i);if(r!=null){let s=iT(r),o=s.path,a=s.queryId,l=vt(o,e),c=new Cs(jS(a),l,n);return rT(t,o,c)}else return[]}function u$(t,e,n,i){let r=nT(t,i);if(r){let s=iT(r),o=s.path,a=s.queryId,l=vt(o,e),c=Ze.fromObject(n),u=new qu(jS(a),l,c);return rT(t,o,u)}else return[]}function XS(t,e,n){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let l=vt(o,e),c=ov(a,l);if(c)return c});return qS(r,e,s,n,!0)}function Zu(t,e){return eT(e,t.syncPointTree_,null,GS(t.pendingWriteTree_,ne()))}function eT(t,e,n,i){if(H(t.path))return tT(t,e,n,i);{let r=e.get(ne());n==null&&r!=null&&(n=ov(r,ne()));let s=[],o=G(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){let c=n?n.getImmediateChild(o):null,u=KS(i,o);s=s.concat(eT(a,l,c,u))}return r&&(s=s.concat(sv(r,t,i,n))),s}}function tT(t,e,n,i){let r=e.get(ne());n==null&&r!=null&&(n=ov(r,ne()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=n?n.getImmediateChild(o):null,c=KS(i,o),u=t.operationForChild(o);u&&(s=s.concat(tT(u,a,l,c)))}),r&&(s=s.concat(sv(r,t,i,n))),s}function nT(t,e){return t.tagToQueryMap.get(e)}function iT(t){let e=t.indexOf("$");return y(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new re(t.substr(0,e))}}function rT(t,e,n){let i=t.syncPointTree_.get(e);y(i,"Missing sync point for query tag that we're tracking");let r=GS(t.pendingWriteTree_,e);return sv(i,n,r,null)}var G_=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},z_=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Me(this.path_,e);return new t(this.syncTree_,n)}node(){return XS(this.syncTree_,this.path_)}},d$=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},sS=function(t,e,n){if(!t||typeof t!="object")return t;if(y(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return h$(t[".sv"],e,n);if(typeof t[".sv"]=="object")return f$(t[".sv"],e);y(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},h$=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:y(!1,"Unexpected server value: "+t)}},f$=function(t,e,n){t.hasOwnProperty("increment")||y(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&y(!1,"Unexpected increment value: "+i);let r=e.node();if(y(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},p$=function(t,e,n,i){return av(e,new z_(n,t),i)},g$=function(t,e,n){return av(t,new G_(e),n)};function av(t,e,n){let i=t.getPriority().val(),r=sS(i,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=sS(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new Es(a,Le(r)):t}else{let o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new Es(r))),o.forEachChild(Ue,(a,l)=>{let c=av(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var Ha=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function lv(t,e){let n=e instanceof re?e:new re(e),i=t,r=G(n);for(;r!==null;){let s=$i(i.node.children,r)||{children:{},childCount:0};i=new Ha(r,i,s),n=ce(n),r=G(n)}return i}function Ns(t){return t.node.value}function sT(t,e){t.node.value=e,q_(t)}function oT(t){return t.node.childCount>0}function m$(t){return Ns(t)===void 0&&!oT(t)}function Xu(t,e){wt(t.node.children,(n,i)=>{e(new Ha(n,t,i))})}function aT(t,e,n,i){n&&!i&&e(t),Xu(t,r=>{aT(r,e,!0,i)}),n&&i&&e(t)}function _$(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Ya(t){return new re(t.parent===null?t.name:Ya(t.parent)+"/"+t.name)}function q_(t){t.parent!==null&&v$(t.parent,t.name,t)}function v$(t,e,n){let i=m$(n),r=ln(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,q_(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,q_(t))}var y$=/[\[\].#$\/\u0000-\u001F\u007F]/,w$=/[\[\].#$\u0000-\u001F\u007F]/,a_=10*1024*1024,lT=function(t){return typeof t=="string"&&t.length!==0&&!y$.test(t)},b$=function(t){return typeof t=="string"&&t.length!==0&&!w$.test(t)},E$=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),b$(t)};var cT=function(t,e,n){let i=n instanceof re?new b_(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Yi(i));if(typeof e=="function")throw new Error(t+"contains a function "+Yi(i)+" with contents = "+e.toString());if(dS(e))throw new Error(t+"contains "+e.toString()+" "+Yi(i));if(typeof e=="string"&&e.length>a_/3&&_a(e)>a_)throw new Error(t+"contains a string greater than "+a_+" utf8 bytes "+Yi(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(wt(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!lT(o)))throw new Error(t+" contains an invalid key ("+o+") "+Yi(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);fj(i,o),cT(t,a,i),pj(i)}),r&&s)throw new Error(t+' contains ".value" child '+Yi(i)+" in addition to actual children.")}};var D$=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!lT(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!E$(n))throw new Error(tI(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Y_=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function C$(t,e){let n=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();n!==null&&!OS(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function er(t,e,n){C$(t,n),I$(t,i=>kt(i,e)||kt(e,i))}function I$(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let r=t.eventLists_[i];if(r){let s=r.path;e(s)?(S$(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function S$(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();Ji&&Fe("event: "+n.toString()),za(i)}}}var T$="repo_interrupt",N$=25,K_=class{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Y_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=zu(),this.transactionQueueTree_=new Ha,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function A$(t,e,n){if(t.stats_=tv(t.repoInfo_),t.forceRestClient_||$V())t.server_=new R_(t.repoInfo_,(i,r,s,o)=>{oS(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>aS(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ne(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new nv(t.repoInfo_,e,(i,r,s,o)=>{oS(t,i,r,s,o)},i=>{aS(t,i)},i=>{R$(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=WV(t.repoInfo_,()=>new k_(t.stats_,t.server_)),t.infoData_=new O_,t.infoSyncTree_=new Ju({startListening:(i,r,s,o)=>{let a=[],l=t.infoData_.getNode(i._path);return l.isEmpty()||(a=Qu(t.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),cv(t,"connected",!1),t.serverSyncTree_=new Ju({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);er(t.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function M$(t){let n=t.infoData_.getNode(new re(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function uT(t){return d$({timestamp:M$(t)})}function oS(t,e,n,i,r){t.dataUpdateCount++;let s=new re(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){let l=pa(n,c=>Le(c));o=u$(t.serverSyncTree_,s,l,r)}else{let l=Le(n);o=c$(t.serverSyncTree_,s,l,r)}else if(i){let l=pa(n,c=>Le(c));o=l$(t.serverSyncTree_,s,l)}else{let l=Le(n);o=Qu(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=dv(t,s)),er(t.eventQueue_,a,o)}function aS(t,e){cv(t,"connected",e),e===!1&&x$(t)}function R$(t,e){wt(e,(n,i)=>{cv(t,n,i)})}function cv(t,e,n){let i=new re("/.info/"+e),r=Le(n);t.infoData_.updateSnapshot(i,r);let s=Qu(t.infoSyncTree_,i,r);er(t.eventQueue_,i,s)}function O$(t){return t.nextWriteId_++}function x$(t){dT(t,"onDisconnectEvents");let e=uT(t),n=zu();x_(t.onDisconnect_,ne(),(r,s)=>{let o=p$(r,s,t.serverSyncTree_,e);US(n,r,o)});let i=[];x_(n,ne(),(r,s)=>{i=i.concat(Qu(t.serverSyncTree_,r,s));let o=L$(t,r);dv(t,o)}),t.onDisconnect_=zu(),er(t.eventQueue_,ne(),i)}function P$(t){t.persistentConnection_&&t.persistentConnection_.interrupt(T$)}function dT(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Fe(n,...e)}function hT(t,e,n){return XS(t.serverSyncTree_,e,n)||fe.EMPTY_NODE}function uv(t,e=t.transactionQueueTree_){if(e||ed(t,e),Ns(e)){let n=pT(t,e);y(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&k$(t,Ya(e),n)}else oT(e)&&Xu(e,n=>{uv(t,n)})}function k$(t,e,n){let i=n.map(c=>c.currentWriteId),r=hT(t,e,i),s=r,o=r.hash();for(let c=0;c<n.length;c++){let u=n[c];y(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=vt(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{dT(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(_s(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();ed(t,lv(t.transactionQueueTree_,e)),uv(t,t.transactionQueueTree_),er(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)za(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{ot("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}dv(t,e)}},o)}function dv(t,e){let n=fT(t,e),i=Ya(n),r=pT(t,n);return F$(t,r,i),i}function F$(t,e,n){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=vt(n,l.path),u=!1,d;if(y(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,r=r.concat(_s(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=N$)u=!0,d="maxretry",r=r.concat(_s(t.serverSyncTree_,l.currentWriteId,!0));else{let h=hT(t,l.path,o);l.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){cT("transaction failed: Data returned ",f,l.path);let p=Le(f);typeof f=="object"&&f!=null&&ln(f,".priority")||(p=p.updatePriority(h.getPriority()));let b=l.currentWriteId,x=uT(t),ve=g$(p,h,x);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=ve,l.currentWriteId=O$(t),o.splice(o.indexOf(b),1),r=r.concat(a$(t.serverSyncTree_,l.path,ve,l.currentWriteId,l.applyLocally)),r=r.concat(_s(t.serverSyncTree_,b,!0))}else u=!0,d="nodata",r=r.concat(_s(t.serverSyncTree_,l.currentWriteId,!0))}er(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}ed(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)za(i[a]);uv(t,t.transactionQueueTree_)}function fT(t,e){let n,i=t.transactionQueueTree_;for(n=G(e);n!==null&&Ns(i)===void 0;)i=lv(i,n),e=ce(e),n=G(e);return i}function pT(t,e){let n=[];return gT(t,e,n),n.sort((i,r)=>i.order-r.order),n}function gT(t,e,n){let i=Ns(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);Xu(e,r=>{gT(t,r,n)})}function ed(t,e){let n=Ns(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,sT(e,n.length>0?n:void 0)}Xu(e,i=>{ed(t,i)})}function L$(t,e){let n=Ya(fT(t,e)),i=lv(t.transactionQueueTree_,e);return _$(i,r=>{l_(t,r)}),l_(t,i),aT(i,r=>{l_(t,r)}),n}function l_(t,e){let n=Ns(e);if(n){let i=[],r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(y(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(y(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(_s(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?sT(e,void 0):n.length=s+1,er(t.eventQueue_,Ya(e),r);for(let o=0;o<i.length;o++)za(i[o])}}function U$(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function B$(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ot(`Invalid query segment '${n}' in query '${t}'`)}return e}var lS=function(t,e){let n=V$(t),i=n.namespace;n.domain==="firebase.com"&&Tn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Tn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||PV();let r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Bu(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new re(n.pathString)}},V$=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(r=U$(t.substring(u,d)));let h=B$(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=i}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var J_=class t{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return H(this._path)?null:AS(this._path)}get ref(){return new Ss(this._repo,this._path)}get _queryIdentifier(){let e=YI(this._queryParams),n=ev(e);return n==="{}"?"default":n}get _queryObject(){return YI(this._queryParams)}isEqual(e){if(e=ei(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=OS(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+hj(this._path)}};var Ss=class t extends J_{constructor(e,n){super(e,n,new M_,!1)}get parent(){let e=RS(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};s$(Ss);o$(Ss);var j$="FIREBASE_DATABASE_EMULATOR_HOST",Q_={},$$=!1;function H$(t,e,n,i){t.repoInfo_=new Bu(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function W$(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||Tn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Fe("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=lS(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[j$]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=lS(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let u=r&&l?new Ua(Ua.OWNER):new p_(t.name,t.options,e);D$("Invalid Firebase Database URL",o),H(o.path)||Tn("Database URL must point to the root of a Firebase Database (not including a child path).");let d=z$(a,t,u,new f_(t.name,n));return new Z_(d,t)}function G$(t,e){let n=Q_[e];(!n||n[t.key]!==t)&&Tn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),P$(t),delete n[t.key]}function z$(t,e,n,i){let r=Q_[e.name];r||(r={},Q_[e.name]=r);let s=r[t.toURLString()];return s&&Tn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new K_(t,$$,n,i),r[t.toURLString()]=s,s}var Z_=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(A$(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ss(this._repo,ne())),this._rootInternal}_delete(){return this._rootInternal!==null&&(G$(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Tn("Cannot call "+e+" on a deleted database.")}};function mT(t=ba(),e){let n=Lm(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let i=WC("database");i&&_T(n,...i)}return n}function _T(t,e,n,i={}){t=ei(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Tn("Cannot call useEmulator() after instance has already been initialized.");let r=t._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Tn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ua(Ua.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:zC(i.mockUserToken,t.app.options.projectId);s=new Ua(o)}H$(r,e,n,s)}function q$(t){RV(hs),ii(new _t("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return W$(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),Ae(MI,RI,t),Ae(MI,RI,"esm2017")}nv.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};nv.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};q$();var tr=class{constructor(e){return e}},vT="database",hv=class{constructor(){return Da(vT)}};var fv=new A("angularfire2.database-instances");function Y$(t,e){let n=Vm(vT,t,e);return n&&new tr(n)}function K$(t){return(e,n)=>{let i=e.runOutsideAngular(()=>t(n));return new tr(i)}}var J$={provide:hv,deps:[[new ht,fv]]},Q$={provide:tr,useFactory:Y$,deps:[[new ht,fv],Gi]};function yT(t,...e){return Ae("angularfire",ps.full,"rtdb"),Vn([Q$,J$,{provide:fv,useFactory:K$(t),multi:!0,deps:[K,Je,Ca,Sa,[new ht,Fu],[new ht,Ea],...e]}])}var wT=Ia(mT,!0);var td=(()=>{class t{constructor(n){this.db=n}getList(){return UC(sa(bm(this.db),"books/"))}update(n){let r=`{"${"books/"+n.id}": ${JSON.stringify(n)}}`;return LC(bm(this.db),JSON.parse(r))}static{this.\u0275fac=function(i){return new(i||t)(T(tr))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function eH(t,e){t&1&&(N(0,"ngb-toast",22),ee(1," Yaay! See you at the party! "),M()),t&2&&Oe("autohide",!0)("delay",5e3)}function tH(t,e){t&1&&(N(0,"ngb-toast",23),A0(),N(1,"svg",24),Ce(2,"path",25),M(),ee(3," Oops! Something went wrong, try again. "),M()),t&2&&Oe("autohide",!0)("delay",5e3)}function nH(t,e){t&1&&(N(0,"div",26)(1,"p",27),ee(2,"The images are for reference only, it may be a different edition than the one shown."),M(),N(3,"p",28),ee(4,"With the \u201CSelect\u201D button you can mark the book you are going to take as a gift."),M()())}function iH(t,e){if(t&1){let n=oo();N(0,"div",32),Ce(1,"img",33),N(2,"div",34)(3,"h5",17),ee(4),M(),N(5,"p",18),ee(6),M(),N(7,"button",35),Nt("click",function(){let r=Qs(n).$implicit,s=yn(2);return Zs(s.selectBook(r))}),ee(8,"Select"),M()()()}if(t&2){let n=e.$implicit;le(),ao("src",n.cover,no),le(3),Yt(n.name),le(2),Yt(n.author)}}function rH(t,e){if(t&1){let n=oo();N(0,"div",36)(1,"div",37),Ce(2,"img",33),N(3,"div",38)(4,"h5",39),ee(5),M(),N(6,"p",40),ee(7),M(),N(8,"button",41),Nt("click",function(){let r=Qs(n).$implicit,s=yn(2);return Zs(s.selectBook(r))}),ee(9,"Seleccionar"),M()()(),Ce(10,"img",42),M()}if(t&2){let n=e.$implicit;le(2),ao("src",n.cover,no),le(3),Yt(n.name),le(2),Yt(n.author)}}function sH(t,e){if(t&1&&(N(0,"div",29),qt(1,iH,9,3,"div",30)(2,rH,11,3,"div",31),M()),t&2){let n=yn();le(),Oe("ngForOf",n.bookFilter()),le(),Oe("ngForOf",n.bookFilter())}}function oH(t,e){t&1&&(N(0,"h1",46),ee(1,"Loading..."),M())}function aH(t,e){t&1&&(N(0,"h1",46),ee(1,"Oh, I have already received all the books I wanted."),M())}function lH(t,e){if(t&1&&(N(0,"div",43),Ce(1,"img",44),qt(2,oH,2,0,"h1",45)(3,aH,2,0,"h1",45),M()),t&2){let n=yn();le(2),Oe("ngIf",n.loadingBooks),le(),Oe("ngIf",!n.loadingBooks)}}var bT=(()=>{class t{constructor(n){this.bookService=n,this.books=[],this.bookSelected={},this.showAlertError=!1,this.showAlertSuccess=!1,this.loadingBooks=!1}ngOnInit(){this.fetchBooks()}checkBook(){return g(this,null,function*(){this.bookSelected.check=!0})}selectBook(n){this.bookSelected=n,this.showAlertSuccess=!1,this.showAlertError=!1}bookFilter(){return this.books.filter(n=>!n.check)}areBooks(){return this.bookFilter().length>0}fetchBooks(){return g(this,null,function*(){this.loadingBooks=!0,this.books=[];try{this.books=[{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718141174412x277573946360855300/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2015.26.19.png",author:"EL PEQUE\xD1O LADR\xD3N DE SOMBRAS",name:"MARC LEVY",check:!1,id:1},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718141204199x646443208485423000/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2015.28.10.png",author:"ANTONIA SANTA ANA",name:"LOS OJOS DEL PERRO SIBERIANO",check:!1,id:2},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718143248084x768630623703813200/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2017.00.09.png",author:"SUZANNE COLLINS",name:"LOS JUEGOS DEL HAMBRE",check:!1,id:3},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718143294176x678663248363906600/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2017.00.34.png",author:"SUZANNE COLLINS",name:"EN LLAMAS",check:!1,id:4},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718143356648x401319606657894600/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2017.02.28.png",author:"SUZANNE COLLINS",name:"SINSAJO",check:!1,id:5},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718143778083x639031439191439760/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2017.09.17.png",author:"J. W. GOETHE",name:"FAUSTO",check:!1,id:6},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1718145106732x999661195347660800/Captura%20de%20pantalla%202024-06-11%20a%20la%28s%29%2017.31.35.png",author:"MARY SHELLEY",name:"FRANKESTEIN",check:!1,id:7},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1719069900537x810214858128833900/Captura%20de%20pantalla%202024-06-22%20a%20la%28s%29%2010.23.37.png",author:"J\xC9R\xC9MIE HARRIS",name:"FUE CULPA DE LA F\xCDSICA CU\xC1NTICA",check:!1,id:8},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1725898606078x709553266483924000/51Ge77yr5YL.SX150.jpg",author:"Cho Nam-joo",name:"Kim Ji-young, nacida en 1982",check:!1,id:9},{cover:"https://d466b150155583f9d811bc2319385c20.cdn.bubble.io/f1725898699694x879723947110807200/41%2BnVH6gb6L.SX150.jpg",author:"Chimamanda Ngozi Adichie",name:"Todos deber\xEDamos ser feministas",check:!1,id:10}],this.books=this.books.sort(()=>Math.random()-.5),this.loadingBooks=!1}catch{this.loadingBooks=!1}})}static{this.\u0275fac=function(i){return new(i||t)(De(td))}}static{this.\u0275cmp=Wt({type:t,selectors:[["app-list"]],standalone:!0,features:[Kt],decls:27,vars:8,consts:[[1,"toast-container","position-fixed","top-0","end-0","p-3",2,"z-index","1200"],["class","bg-success text-light text-medium text-family",3,"autohide","delay",4,"ngIf"],["class","bg-danger text-light text-medium text-family",3,"autohide","delay",4,"ngIf"],["class","col-subtitle align-items-center",4,"ngIf"],[1,"flex-container","mt-4"],["class","row row-cols-2 row-cols-md-4",4,"ngIf"],["class","flex-container  p-4 m-4",4,"ngIf"],["data-bs-backdrop","static","data-bs-keyboard","false","id","confirmBook","tabindex","-1","aria-labelledby","confirmBook","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-fullscreen-sm-down","align-items-center"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"card","p-4"],["alt","cover of book",1,"card-img-modal","align-self-center",3,"src"],[1,"card-body","align-self-center","justify-items-center"],[1,"card-title","text-small","color-white","text-center"],[1,"card-text","text-xsmall","color-white","text-center"],[1,"modal-footer","justify-space-between"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"bg-success","text-light","text-medium","text-family",3,"autohide","delay"],[1,"bg-danger","text-light","text-medium","text-family",3,"autohide","delay"],["xmlns","http://www.w3.org/2000/svg","fill","#fff","width","24","height","24","viewBox","0 0 24 24"],["d","M10.872 6.831l1.695 3.904 3.654-1.561-1.79 3.426 3.333.954-3.417 1.338 2.231 4.196-4.773-2.582-2.869 2.287.413-3.004-3.792-.726 2.93-1.74-1.885-2.512 3.427.646.843-4.626zm-.786-6.831l-1.665 9.119-6.512-1.228 3.639 4.851-5.548 3.294 7.108 1.361-.834 6.076 5.742-4.577 9.438 5.104-4.288-8.064 6.834-2.677-6.661-1.907 3.25-6.22-6.98 2.982-3.523-8.114z"],[1,"col-subtitle","align-items-center"],[1,"text-center","m-0","text-light","text-small"],[1,"text-center","m-0","text-light","text-xsmall"],[1,"row","row-cols-2","row-cols-md-4"],["class","card-book card p-4",4,"ngFor","ngForOf"],["class","card-list p-1",4,"ngFor","ngForOf"],[1,"card-book","card","p-4"],["alt","cover of book",3,"src"],[1,"card-body","align-items-center","justify-items-center"],["data-bs-toggle","modal","data-bs-target","#confirmBook",1,"btn","btn-primary",3,"click"],[1,"card-list","p-1"],[1,"card-list-body"],[1,"card-list-text"],[1,"m-0","color-white"],[1,"m-0","text-xsmall","color-white"],["data-bs-toggle","modal","data-bs-target","#confirmBook",1,"btn","btn-primary","text-xsmall","align-self-end",3,"click"],["src","assets/separator.svg","alt","separator of book",1,"separator"],[1,"flex-container","p-4","m-4"],["src","assets/hand.png","alt","hand",1,"image-hand","align-self-center"],["class","text-center text-bold text-big",4,"ngIf"],[1,"text-center","text-bold","text-big"]],template:function(i,r){i&1&&(N(0,"div",0),qt(1,eH,2,2,"ngb-toast",1)(2,tH,4,2,"ngb-toast",2),M(),qt(3,nH,5,0,"div",3),N(4,"div",4),qt(5,sH,3,2,"div",5)(6,lH,4,2,"div",6),M(),N(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"h5",11),ee(12,"Confirm book"),M(),Ce(13,"button",12),M(),N(14,"div",13)(15,"div",14),Ce(16,"img",15),N(17,"div",16)(18,"h5",17),ee(19),M(),N(20,"p",18),ee(21),M()()()(),N(22,"div",19)(23,"button",20),ee(24,"No"),M(),N(25,"button",21),Nt("click",function(){return r.checkBook()}),ee(26,"Yes, this is the one I'm buying"),M()()()()()),i&2&&(le(),Oe("ngIf",r.showAlertSuccess),le(),Oe("ngIf",r.showAlertError),le(),Oe("ngIf",r.areBooks()),le(2),Oe("ngIf",r.areBooks()),le(),Oe("ngIf",!r.areBooks()),le(10),ao("src",r.bookSelected.cover,no),le(3),Yt(r.bookSelected.name),le(2),Yt(r.bookSelected.author))},dependencies:[Pf,db,hb,CE,DE],styles:['.card[_ngcontent-%COMP%]{background-color:#000;border-color:none;box-shadow:none}.card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:3px}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:256px;max-height:172px;align-self:center;margin-bottom:1rem}.inside-card[_ngcontent-%COMP%]{border-color:#80808052;box-shadow:-2px -2px 4px 2px #766e6e9b}.image-hand[_ngcontent-%COMP%]{max-width:256px;max-height:172px}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.modal-content[_ngcontent-%COMP%]{background-color:#000;max-height:min-content}.modal-header[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{border:none!important;padding-left:1.5rem;padding-right:1.5rem}.modal-body[_ngcontent-%COMP%]{max-height:min-content;border:none!important}.btn-close[_ngcontent-%COMP%]{background:url("./media/close-OAKI2PS7.svg")!important}.card-list[_ngcontent-%COMP%]{display:none}.card-list-body[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;gap:1rem}.card-list-body[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:128px;max-height:86px;align-self:center}.card-list-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:80%;gap:.4rem}.card-list[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{width:40%;opacity:.4;margin-top:1rem;margin-bottom:1rem;align-self:center}@media screen and (max-width: 499px){.card-book[_ngcontent-%COMP%]{display:none}.card-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;gap:.5rem}}']})}}return t})();var ET=[{path:"",component:Ap},{path:"book-list",component:bT},{path:"**",redirectTo:"",component:Ap}];var DT={production:!1,firebaseConfig:{apiKey:"AIzaSyCOA7NUTVNvxTNnvi2f1IywOp2w9IhD1QE",authDomain:"farewellofmyyouth.firebaseapp.com",databaseURL:"https://farewellofmyyouth-default-rtdb.firebaseio.com",projectId:"farewellofmyyouth",storageBucket:"farewellofmyyouth.appspot.com",messagingSenderId:"730381309642",appId:"1:730381309642:web:3a963a0881bb36ca0c4633",measurementId:"G-YC6RXTCVXH"}};var CT={providers:[fE(ET,vE()),td,uI(()=>dI(DT.firebaseConfig)),yT(()=>wT())]};var cH=()=>["/"],IT=(()=>{class t{constructor(){this.title="farewell-of-my-youth"}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=Wt({type:t,selectors:[["app-root"]],standalone:!0,features:[Kt],decls:12,vars:2,consts:[[1,"global-container"],[1,"row-decor"],["src","assets/decor_top_start.png","alt","decor top start",1,"decor"],[1,"color-white","no-text-decoration",3,"routerLink"],[1,"text-center","text-bold","text-big","mt-4"],["src","assets/decor_top_end.png","alt","decor top end",1,"decor"],[1,"limit-container"],["src","assets/decor_bottom_start.png","alt","decor bottom start",1,"decor"],["src","assets/decor_bottom_end.png","alt","decor bottom end",1,"decor"]],template:function(i,r){i&1&&(N(0,"div",0)(1,"div",1),Ce(2,"img",2),N(3,"a",3)(4,"h1",4),ee(5,"FAREWELL OF MY YOUTH"),M()(),Ce(6,"img",5),M(),N(7,"div",6),Ce(8,"router-outlet"),M(),N(9,"div",1),Ce(10,"img",7)(11,"img",8),M()()),i&2&&(le(3),Oe("routerLink",qw(1,cH)))},dependencies:[Ep,yE,dE],styles:[".row-decor[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:100%;padding:0;margin:0}"]})}}return t})();Cb(IT,CT).catch(t=>console.error(t));
